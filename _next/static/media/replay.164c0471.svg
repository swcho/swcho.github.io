<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="602px" preserveAspectRatio="none" style="width:1017px;height:602px;background:#FFFFFF;" version="1.1" viewBox="0 0 1017 602" width="1017px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="590.24" style="stroke:#181818;stroke-width:0.5;" width="437" x="198" y="6"/><text fill="#000000" font-family="D2Coding" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35" x="399" y="18.09">rrweb</text><rect fill="#DDDDDD" height="590.24" style="stroke:#181818;stroke-width:0.5;" width="228" x="677" y="6"/><text fill="#000000" font-family="D2Coding" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="42" x="770" y="18.09">xstate</text><rect fill="#DDDDDD" height="590.24" style="stroke:#181818;stroke-width:0.5;" width="104" x="907" y="6"/><text fill="#000000" font-family="D2Coding" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98" x="910" y="18.09">rrweb-snapshot</text><rect fill="#FFFFFF" height="115.56" style="stroke:#181818;stroke-width:1.0;" width="10" x="232" y="97.4"/><rect fill="#FFFFFF" height="174.48" style="stroke:#181818;stroke-width:1.0;" width="10" x="232" y="269.28"/><rect fill="#FFFFFF" height="71.16" style="stroke:#181818;stroke-width:1.0;" width="10" x="232" y="472.84"/><rect fill="#FFFFFF" height="34.08" style="stroke:#181818;stroke-width:1.0;" width="10" x="237" y="509.92"/><rect fill="#FFFFFF" height="100.24" style="stroke:#181818;stroke-width:1.0;" width="10" x="492" y="443.76"/><rect fill="#FFFFFF" height="43.08" style="stroke:#181818;stroke-width:1.0;" width="10" x="584" y="169.88"/><rect fill="#FFFFFF" height="87.24" style="stroke:#181818;stroke-width:1.0;" width="10" x="584" y="327.44"/><rect fill="#FFFFFF" height="116.32" style="stroke:#181818;stroke-width:1.0;" width="10" x="819" y="298.36"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="56.32" y2="562"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="237" x2="237" y1="96.94" y2="562"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="496.5" x2="496.5" y1="138.18" y2="562"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="589" x2="589" y1="56.32" y2="562"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="709" x2="709" y1="56.32" y2="562"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="824" x2="824" y1="237.58" y2="562"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="959" x2="959" y1="56.32" y2="562"/><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="5" y="25.08"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="28" x="12" y="45.1">User</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="5" y="561"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="28" x="12" y="581.02">User</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="202" y="561"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="56" x="209" y="581.02">Replayer</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="49" x="472.5" y="561"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="35" x="479.5" y="581.02">Timer</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84" x="547" y="25.08"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="70" x="554" y="45.1">machine.ts</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84" x="547" y="561"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="70" x="554" y="581.02">machine.ts</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="681" y="25.08"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="42" x="688" y="45.1">xstate</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="56" x="681" y="561"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="42" x="688" y="581.02">xstate</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="154" x="747" y="561"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="140" x="754" y="581.02">StateMachine.Machine</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84" x="917" y="25.08"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="70" x="924" y="45.1">rebuild.ts</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="84" x="917" y="561"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="70" x="924" y="581.02">rebuild.ts</text><rect fill="#FFFFFF" height="115.56" style="stroke:#181818;stroke-width:1.0;" width="10" x="232" y="97.4"/><rect fill="#FFFFFF" height="174.48" style="stroke:#181818;stroke-width:1.0;" width="10" x="232" y="269.28"/><rect fill="#FFFFFF" height="71.16" style="stroke:#181818;stroke-width:1.0;" width="10" x="232" y="472.84"/><rect fill="#FFFFFF" height="34.08" style="stroke:#181818;stroke-width:1.0;" width="10" x="237" y="509.92"/><rect fill="#FFFFFF" height="100.24" style="stroke:#181818;stroke-width:1.0;" width="10" x="492" y="443.76"/><rect fill="#FFFFFF" height="43.08" style="stroke:#181818;stroke-width:1.0;" width="10" x="584" y="169.88"/><rect fill="#FFFFFF" height="87.24" style="stroke:#181818;stroke-width:1.0;" width="10" x="584" y="327.44"/><rect fill="#FFFFFF" height="116.32" style="stroke:#181818;stroke-width:1.0;" width="10" x="819" y="298.36"/><polygon fill="#181818" points="190,83.4,200,87.4,190,91.4,194,87.4" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="26" x2="196" y1="87.4" y2="87.4"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="105" x="33" y="82.41">eventWithTime[]</text><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="202" y="66.32"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="56" x="209" y="86.34">Replayer</text><polygon fill="#181818" points="460.5,109.56,470.5,113.56,460.5,117.56,464.5,113.56" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="242" x2="466.5" y1="113.56" y2="113.56"/><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="49" x="472.5" y="107.56"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="35" x="479.5" y="127.58">Timer</text><polygon fill="#181818" points="572,165.88,582,169.88,572,173.88,576,169.88" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="242" x2="578" y1="169.88" y2="169.88"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="133" x="249" y="164.89">createPlayerService</text><polygon fill="#181818" points="697,194.96,707,198.96,697,202.96,701,198.96" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="594" x2="703" y1="198.96" y2="198.96"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="91" x="601" y="193.97">createMachine</text><polygon fill="#181818" points="735,208.96,745,212.96,735,216.96,739,212.96" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="709" x2="741" y1="212.96" y2="212.96"/><rect fill="#E2E2F0" height="30.24" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="154" x="747" y="206.96"/><text fill="#000000" font-family="D2Coding" font-size="14" lengthAdjust="spacing" textLength="140" x="754" y="226.98">StateMachine.Machine</text><polygon fill="#181818" points="220,265.28,230,269.28,220,273.28,224,269.28" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="26" x2="226" y1="269.28" y2="269.28"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="28" x="33" y="264.29">play</text><polygon fill="#181818" points="807,294.36,817,298.36,807,302.36,811,298.36" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="242" x2="813" y1="298.36" y2="298.36"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="84" x="249" y="293.37">send('PLAY')</text><polygon fill="#181818" points="605,323.44,595,327.44,605,331.44,601,327.44" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="599" x2="818" y1="327.44" y2="327.44"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="28" x="611" y="322.45">play</text><polygon fill="#181818" points="508,352.52,498,356.52,508,360.52,504,356.52" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="502" x2="583" y1="356.52" y2="356.52"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="35" x="514" y="351.53">clear</text><polygon fill="#181818" points="508,381.6,498,385.6,508,389.6,504,385.6" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="502" x2="583" y1="385.6" y2="385.6"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="63" x="514" y="380.61">addAction</text><polygon fill="#181818" points="508,410.68,498,414.68,508,418.68,504,414.68" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="502" x2="588" y1="414.68" y2="414.68"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="35" x="514" y="409.69">start</text><polygon fill="#181818" points="37,439.76,27,443.76,37,447.76,33,443.76" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="31" x2="236" y1="443.76" y2="443.76"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="182" x="43" y="438.77">emit(ReplayerEvents.Start)</text><polygon fill="#181818" points="253,468.84,243,472.84,253,476.84,249,472.84" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="247" x2="491" y1="472.84" y2="472.84"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="231" x="259" y="467.85">getCastFn(EventType.FullSnapshot)</text><line style="stroke:#181818;stroke-width:1.0;" x1="242" x2="289" y1="496.92" y2="496.92"/><line style="stroke:#181818;stroke-width:1.0;" x1="289" x2="289" y1="496.92" y2="509.92"/><line style="stroke:#181818;stroke-width:1.0;" x1="248" x2="289" y1="509.92" y2="509.92"/><polygon fill="#181818" points="258,505.92,248,509.92,258,513.92,254,509.92" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="133" x="254" y="491.93">rebuildFullSnapshot</text><polygon fill="#181818" points="947,540,957,544,947,548,951,544" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="237" x2="953" y1="544" y2="544"/><text fill="#000000" font-family="D2Coding" font-size="13" lengthAdjust="spacing" textLength="49" x="244" y="539.01">rebuild</text><!--MD5=[bb1022f4bffd075e9b8a24f25c178f23]
@startuml replay

skinparam defaultFontName D2Coding

participant User

box "rrweb"
participant Replayer
participant Timer
participant "machine.ts" as machine
end box

box "xstate"
participant xstate
participant "StateMachine.Machine" as fsm
end box

box "rrweb-snapshot"
participant "rebuild.ts" as rebuild
end box


User -> Replayer**: eventWithTime[]
activate Replayer
  Replayer -> Timer**
  Replayer -> machine: createPlayerService
  activate machine
    machine -> xstate: createMachine
    xstate -> fsm**
  deactivate machine
deactivate Replayer

User -> Replayer: play
activate Replayer
  Replayer -> fsm: send('PLAY')
  activate fsm
    fsm -> machine: play
    activate machine
      machine -> Timer: clear
      machine -> Timer: addAction
      machine -> Timer: start
    deactivate machine
  deactivate fsm
  Replayer - -> User: emit(ReplayerEvents.Start)
deactivate Replayer

activate Timer
  Timer -> Replayer: getCastFn(EventType.FullSnapshot)
  activate Replayer
    Replayer -> Replayer: rebuildFullSnapshot
    activate Replayer
      Replayer -> rebuild: rebuild
    deactivate Replayer
  deactivate Replayer
deactivate Timer

@enduml

PlantUML version 1.2022.7(Tue Aug 23 02:01:30 KST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: ko
Country: KR
--></g></svg>