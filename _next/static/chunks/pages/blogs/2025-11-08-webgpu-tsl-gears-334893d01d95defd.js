(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7825],{1568:(e,n,r)=>{"use strict";r.d(n,{A:()=>a});var t=r(18153),l=r(14232),i=r(6170);let s=l.forwardRef((e,n)=>{let{children:r,...s}=e,[a,c]=l.useState(null),o=l.useCallback(e=>{c(e),"function"==typeof n?n(e):n&&"current"in n&&(n.current=e)},[n]),[d,h]=l.useState(0);return(0,t.FD)("div",{ref:o,css:{position:"relative",border:"1px solid",borderRadius:"4px",width:"100%",height:"300px",marginBottom:"1rem"},...s,children:[(0,t.Y)("button",{onClick:()=>h(e=>e+1),css:{position:"absolute",right:0,zIndex:1},children:(0,t.Y)(i.A,{})}),a&&(0,t.Y)(l.Fragment,{children:r(a)},d)]})}),a=l.memo(s)},16136:(e,n,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/blogs/2025-11-08-webgpu-tsl-gears",function(){return r(28670)}])},28670:(e,n,r)=>{"use strict";r.r(n),r.d(n,{default:()=>F,meta:()=>y});var t=r(37876),l=r(91668),i=r(91013),s=r(18153),a=r(1568),c=r(35577),o=r(49082),d=r(93880),h=r(84618),u=r(13462),x=r(24672),m=r(88360),p=r(45302),g=r(14232),j=r(66691),f=r(66744),b=r(30539),S=r(31861),T=r(36938);function v(e){let{nodes:n,materials:r}=(0,c.p)("/_next/static/chunks/gears-transformed.b7a891154a83e24b1150d2f0c3540e03.glb"),{start:t,arc:l,color:i}=(0,S._5)({start:{value:1.75,min:0,max:Math.PI},arc:{value:1.25,min:0,max:Math.PI},color:"#0096ff"}),{output:a,castShadow:o,sliceStart:d,sliceArc:h,sliceColor:u}=g.useMemo(()=>{let e=b.PiW(1.75),n=b.PiW(1.25),r=b.PiW(b.yWT("#0096ff")),t=b.Fn(e=>{let[n,r,t]=e,l=b.rYl(n.y,n.x).sub(r).mod(b.fVC(2*Math.PI)).toVar();return l.greaterThan(0).and(l.lessThan(t))});return{output:b.Fn(()=>{t(b.pot.xy,e,n).discard();let l=b.CGW;return b.If(b.kMH.not(),()=>void l.assign(b.lnd(r,1))),l})(),castShadow:b.Fn(()=>(t(b.pot.xy,e,n).discard(),b.lnd(0,0,0,1)))(),sliceStart:e,sliceArc:n,sliceColor:r}},[]);return(0,m.D)((e,n)=>{T.cz.damp(d,"value",t,.1,n),T.cz.damp(h,"value",l,.1,n),T.cz.dampC(u.value,i,.1,n)}),(0,s.FD)("group",{...e,dispose:null,children:[(0,s.Y)("mesh",{castShadow:!0,receiveShadow:!0,geometry:n.outerHull.geometry,scale:3.714,children:(0,s.Y)("meshPhysicalNodeMaterial",{outputNode:a,color:"#777",side:j.$EB})}),(0,s.Y)("mesh",{castShadow:!0,receiveShadow:!0,geometry:n.axle.geometry,material:r.metal}),(0,s.Y)("mesh",{castShadow:!0,receiveShadow:!0,geometry:n.gears.geometry,material:r.metal,"material-aoMapIntensity":3})]})}(0,m.e)(f);let w=g.memo(function(e){let{}=e;return(0,s.Y)(a.A,{style:{position:"relative"},children:()=>(0,s.FD)(s.FK,{children:[(0,s.FD)(p.Hl,{shadows:!0,camera:{position:[-5,5,5],fov:15},gl:async e=>{let n=new f.WebGPURenderer(e);return n.capabilities={getMaxAnisotropy:()=>0},await n.init(),n},children:[(0,s.Y)("color",{attach:"background",args:["#eee"]}),(0,s.Y)("fog",{attach:"fog",args:["#202025",8,9.25]}),(0,s.Y)(o.N,{enableZoom:!1,enablePan:!1,minPolarAngle:Math.PI/3,maxPolarAngle:Math.PI/3}),(0,s.Y)("spotLight",{castShadow:!0,decay:0,angle:.1,penumbra:1,intensity:Math.PI,position:[5,5,5],"shadow-mapSize":1024}),(0,s.Y)("spotLight",{castShadow:!0,decay:0,angle:.1,penumbra:1,intensity:Math.PI,position:[-5,15,5],"shadow-mapSize":1024}),(0,s.Y)(v,{position:[0,.025,0],scale:.2}),(0,s.Y)(d.V,{position:[0,-.75,0],scale:[7,5,1],opacity:1,colorStop:.02}),(0,s.Y)(h.OH,{preset:"warehouse",environmentIntensity:.5}),(0,s.Y)("axesHelper",{}),(0,s.Y)(u.z,{alignment:"bottom-right",margin:[80,80],children:(0,s.Y)(x.t,{axisColors:["red","green","blue"],labelColor:"black"})})]}),(0,s.Y)("div",{style:{position:"absolute",top:0,left:0,zIndex:1,width:"250px",height:"100px"},children:(0,s.Y)(S.XA,{fill:!0,titleBar:{drag:!1}})})]})})}),y={title:"WebGPU tsl gears",description:"Three.js Shading Language(TSL)을 React-Three-Fiber(R3F) 프로젝트에 설정하고 사용하는 방법을 알아봅니다.",date:"2025-11-08",readTime:5},L=e=>{let{children:n}=e;return(0,t.jsx)(i.A,{meta:y,children:n})};function Y(e){let n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{children:"소개"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://www.reddit.com/r/threejs/comments/1iko4kg/setup_reactthreefiber_with_tsl/?tl=ko",children:"TSL로 React-Three-Fiber 설정하기 : r/threejs"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"React-Three-Fiber(이하 R3F)는 React를 사용하여 Three.js로 3D 그래픽을 만들 수 있는 강력한 라이브러리입니다.\nTSL(Three.js Shading Language)은 Three.js에서 셰이더를 작성하는 데 사용되는 언어로, GLSL과 유사하지만 Three.js에 특화된 기능을 제공합니다.\n이 글에서는 R3F 프로젝트에서 TSL을 설정하고 사용하는 방법을 단계별로 설명합니다."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["참조: ",(0,t.jsx)(n.a,{href:"https://github.com/mrdoob/three.js/wiki/Three.js-Shading-Language",children:"Three.js Shading Language \xb7 mrdoob/three.js Wiki"})]}),"\n"]}),"\n",(0,t.jsx)(w,{}),"\n",(0,t.jsx)(n.h1,{children:"R3F 프로젝트에 TSL 설정하기"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"참조: https://r3f.docs.pmnd.rs/api/canvas#webgpu"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"먼저 R3F 프로젝트에 TSL을 설정하는 방법을 살펴보겠습니다."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"import * as THREE from 'three/webgpu';\nimport * as TSL from 'three/tsl';\nimport { Canvas, extend, useFrame, useThree } from '@react-three/fiber';\n\ndeclare module '@react-three/fiber' {\n  interface ThreeElements extends ThreeToJSXElements<typeof THREE> {}\n}\n\nextend(THREE as any);\n\nexport default () => (\n  <Canvas\n    gl={async (props) => {\n      const renderer = new THREE.WebGPURenderer(props as any);\n      await renderer.init();\n      return renderer;\n    }}\n  >\n    <mesh>\n      <meshBasicNodeMaterial />\n      <boxGeometry />\n    </mesh>\n  </Canvas>\n);\n"})}),"\n",(0,t.jsxs)(n.p,{children:["위 코드에서는 ",(0,t.jsx)(n.code,{children:"three/webgpu"}),"와 ",(0,t.jsx)(n.code,{children:"three/tsl"})," 모듈을 가져오고, R3F의 ",(0,t.jsx)(n.code,{children:"extend"})," 함수를 사용하여 Three.js의 WebGPU 렌더러를 확장합니다."]}),"\n",(0,t.jsxs)(n.p,{children:["그런 다음 ",(0,t.jsx)(n.code,{children:"Canvas"})," 컴포넌트의 ",(0,t.jsx)(n.code,{children:"gl"})," 속성에 비동기 함수를 전달하여 WebGPU 렌더러를 초기화합니다."]}),"\n",(0,t.jsx)(n.h1,{children:"TLS 개요"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"참조: https://github.com/mrdoob/three.js/wiki/Three.js-Shading-Language"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"TSL은 Three.js에서 셰이더를 작성하는 데 사용되는 언어로, GLSL과 유사하지만 Three.js에 특화된 기능을 제공합니다."}),"\n",(0,t.jsx)(n.p,{children:"TSL의 주요 특징은 다음과 같습니다:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"JavaScript 기반 셰이더 작성"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"문자열 조작 없이 JS/TS로 직접 셰이더 로직 작성"}),"\n",(0,t.jsx)(n.li,{children:"NPM, import/export 등 JS 생태계 활용 가능"}),"\n",(0,t.jsx)(n.li,{children:"TypeScript 타입 체킹 지원"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"렌더러 독립성"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"WebGPU(WGSL)와 WebGL(GLSL) 모두 지원"}),"\n",(0,t.jsx)(n.li,{children:"동일한 TSL 코드가 자동으로 양쪽 백엔드로 변환됨"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"자동 최적화"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"반복되는 표현식 자동 캐싱"}),"\n",(0,t.jsx)(n.li,{children:"필요한 경우에만 varying 생성"}),"\n",(0,t.jsx)(n.li,{children:"Uniform/attribute 자동 재사용"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"노드 시스템"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"모든 TSL 컴포넌트는 Node 클래스를 확장"}),"\n",(0,t.jsx)(n.li,{children:"노드들은 자동으로 연결되고 한 번만 계산됨"}),"\n",(0,t.jsx)(n.li,{children:"Tree shaking 지원"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h1,{children:"TLS 코드 분석"}),"\n",(0,t.jsx)(n.h2,{children:"1. Uniform 변수 선언"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const sliceStart = TSL.uniform(1.75); // 슬라이스 시작 각도 (라디안)\nconst sliceArc = TSL.uniform(1.25); // 슬라이스 각도 범위 (라디안)\nconst sliceColor = TSL.uniform(TSL.color('#0096ff')); // 단면 색상 (파란색)\n"})}),"\n",(0,t.jsx)(n.p,{children:"슬라이스 영역: 1.75 라디안 위치에서 시작해서 1.25 라디안만큼의 부채꼴 영역을 정의하는 uniform 변수들입니다."}),"\n",(0,t.jsx)(n.p,{children:"JS/TS에서 GPU로 변경 가능한 uniform 값들을 선언하는 방법을 보여줍니다."}),"\n",(0,t.jsx)(n.p,{children:"예제는 Leva를 사용하여 이러한 uniform 값들을 쉽게 조정할 수 있습니다."}),"\n",(0,t.jsx)(n.h2,{children:"2. inAngle 함수 - 각도 범위 체크"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const inAngle = TSL.Fn<[position: THREE.Node, angleStart: number, angleArc: number]>(\n  ([position, angleStart, angleArc]) => {\n    // 1. 2D 위치로부터 각도 계산\n    const angle = TSL.atan(position.y, position.x)\n      .sub(angleStart) // 시작 각도만큼 빼기\n      .mod(TSL.float(Math.PI * 2)) // 0 ~ 2π 범위로 정규화\n      .toVar();\n\n    // 2. 각도가 슬라이스 범위 안에 있는지 체크\n    return angle.greaterThan(0).and(angle.lessThan(angleArc));\n  }\n);\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"동작 원리:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"      Y\n      |\n      |  슬라이스 영역\n      | /\n      |/_____ angleArc\n     /|\n    / |\n   /__|_________ X\n      angleStart\n\n위치 -> 각도 계산 -> 범위 체크 -> true/false 반환\n"})}),"\n",(0,t.jsx)(n.h2,{children:"3. output 함수 - 메인 렌더링 로직"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const output = TSL.Fn(() => {\n  // 1. 슬라이스 영역 내부면 픽셀 제거 (구멍 뚫기)\n  inAngle(TSL.positionLocal.xy, sliceStart, sliceArc).discard();\n\n  // 2. 기본 출력 가져오기\n  const finaleOutput = TSL.output;\n\n  // 3. 뒷면(단면)이면 파란색으로 칠하기\n  TSL.If(TSL.frontFacing.not(), () => {\n    finaleOutput.assign(TSL.vec4(sliceColor, 1));\n  });\n\n  return finaleOutput;\n})();\n"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:".discard(): 슬라이스 영역 내부 픽셀은 렌더링하지 않음 (구멍)"}),"\n",(0,t.jsx)(n.li,{children:"frontFacing.not(): 잘린 단면(뒷면)을 감지"}),"\n",(0,t.jsx)(n.li,{children:"단면 착색: 뒷면에만 파란색 적용"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{children:"4. castShadow 함수 - 그림자 처리"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-tsx",children:"const castShadow = TSL.Fn(() => {\n  // 슬라이스 영역은 그림자도 투명하게\n  inAngle(TSL.positionLocal.xy, sliceStart, sliceArc).discard();\n  return TSL.vec4(0, 0, 0, 1); // 검은색 그림자\n})();\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"그림자 계산에서도 동일하게 슬라이스 영역 제거"}),"\n",(0,t.jsx)(n.li,{children:"일관된 시각적 효과 유지"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{children:"마치며"}),"\n",(0,t.jsx)(n.p,{children:"TSL은 R3F 프로젝트에서 셰이더를 작성하는 강력한 도구입니다."}),"\n",(0,t.jsx)(n.p,{children:"조건문, 반복문, 함수 등을 함수형 프로그래잉 스타일로 작성하기 때문에 다소 어색한 것은 사실입니다."}),"\n",(0,t.jsx)(n.p,{children:"하지만, GLSL 코드의 오류를 잡아본 경험이 있으신 분들은 이 방식이 가져다줄 안정성과 유지보수성의 이점을 금방 이해하실 수 있을 것입니다."}),"\n",(0,t.jsx)(n.p,{children:"다음에는 더 기초적이고 단순한 TSL 예제를 다뤄보도록 하겠습니다."})]})}function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.jsx)(L,{...e,children:(0,t.jsx)(Y,{...e})})}},49034:(e,n,r)=>{"use strict";r.d(n,{A:()=>x});var t=r(18153),l=r(77328),i=r.n(l),s=r(14232);let a=s.memo(()=>(0,t.Y)(t.FK,{}));var c=r(71745),o=r(48230),d=r.n(o);let h=[{link:"/",text:"Home"}],u=s.memo(()=>{let e=(0,c.useRouter)(),[n,r]=s.useState(!1);return(0,t.FD)("nav",{className:"w-full",children:[(0,t.Y)("div",{id:"progress",className:"top-0 z-20 h-1",style:{background:"linear-gradient(to right, #4dc0b5 var(--scroll), transparent 0)"}}),(0,t.FD)("div",{className:"flex flex-wrap items-center justify-between w-full py-3 mx-auto mt-0 md:max-w-4xl",children:[(0,t.Y)("div",{className:"pl-4",children:(0,t.Y)(d(),{className:"text-xl font-extrabold text-gray-900 no-underline hover:no-underline",href:"/",children:"lifetime trails"})}),(0,t.Y)("div",{className:"block pr-4 lg:hidden",children:(0,t.Y)("button",{id:"nav-toggle",type:"button",className:"flex items-center px-3 py-2 text-gray-500 appearance-none hover:text-gray-900 hover:border-teal-500 focus:outline-none",onMouseDown:e=>e.preventDefault(),onClick:()=>r(!n),onBlur:()=>r(!1),children:(0,t.FD)("svg",{className:"w-3 h-3 fill-current",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.Y)("title",{children:"Menu"}),(0,t.Y)("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})]})})}),(0,t.Y)("div",{id:"nav-content",className:"bg-gray-100 border-b flex-grow lg:border-none lg:flex lg:items-center lg:mt-0 lg:shadow-none lg:w-auto md:bg-transparent mt-2 shadow w-full z-20 ".concat(n?"block":"hidden"),children:(0,t.Y)("ul",{className:"items-center justify-end flex-1 list-reset lg:flex",children:h.map(n=>{let{link:r,text:l}=n;return(0,t.Y)("li",{className:"mr-3",children:(0,t.Y)(d(),{className:e.pathname===r?"inline-block py-2 px-4 text-gray-900 font-bold no-underline":"inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4",href:r,children:l})},r)})})})]})]})}),x=s.memo(e=>{let{children:n,title:r="This is the default title"}=e;return(0,t.FD)("div",{className:"leading-normal tracking-normal bg-gray-100 min-h-screen",children:[(0,t.FD)(i(),{children:[(0,t.Y)("title",{children:r}),(0,t.Y)("meta",{charSet:"utf-8"}),(0,t.Y)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,t.Y)(u,{}),(0,t.Y)("div",{className:"container w-full px-4 pb-10 mx-auto md:max-w-3xl",children:n}),(0,t.Y)(a,{})]})})},60158:(e,n,r)=>{"use strict";r.d(n,{J:()=>a,j:()=>s});var t=r(18153),l=r(14232);let i=l.createContext({});function s(e){let{staticProps:n,children:r}=e;return(0,t.Y)(i.Provider,{value:n,children:r})}function a(){return l.useContext(i)}},85419:(e,n,r)=>{"use strict";r.d(n,{A:()=>l});var t=r(18153);r(14232);let l=e=>{let{meta:n,isBlogPost:r}=e;return(0,t.FD)(t.FK,{children:[(0,t.Y)("h1",{className:"font-bold text-gray-800 mb-4 ".concat(r?"text-5xl mt-8 mb-8":"text-lg"),children:n.title}),(0,t.FD)("div",{className:"details",children:[(0,t.Y)("p",{className:"text-gray-500",children:n.description}),(0,t.Y)("p",{className:"text-gray-400 text-right -mt-1",children:(0,t.Y)("span",{className:"mr-4",children:n.date})})]})]})}},91013:(e,n,r)=>{"use strict";r.d(n,{A:()=>h});var t=r(18153),l=r(73146),i=r.n(l),s=r(14232),a=r(86089),c=r(60158),o=r(85419),d=r(49034);function h(e){let{children:n,meta:r,staticProps:l}=e;return s.useEffect(()=>{i().highlightAll()},[]),(0,t.Y)(t.FK,{children:(0,t.FD)(d.A,{title:r.title,children:[(0,t.Y)(o.A,{meta:r,isBlogPost:!0}),(0,t.Y)(c.j,{staticProps:l,children:(0,t.Y)("article",{className:"markdown",children:n})}),(0,t.Y)(a.Ay,{repo:"swcho/blog-comments",type:"pathname",label:"utterances",theme:"github-light"})]})})}}},e=>{e.O(0,[5334,7391,683,7544,5695,5302,2077,3665,5003,4618,1861,3629,3874,636,6593,8792],()=>e(e.s=16136)),_N_E=e.O()}]);
//# sourceMappingURL=2025-11-08-webgpu-tsl-gears-334893d01d95defd.js.map