<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="initial-scale=1.0, width=device-width" data-next-head=""/><title data-next-head="">LangchainJS 리뷰 #3</title><link rel="preload" href="/_next/static/css/d20c50ed748cd26f.css" as="style"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/vs2015.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous"/><link rel="stylesheet" href="/_next/static/css/d20c50ed748cd26f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0b9df2340104f8e1.js" defer=""></script><script src="/_next/static/chunks/framework-80cff53c93df8ff7.js" defer=""></script><script src="/_next/static/chunks/main-beade485850481f6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-5b36dff9503cb490.js" defer=""></script><script src="/_next/static/chunks/5695-9c01eff236121af5.js" defer=""></script><script src="/_next/static/chunks/pages/blogs/2023-07-15-langchainjs-part-3-aa94402f7899768e.js" defer=""></script><script src="/_next/static/qfjDRDkI7hbaUN0YCN0K0/_buildManifest.js" defer=""></script><script src="/_next/static/qfjDRDkI7hbaUN0YCN0K0/_ssgManifest.js" defer=""></script><style id="__jsx-4134105190">.markdown html{font:118.75%/1.58 'Roboto',serif;box-sizing:border-box;overflow-y:scroll;}.markdown *{box-sizing:inherit;}.markdown *:before{box-sizing:inherit;}.markdown *:after{box-sizing:inherit;}.markdown body{color:hsla(0,0%,0%,0.73);font-family:'Roboto',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}.markdown img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}.markdown h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}.markdown h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}.markdown h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}.markdown h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}.markdown h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}.markdown hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown ul{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}.markdown ol{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}.markdown dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:0.85rem;line-height:1.58rem;}.markdown table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:1rem;line-height:1.58rem;border-collapse:collapse;width:100%;}.markdown fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:0.94737rem;line-height:1.58rem;border-left:0.5925rem solid #017698;color:hsla(0,0%,0%,0.65);background-color:hsla(0,0%,0%,0.1);padding:0.29625rem 0.9875rem;font-style:italic;}.markdown form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.58rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}.markdown address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown b{font-weight:700;}.markdown strong{font-weight:700;}.markdown dt{font-weight:700;}.markdown th{font-weight:700;}.markdown li{margin-bottom:calc(1.58rem / 2);}.markdown ol li{padding-left:0;}.markdown ul li{padding-left:0;}.markdown li > ol{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}.markdown li > ul{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}.markdown blockquote *:last-child{margin-bottom:0;}.markdown li *:last-child{margin-bottom:0;}.markdown p *:last-child{margin-bottom:0;}.markdown li > p{margin-bottom:calc(1.58rem / 2);}.markdown code{font-size:0.85rem;line-height:1.58rem;}.markdown kbd{font-size:0.85rem;line-height:1.58rem;}.markdown samp{font-size:0.85rem;line-height:1.58rem;}.markdown abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}.markdown acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}.markdown abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}.markdown thead{text-align:left;}.markdown td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.05333rem;padding-right:1.05333rem;padding-top:0.79rem;padding-bottom:calc(0.79rem - 1px);}.markdown th:first-child,td:first-child{padding-left:0;}.markdown th:last-child,td:last-child{padding-right:0;}.markdown a{color:#017698;text-decoration:none;background-image:linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 1px, #017698 1px, #017698 2px, rgba(0, 0, 0, 0) 2px);}.markdown a:hover,a:active{text-shadow:none;background-image:none;}.markdown h1,h2,h3,h4,h5,h6{margin-top:3.16rem;}.markdown li>ol,li>ul{margin-left:20px;margin-bottom:0;}.markdown blockquote > :last-child{margin-bottom:0;}.markdown blockquote cite{font-size:1rem;line-height:1.58rem;color:hsla(0,0%,0%,0.73);font-style:normal;font-weight:400;}.markdown blockquote cite:before{content:"— ";}.markdown @media only screen and (max-width:480px){html{font-size:106.25%;line-height:28px;}blockquote{border-left:0.29625rem solid #017698;color:hsla(0,0%,0%,0.59);padding-left:0.88875rem;font-style:italic;margin-left:-1.185rem;margin-right:0;}} .markdown{color:#3d3d3d}.markdown ul li{list-style-type:disc}.markdown ol{list-style-type:decimal}:not(pre) code{background-color:rgb(203 208 218);border-radius:3px;font-family:D2Coding,Consolas,"Roboto Mono","Liberation Mono",Menlo,Courier,monospace;padding:.2rem .3rem;margin:0 .2rem}.markdown * code{font-size:inherit}.markdown code[class*="language-"]{font-family:D2Coding,Consolas,"Roboto Mono","Liberation Mono",Menlo,Courier,monospace;padding:1rem;background-color:#2d2d2d}</style></head><body><link rel="preload" as="image" href="/_next/static/media/mrkl.b4359e4d.svg"/><div id="__next"><div class="leading-normal tracking-normal bg-gray-100 min-h-screen"><nav class="w-full"><div id="progress" class="top-0 z-20 h-1" style="background:linear-gradient(to right, #4dc0b5 var(--scroll), transparent 0)"></div><div class="flex flex-wrap items-center justify-between w-full py-3 mx-auto mt-0 md:max-w-4xl"><div class="pl-4"><a class="text-xl font-extrabold text-gray-900 no-underline hover:no-underline" href="/">lifetime trails</a></div><div class="block pr-4 lg:hidden"><button id="nav-toggle" type="button" class="flex items-center px-3 py-2 text-gray-500 appearance-none hover:text-gray-900 hover:border-teal-500 focus:outline-none"><svg class="w-3 h-3 fill-current" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path></svg></button></div><div id="nav-content" class="bg-gray-100 border-b flex-grow lg:border-none lg:flex lg:items-center lg:mt-0 lg:shadow-none lg:w-auto md:bg-transparent mt-2 shadow w-full z-20 hidden"><ul class="items-center justify-end flex-1 list-reset lg:flex"><li class="mr-3"><a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4" href="/">Home</a></li></ul></div></div></nav><div class="container w-full px-4 pb-10 mx-auto md:max-w-3xl"><h1 class="font-bold text-gray-800 mb-4 text-5xl mt-8 mb-8">LangchainJS 리뷰 #3</h1><div class="details"><p class="text-gray-500">langchain의 agent에 대해 살펴 봅니다.</p><p class="text-gray-400 text-right -mt-1"><span class="mr-4">2023-07-15</span></p></div><article class="markdown"><h1>Agent</h1>
<blockquote>
<p><a href="https://js.langchain.com/docs/modules/agents/">Agents | 🦜️🔗 Langchain</a></p>
</blockquote>
<blockquote>
<p><a href="https://anpigon.tistory.com/399">랭체인 에이전트와 도구 사용하기</a></p>
</blockquote>
<p>Chain은 이미 정해진 처리 과정에 따라 작업을 수행하지만, agent는 llm의 응답에 따라 작업을 선택적으로 수행합니다.</p>
<img src="/_next/static/media/mrkl.b4359e4d.svg"/>
<p><code>AgentExecutor</code>는 agent의 실행 계획을 실행합니다.</p>
<p><code>ZeroShotAgent</code>는 주어진 tool들과 질문을 바탕으로 실행 계획을 세우는 프롬프트를 작성하고 LLM에 요청합니다.
LLM은 주어진 프롬프트에 따라, 질문에 대한 답을 얻어내기 위해 필요한 tool을 선택하고 tool에 전달할 적절한 입력값도 생성합니다.
이 과정을 반복해서 질문에 대한 최종 답을 얻어냅니다.</p>
<p>보여준 예시에서는 <code>Olivia Wilde의 남자친구가 누구이고, 그의 나이에 0.23 제곱을 하라</code>(Who is Olivia Wilde&#x27;s boyfriend? What is his current age raised to the 0.23 power?)라는 질문을 전달합니다.</p>
<p>또한, 해당 문제를 풀 때 사용할 수 있는 tool을 전달하는데, 각 툴은 식별자와 설명 정보를 가집니다.
<code>ZeroShotAgent</code>는 이 툴둘의 식별정보와 설명을 포함하고 이 툴들을 사용해서 주어진 문제를 풀 수 있는 <code>Action</code>과 해당 action의 입력 값을 최종 답이 나올 때 까지 LLM에 프롬프트를 전달합니다.</p>
<p>다소 도전적인 요청 같았는데도, OpenAI는 적절하게 구글 검색 툴을 선택해서 <code>Olivia Wilde boyfriend</code>라는 검색어를 전달합니다.</p>
<p><code>AgentExecutor</code>는 LLM이 선택한 tool과 그 입력 값을 바탕으로 <code>GoogleCustomSearch</code>를 선택하여 검색 요청을 하고 그 결과를 받습니다.
검색 결과는 <code>ZeroShotAgent</code>에서 다룬 프롬프트 패턴에 맞추어 다시 OpenAI LLM에 전달하여 다음 action을 선택하도록 프롬프트를 전달합니다.</p>
<p>최종적으로는 <code>Calculator</code>에 연산에 필요한 입력 <code>36 ^ 0.23</code>을 전달합니다. 즉 LLM은 구글 검색 결과를 기반으로 Olivia Wilde의 남자친구의 나이가 36임을 알아내고 <code>0.23</code> 승수의 답을 얻어낼 수 있는 계산식을 만들어 냅니다.</p>
<h1>마치며</h1>
<p>langchain js의 예제를 분석하면서 model, prompt, indexing, memory, chain, agent 등의 개념을 살펴 보았습니다.
전반적으로 문제 해결의 정답을 찾는다기 보다는 LLM 활용을 위한 에코시스템을 적절히 추상화하고 확장 가능하도록 설계한 것으로 보입니다.
아직 다듬어지지 않은 개념과 시도로 인해 코드가 다소 복잡하고 때론 모호하게 느껴질 때도 있었고 그만큼 고민과 삽질(?)의 흔적이 보였습니다.</p>
<p>결과적으로는 langchain의 역할은 크게 2가지 인 것 같습니다.</p>
<h2>프롬프트 엔지니러링 툴</h2>
<p>지금까지 살펴 보았듯이, langchain 추상화는 prompt 템플릿을 만들고 그 응답을 적절히 파싱하는데 기반하고 있습니다.</p>
<p>복잡도가 높은 작업들은 특정 prompt 템플릿을 기반으로 질문하고, 다시 prompt 템플릿에 그 질문에 대한 답을 붙여 질문하고를 반복하는 것을 알 수 있습니다.
chain은 이러한 작업들의 추상화 개념이고 LLM만으로 처리할 수 없는 다양한 작업을 tool을 통해 추상화 하여 agent로 이를 처리하도록 설계하였습니다.</p>
<h2>Vector DB 연동</h2>
<p>Foundation 모델로서 LLM은 기존 상태 의존 없이 질의를 할 수 있습니다.
하지만 개개인의 실생활에 밀접한 문제해결을 위해서는 개인화한 데이터와 컨텍스트를 유지하고 질의할 필요가 있습니다.
Foundation 모델은 일종의 CPU로서 사용하고 각 사용자에 특화된 데이터를 저장하는 indexing 추상화 레벨을 제공합니다.</p>
<p>indexing은 각 LLM에서 가지고 있는 embedding 구현에 따라 일반적인 거리 연산이 가능한 vector 값으로 저장하는 추상화 레벨입니다.</p>
<p>langchain은 다양한 vector store 구현체와 연동할 수 있는 인터페이스를 제공합니다.</p>
<h2>맺음말</h2>
<p>SF 영화 처럼 실생활에서 정답을 말해주고 추천해주는 foundation model은 당장은 힘들지도 모릅니다.</p>
<p>반면 여러 분야에 특화된 인공지능을 개발하기 위해서는 전문인력과 자원이 필요했습니다.
현 수준의 foundation model은 특화된 데이터와 아이디어를 가지고 국부적인 문제를 해결할 수 있는 AI를 손쉽게 구현할 수 있습니다.
다시말해 질문의 답을 어떻게 찾을 것인가가 아닌 질문 그 자체의 아이디어만 가지고 문제해결이 가능한 방법이 생긴 것 입니다.</p>
<p>langchain은 이러한 미션을 해결해 줄 수 있는 오픈소스 에코시스템을 제시하고 있습니다.
그리고 스타트업에서 부터 엔터프라이즈까지 다양한 분야의 데이터와 문제해결을 위해 LLM을 활용하고자 한다면 단연 langchain이 첫번째 검토 대상이 될 것입니다.</p>
<p>최근 OpenAPI 4의 API 사용이 GA 단계로 접어들었다고 합니다.
앞으로도 이 분야에서 재미있고 설례는 소식을 기대해 봅니다.</p></article><div class="react-utterences"><div>Loading script...</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blogs/2023-07-15-langchainjs-part-3","query":{},"buildId":"qfjDRDkI7hbaUN0YCN0K0","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>