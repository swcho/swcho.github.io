(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7549],{3717:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},26860:(e,s,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/blogs/2023-06-11-yuebing-part-3",function(){return n(88305)}])},49034:(e,s,n)=>{"use strict";n.d(s,{A:()=>p});var t=n(18153),r=n(77328),a=n.n(r),i=n(14232);let c=i.memo(()=>(0,t.Y)(t.FK,{}));var l=n(71745),d=n(48230),m=n.n(d);let o=[{link:"/",text:"Home"}],h=i.memo(()=>{let e=(0,l.useRouter)(),[s,n]=i.useState(!1);return(0,t.FD)("nav",{className:"w-full",children:[(0,t.Y)("div",{id:"progress",className:"top-0 z-20 h-1",style:{background:"linear-gradient(to right, #4dc0b5 var(--scroll), transparent 0)"}}),(0,t.FD)("div",{className:"flex flex-wrap items-center justify-between w-full py-3 mx-auto mt-0 md:max-w-4xl",children:[(0,t.Y)("div",{className:"pl-4",children:(0,t.Y)(m(),{legacyBehavior:!0,className:"text-xl font-extrabold text-gray-900 no-underline hover:no-underline",href:"/",children:"lifetime trails"})}),(0,t.Y)("div",{className:"block pr-4 lg:hidden",children:(0,t.Y)("button",{id:"nav-toggle",type:"button",className:"flex items-center px-3 py-2 text-gray-500 appearance-none hover:text-gray-900 hover:border-teal-500 focus:outline-none",onMouseDown:e=>e.preventDefault(),onClick:()=>n(!s),onBlur:()=>n(!1),children:(0,t.FD)("svg",{className:"w-3 h-3 fill-current",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.Y)("title",{children:"Menu"}),(0,t.Y)("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})]})})}),(0,t.Y)("div",{id:"nav-content",className:"bg-gray-100 border-b flex-grow lg:border-none lg:flex lg:items-center lg:mt-0 lg:shadow-none lg:w-auto md:bg-transparent mt-2 shadow w-full z-20 ".concat(s?"block":"hidden"),children:(0,t.Y)("ul",{className:"items-center justify-end flex-1 list-reset lg:flex",children:o.map(s=>{let{link:n,text:r}=s;return(0,t.Y)("li",{className:"mr-3",children:(0,t.Y)(m(),{legacyBehavior:!0,className:e.pathname===n?"inline-block py-2 px-4 text-gray-900 font-bold no-underline":"inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4",href:n,children:r})},n)})})})]})]})}),p=i.memo(e=>{let{children:s,title:n="This is the default title"}=e;return(0,t.FD)("div",{className:"leading-normal tracking-normal bg-gray-100 min-h-screen",children:[(0,t.FD)(a(),{children:[(0,t.Y)("title",{children:n}),(0,t.Y)("meta",{charSet:"utf-8"}),(0,t.Y)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,t.Y)(h,{}),(0,t.Y)("div",{className:"container w-full px-4 pb-10 mx-auto md:max-w-3xl",children:s}),(0,t.Y)(c,{})]})})},56486:(e,s,n)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.identifierTypes=void 0;var t=function(e){if(e&&e.__esModule)return e;var s={};if(null!=e){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};t.get||t.set?Object.defineProperty(s,n,t):s[n]=e[n]}}return s.default=e,s}(n(14232)),r=function(e){return e&&e.__esModule?e:{default:e}}(n(95062));function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,s){return(c=Object.setPrototypeOf||function(e,s){return e.__proto__=s,e})(e,s)}var l=["pathname","url","title","og:title","issue-number","issue-term"],d=function(e,s,n){if(0>l.indexOf(e))return void console.warn("Wrong type: "+e);if("pathname"===e)return"pathname";if("url"===e)return"url";if("title"===e)return"title";if("og:title"===e)return"og:title";if("issue-term"===e)return s;else if("issue-number"===e)return n},m=function(e){var s;if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function n(e){var s,r;if(!(this instanceof n))throw TypeError("Cannot call a class as a function");return(s=(r=i(n).call(this,e))&&("object"===a(r)||"function"==typeof r)?r:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this)).myRef=t.default.createRef(),s.state={pending:!0},s}return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&c(n,e),s=[{key:"componentDidMount",value:function(){var e=this,s=this.props,n=s.repo,t=s.type,r=s.specificTerm,a=s.issueNumber,i=0>l.indexOf(t)?void console.warn("Wrong type: "+t):"issue-number"===t?"issue-number":"issue-term",c=d(t,r,a);if("issue-term"===t&&!c)return void console.warn("When type is '".concat(t,"', 'specificTerm' prop must be provided"));if("issue-number"===t&&(isNaN(c)||c<1))return void console.warn("When type is '".concat(t,"', valid 'issueNumber' prop must be provided"));var m=document.createElement("script");m.src="https://utteranc.es/client.js",m.async=!0,m.setAttribute("repo",n),m.setAttribute("crossorigin","anonymous"),m.setAttribute(i,c),m.onload=function(){return e.setState({pending:!1})},this.myRef.current.appendChild(m)}},{key:"render",value:function(){return t.default.createElement("div",{className:"react-utterences",ref:this.myRef},this.props.debug&&t.default.createElement("pre",{style:{background:"#cccccc",padding:10}},"\nthis.props: ".concat(JSON.stringify(this.props,null,2),'\nlocation.pathname: "').concat(window.location.pathname,'"\nlocation.href: "').concat(window.location.href,'"\n          ').trim()),this.props.debug&&t.default.createElement("div",null,"\uD83D\uDC47\uD83D\uDC47If the settings are valid, the comment widget appear below\uD83D\uDC47\uD83D\uDC47"),this.state.pending&&t.default.createElement("div",null,"Loading script..."))}}],function(e,s){for(var n=0;n<s.length;n++){var t=s[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}(n.prototype,s),n}(t.Component);s.identifierTypes={pathname:{attrValue:"",summary:"Issue title contains page pathname"},url:{attrValue:"url",summary:"Issue title contains page URL"},title:{attrValue:"title",summary:"Issue title contains page title"},"og:title":{attrValue:"og:title",summary:"Issue title contains page og:title"},"issue-number":{attrValue:-1,summary:"Specific issue number"},"issue-term":{attrValue:"",summary:"Issue title contains specific term"}},m.propTypes={type:r.default.string.isRequired,repo:r.default.string.isRequired,specificTerm:r.default.string,issueNumber:r.default.number,hashKey:r.default.string,debug:r.default.bool},s.default=m},60158:(e,s,n)=>{"use strict";n.d(s,{J:()=>c,j:()=>i});var t=n(18153),r=n(14232);let a=r.createContext({});function i(e){let{staticProps:s,children:n}=e;return(0,t.Y)(a.Provider,{value:s,children:n})}function c(){return r.useContext(a)}},79706:(e,s,n)=>{"use strict";var t=n(3717);function r(){}function a(){}a.resetWarningCache=r,e.exports=function(){function e(e,s,n,r,a,i){if(i!==t){var c=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function s(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:s,element:e,elementType:e,instanceOf:s,node:e,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:a,resetWarningCache:r};return n.PropTypes=n,n}},85419:(e,s,n)=>{"use strict";n.d(s,{A:()=>r});var t=n(18153);n(14232);let r=e=>{let{meta:s,isBlogPost:n}=e;return(0,t.FD)(t.FK,{children:[(0,t.Y)("h1",{className:"font-bold text-gray-800 mb-4 ".concat(n?"text-5xl mt-8 mb-8":"text-lg"),children:s.title}),(0,t.FD)("div",{className:"details",children:[(0,t.Y)("p",{className:"text-gray-500",children:s.description}),(0,t.Y)("p",{className:"text-gray-400 text-right -mt-1",children:(0,t.Y)("span",{className:"mr-4",children:s.date})})]})]})}},86089:(e,s,n)=>{"use strict";Object.defineProperty(s,"Ay",{enumerable:!0,get:function(){return t.default}});var t=function(e){if(e&&e.__esModule)return e;var s={};if(null!=e){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var t=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};t.get||t.set?Object.defineProperty(s,n,t):s[n]=e[n]}}return s.default=e,s}(n(56486))},88305:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>h,meta:()=>d});var t=n(37876),r=n(91668),a=n(91013);let i={src:"/_next/static/media/source-listing.9342ccb9.svg"},c={src:"/_next/static/media/scan.5c6cce41.svg"},l={src:"/_next/static/media/indexing.844b775b.svg"},d={title:"Yuebing 리뷰 #3",description:"Yoebing의 미디어 등록과 소비 과정을 살펴봅니다.",date:"2023-06-11",readTime:5},m=e=>{let{children:s,...n}=e;return(0,t.jsx)(a.A,{meta:d,staticProps:n,children:s})};function o(e){let s={a:"a",annotation:"annotation",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",math:"math",mi:"mi",mrow:"mrow",p:"p",pre:"pre",semantics:"semantics",span:"span",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{children:"Source"}),"\n",(0,t.jsxs)(s.p,{children:["Yuebing은 source라는 object storage 설정을 여러개 가질 수 있습니다.\n",(0,t.jsx)(s.code,{children:".env"}),"의 object storage 설정은 사용자 정보, 메타데이터 정보 등을 저장하는 설정 입니다."]}),"\n",(0,t.jsx)(s.p,{children:"admin 계정으로 로그인하면 컨텐트를 저장하는 원본 파일 저쟝용 object storage를 추가할 수 있습니다.\nYuebing은 원본 미디어 파일을 직접 업로드하는 기능을 제공하지는 않고 원본 파일 저장용 object storage에서 읽어와 처리합니다."}),"\n",(0,t.jsx)("img",{src:i.src}),"\n",(0,t.jsx)(s.h1,{children:"Scan"}),"\n",(0,t.jsx)(s.p,{children:"Source를 추가하면 scan 동작을 할 수 있습니다.\nScan은 source object storage에 있는 파일을 읽어와 Yuebing에서 제공하는 컨텐츠 형식으로 변환하는 작업을 합니다.\nYuebing의 핵심 기능이라고 할 수 있겠습니다."}),"\n",(0,t.jsx)("img",{src:c.src}),"\n",(0,t.jsxs)(s.p,{children:["Scan 과정은 앞서말한 transform이라고 하는 미디어 변환과정을 포함합니다.\nTransform은 먼저 source object storage에 있는 원본 파일을 Yuebing 인스턴스가 동작하는 환경의 폴더(",(0,t.jsx)(s.code,{children:"/tmp/yuebing_workdir"}),")로 복사하는 것으로 시작합니다.\n이렇게 복사한 파일을 대상으로 ",(0,t.jsx)(s.code,{children:"mediainfo"}),", ",(0,t.jsx)(s.code,{children:"ffmpeg"})," 명령을 사용하여 정보 추출, thumbnail 추출, 미디어 변환등을 수행합니다."]}),"\n",(0,t.jsx)(s.p,{children:"미디어 변환과정은 대략 다음과 같습니다."}),"\n",(0,t.jsx)(s.h2,{children:"artifact_mediainfo_details_starting_xform_video"}),"\n",(0,t.jsx)("pre",{children:(0,t.jsx)("code",{style:{whiteSpace:"break-spaces"},children:(0,t.jsx)(s.p,{children:"./scripts/mediainfo_wrapper '--Details=1' '/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/source.mp4'"})})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"mediainfo --details=1"})," 명령을 사용하여 미디어의 메타데이터, 코덱 정보등을 얻어옵니다."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.a,{href:"https://mediaarea.net/ko/MediaInfo",children:"MediaInfo"})}),"\n"]}),"\n",(0,t.jsx)(s.h2,{children:"artifact_mediainfo_json_starting_xform_video"}),"\n",(0,t.jsx)("pre",{children:(0,t.jsx)("code",{style:{whiteSpace:"break-spaces"},children:(0,t.jsx)(s.p,{children:"./scripts/mediainfo_wrapper '--Output=JSON' --Full\n'/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/source.mp4'"})})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"mediainfo --output=json"})," 명령으로 json 형식으로 출력합니다."]}),"\n",(0,t.jsx)(s.h2,{children:"artifact_dash_mp4_starting_xform_video"}),"\n",(0,t.jsx)("pre",{children:(0,t.jsx)("code",{style:{whiteSpace:"break-spaces"},children:(0,t.jsxs)(s.p,{children:["./scripts/ffmpeg_wrapper -i '/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/source.mp4' -map '0:a'\n'-c:a:0' aac '-b:a:0' 48k '-ar:0' 44100 '-ac:0' 1 -map '-0:s?' -map '0:v' '-c:v:0' libx264 '-b:v:0' 192k '-s:v:0'\n640x360 '-profile:v:0' main -window_size 1000000 -use_timeline 1 -use_template 1 -adaptation_sets 'id=0,streams=v\nid=1,streams=a' -init_seg_name 'asset_dash_mp4@video@init-stream",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"R"}),(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"p"}),(0,t.jsx)(s.mi,{children:"r"}),(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"s"}),(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"n"}),(0,t.jsx)(s.mi,{children:"t"}),(0,t.jsx)(s.mi,{children:"a"}),(0,t.jsx)(s.mi,{children:"t"}),(0,t.jsx)(s.mi,{children:"i"}),(0,t.jsx)(s.mi,{children:"o"}),(0,t.jsx)(s.mi,{children:"n"}),(0,t.jsx)(s.mi,{children:"I"}),(0,t.jsx)(s.mi,{children:"D"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"RepresentationID"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.8778em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"rese"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"a"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"I"}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"})]})})]}),".",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"x"}),(0,t.jsx)(s.mi,{children:"t"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"ext"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6151em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"t"})]})})]}),"' -media_seg_name\n'asset_dash_mp4@video@chunk-stream",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"R"}),(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"p"}),(0,t.jsx)(s.mi,{children:"r"}),(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"s"}),(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"n"}),(0,t.jsx)(s.mi,{children:"t"}),(0,t.jsx)(s.mi,{children:"a"}),(0,t.jsx)(s.mi,{children:"t"}),(0,t.jsx)(s.mi,{children:"i"}),(0,t.jsx)(s.mi,{children:"o"}),(0,t.jsx)(s.mi,{children:"n"}),(0,t.jsx)(s.mi,{children:"I"}),(0,t.jsx)(s.mi,{children:"D"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"RepresentationID"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.8778em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.00773em"},children:"R"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"p"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"rese"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"a"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"o"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"I"}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"})]})})]}),"-",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"N"}),(0,t.jsx)(s.mi,{children:"u"}),(0,t.jsx)(s.mi,{children:"m"}),(0,t.jsx)(s.mi,{children:"b"}),(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"r"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"Number%05d"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"u"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"mb"}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"er"})]})})]}),".",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"e"}),(0,t.jsx)(s.mi,{children:"x"}),(0,t.jsx)(s.mi,{children:"t"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"ext"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6151em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"e"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"t"})]})})]}),"' -hls_playlist true -hls_master_name\n'asset_hls_m3u8@video@master.m3u8' -f dash -y\n'/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_dash_mp4@video@001.mpd'"]})})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.a,{href:"https://www.cloudflare.com/ko-kr/learning/video/what-is-mpeg-dash/",children:"MPEG-DASH란 무엇입니까? | HLS와 DASH의 비교 | Cloudflare"})}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"ffmpeg"})," 명령으로 mpeg-dash streaming 변환을 합니다."]}),"\n",(0,t.jsx)(s.p,{children:"Map audio track"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"-map '0:a' '-c:a:0' aac '-b:a:0' 48k '-ar:0' 44100 '-ac:0' 1\n"})}),"\n",(0,t.jsx)(s.p,{children:"Skip subtitle track"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"-map '-0:s?'\n"})}),"\n",(0,t.jsx)(s.p,{children:"Map video track"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"-map '0:v' '-c:v:0' libx264 '-b:v:0' 192k '-s:v:0' 640x360 '-profile:v:0' main\n"})}),"\n",(0,t.jsx)(s.p,{children:"the playlist should always contain all segments"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"-window_size 1000000\n"})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://m.blog.naver.com/suin2_91/221155034091",children:"비디오 스트리밍(Video Streaming)의 이해 및 MPEG DASH 개념정리 : 네이버 블로그"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://moony211.medium.com/dash-%EB%AF%B8%EB%94%94%EC%96%B4-%EC%83%9D%EC%84%B1%ED%95%A0-%EB%95%8C-segment%EC%99%80-fragment-8ef19da545e3",children:"DASH 미디어 생성할 때, segment와 fragment | by 이상문 | Medium"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://kibua20.tistory.com/161",children:"카카오 TV 1080p 동영상 다운로드: MPEG DASH의 MPD 활용"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://github.com/swcho/yuebing/blob/9e3cc294d8b519695c035bed41eed3ea6986d7b7/serverMiddleware/asset/driver/video.js#L47",children:"serverMiddleware/asset/driver/video.js"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://frontdev.tistory.com/entry/ffmpeg%EB%A1%9C-hls-%EB%A7%8C%EB%93%A4%EA%B8%B0-%EC%98%B5%EC%85%98%EC%A0%95%EB%A6%AC",children:"ffmpeg로 hls 만들기, 옵션정리"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{children:"artifact_thumbnail_small_starting_xform_video"}),"\n",(0,t.jsx)("pre",{children:(0,t.jsx)("code",{style:{whiteSpace:"break-spaces"},children:(0,t.jsx)(s.p,{children:"./scripts/ffmpeg_wrapper -i '/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/source.mp4' -s vga -vf\n'fps=1/60' -y '/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_thumbnail_small@video@%03d.jpg'"})})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"ffmpeg"}),"으로 1분 간격으로 vga(640x480) thumbnail을 생성합니다."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.a,{href:"https://github.com/swcho/yuebing/blob/ex/serverMiddleware/asset/driver/video.js#L146",children:"thumbnails"})}),"\n"]}),"\n",(0,t.jsx)(s.h2,{children:"artifact_first_thumbnail_small_starting_xform_video"}),"\n",(0,t.jsx)("pre",{children:(0,t.jsx)("code",{style:{whiteSpace:"break-spaces"},children:(0,t.jsx)(s.p,{children:"./scripts/ffmpeg_wrapper -ss 6 -accurate_seek -i\n'/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/source.mp4' -s vga '-frames:v' 1 -y\n'/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_first_thumbnail_small@video@.jpg'"})})}),"\n",(0,t.jsx)(s.p,{children:"첫번째 프레임을 vga(640x480) thumbnail로 생성합니다."}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.a,{href:"https://github.com/swcho/yuebing/blob/ex/serverMiddleware/asset/driver/video.js#L159",children:"firstThumbnail"})}),"\n"]}),"\n",(0,t.jsx)(s.h2,{children:"artifact_thumbnail_medium_starting_xform_video"}),"\n",(0,t.jsx)("pre",{children:(0,t.jsx)("code",{style:{whiteSpace:"break-spaces"},children:(0,t.jsx)(s.p,{children:"./scripts/ffmpeg_wrapper -i '/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/source.mp4' -s hd720 -vf\n'fps=1/60' -y '/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_thumbnail_medium@video@%03d.jpg'"})})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"ffmpeg"}),"으로 1분 간격으로 hd720(1280x720) thumbnail을 생성합니다."]}),"\n",(0,t.jsx)(s.h2,{children:"artifact_thumbnail_large_starting_xform_video"}),"\n",(0,t.jsx)("pre",{children:(0,t.jsx)("code",{style:{whiteSpace:"break-spaces"},children:(0,t.jsx)(s.p,{children:"./scripts/ffmpeg_wrapper -i '/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/source.mp4' -s hd1080 -vf\n'fps=1/60' -y '/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_thumbnail_large@video@%03d.jpg'"})})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"ffmpeg"}),"으로 1분 간격으로 hd1080(1920, 1080) thumbnail을 생성합니다."]}),"\n",(0,t.jsx)(s.h2,{children:"artifact_first_thumbnail_large_starting_xform_video"}),"\n",(0,t.jsx)("pre",{children:(0,t.jsx)("code",{style:{whiteSpace:"break-spaces"},children:(0,t.jsx)(s.p,{children:"./scripts/ffmpeg_wrapper -ss 6 -accurate_seek -i\n'/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/source.mp4' -s hd1080 '-frames:v' 1 -y\n'/tmp/yuebing_workdir/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_first_thumbnail_large@video@.jpg'"})})}),"\n",(0,t.jsx)(s.p,{children:"첫번째 프레임을 hd1080(1920x1080) thumbnail로 생성합니다."}),"\n",(0,t.jsx)(s.h2,{children:"자막 복사"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"artifact_vttTracks_copy_starting_xform_video"}),"\n",(0,t.jsx)(s.li,{children:"artifact_srtTracks_copy_starting_xform_video"}),"\n",(0,t.jsx)(s.li,{children:"artifact_srt2vttTracks_starting_xform_video"}),"\n"]}),"\n",(0,t.jsx)(s.h1,{children:"Indexing"}),"\n",(0,t.jsx)("img",{src:l.src}),"\n",(0,t.jsx)(s.p,{children:"Indexing 과정을 통해 transform 과정을 통해 생성한 파일들의 정보를 다음과 같은 형식으로 정리합니다."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "ctime": 1686467653174,\n  "assets": {\n    "dash_mp4": ["assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_dash_mp4@video@001.mpd"],\n    "first_thumbnail_large": [\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_first_thumbnail_large@video@.jpg"\n    ],\n    "first_thumbnail_medium": [\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_first_thumbnail_medium@video@.jpg"\n    ],\n    "first_thumbnail_small": [\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_first_thumbnail_small@video@.jpg"\n    ],\n    "hls_m3u8": ["assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_hls_m3u8@video@master.m3u8"],\n    "mediainfo_details": [\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_mediainfo_details@video@.txt"\n    ],\n    "mediainfo_json": ["assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_mediainfo_json@video@.json"],\n    "thumbnail_large": [\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_thumbnail_large@video@001.jpg",\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_thumbnail_large@video@002.jpg"\n    ],\n    "thumbnail_medium": [\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_thumbnail_medium@video@001.jpg",\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_thumbnail_medium@video@002.jpg"\n    ],\n    "thumbnail_small": [\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_thumbnail_small@video@001.jpg",\n      "assets/8b/5c/34/8b5c34fb9d00015880cb408f9d6410ace182b529/asset_thumbnail_small@video@002.jpg"\n    ]\n  },\n  "status": {\n    "info": true,\n    "ready": true\n  }\n}\n'})}),"\n",(0,t.jsx)(s.h1,{children:"마치며"}),"\n",(0,t.jsx)(s.p,{children:"Yuebing은 개인 미디어 파일들을 손쉽게 관리하고 공유할 수 있도록 도와줍니다.\n파일기반으로 회원을 관리하는 방식과 함께, 비디오 변환, 인덱싱, 검색등에 대한 다양한 인사이트를 얻을 수 있었습니다."})]})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.jsx)(m,{...e,children:(0,t.jsx)(o,{...e})})}},91013:(e,s,n)=>{"use strict";n.d(s,{A:()=>o});var t=n(18153),r=n(73146),a=n.n(r),i=n(14232),c=n(86089),l=n(60158),d=n(85419),m=n(49034);function o(e){let{children:s,meta:n,staticProps:r}=e;return i.useEffect(()=>{a().highlightAll()},[]),(0,t.Y)(t.FK,{children:(0,t.FD)(m.A,{title:n.title,children:[(0,t.Y)(d.A,{meta:n,isBlogPost:!0}),(0,t.Y)(l.j,{staticProps:r,children:(0,t.Y)("article",{className:"markdown",children:s})}),(0,t.Y)(c.Ay,{repo:"swcho/blog-comments",type:"pathname",label:"utterances",theme:"github-light"})]})})}},95062:(e,s,n)=>{e.exports=n(79706)()}},e=>{e.O(0,[5695,636,6593,8792],()=>e(e.s=26860)),_N_E=e.O()}]);
//# sourceMappingURL=2023-06-11-yuebing-part-3-0db113fd67062d0b.js.map