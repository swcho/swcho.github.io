(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5506],{3717:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},13703:(t,e,i)=>{"use strict";i.d(e,{A:()=>s});let s=(0,i(60627).A)("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf")},31648:(t,e,i)=>{"use strict";i.d(e,{b:()=>r});var s=i(14796);function r(t,e,i,r){var o;return(o=class extends s.ShaderMaterial{constructor(o){for(let r in super({vertexShader:e,fragmentShader:i,...o}),t)this.uniforms[r]=new s.Uniform(t[r]),Object.defineProperty(this,r,{get(){return this.uniforms[r].value},set(t){this.uniforms[r].value=t}});this.uniforms=s.UniformsUtils.clone(this.uniforms),null==r||r(this)}}).key=s.MathUtils.generateUUID(),o}},44501:(t,e,i)=>{"use strict";function s(){return(s=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)({}).hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(null,arguments)}i.d(e,{A:()=>s})},56486:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.identifierTypes=void 0;var s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};s.get||s.set?Object.defineProperty(e,i,s):e[i]=t[i]}}return e.default=t,e}(i(14232)),r=function(t){return t&&t.__esModule?t:{default:t}}(i(95062));function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=["pathname","url","title","og:title","issue-number","issue-term"],l=function(t,e,i){if(0>h.indexOf(t))return void console.warn("Wrong type: "+t);if("pathname"===t)return"pathname";if("url"===t)return"url";if("title"===t)return"title";if("og:title"===t)return"og:title";if("issue-term"===t)return e;else if("issue-number"===t)return i},_=function(t){var e;if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");function i(t){var e,r;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");return(e=(r=n(i).call(this,t))&&("object"===o(r)||"function"==typeof r)?r:function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(this)).myRef=s.default.createRef(),e.state={pending:!0},e}return i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&a(i,t),e=[{key:"componentDidMount",value:function(){var t=this,e=this.props,i=e.repo,s=e.type,r=e.specificTerm,o=e.issueNumber,n=0>h.indexOf(s)?void console.warn("Wrong type: "+s):"issue-number"===s?"issue-number":"issue-term",a=l(s,r,o);if("issue-term"===s&&!a)return void console.warn("When type is '".concat(s,"', 'specificTerm' prop must be provided"));if("issue-number"===s&&(isNaN(a)||a<1))return void console.warn("When type is '".concat(s,"', valid 'issueNumber' prop must be provided"));var _=document.createElement("script");_.src="https://utteranc.es/client.js",_.async=!0,_.setAttribute("repo",i),_.setAttribute("crossorigin","anonymous"),_.setAttribute(n,a),_.onload=function(){return t.setState({pending:!1})},this.myRef.current.appendChild(_)}},{key:"render",value:function(){return s.default.createElement("div",{className:"react-utterences",ref:this.myRef},this.props.debug&&s.default.createElement("pre",{style:{background:"#cccccc",padding:10}},"\nthis.props: ".concat(JSON.stringify(this.props,null,2),'\nlocation.pathname: "').concat(window.location.pathname,'"\nlocation.href: "').concat(window.location.href,'"\n          ').trim()),this.props.debug&&s.default.createElement("div",null,"\uD83D\uDC47\uD83D\uDC47If the settings are valid, the comment widget appear below\uD83D\uDC47\uD83D\uDC47"),this.state.pending&&s.default.createElement("div",null,"Loading script..."))}}],function(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}(i.prototype,e),i}(s.Component);e.identifierTypes={pathname:{attrValue:"",summary:"Issue title contains page pathname"},url:{attrValue:"url",summary:"Issue title contains page URL"},title:{attrValue:"title",summary:"Issue title contains page title"},"og:title":{attrValue:"og:title",summary:"Issue title contains page og:title"},"issue-number":{attrValue:-1,summary:"Specific issue number"},"issue-term":{attrValue:"",summary:"Issue title contains specific term"}},_.propTypes={type:r.default.string.isRequired,repo:r.default.string.isRequired,specificTerm:r.default.string,issueNumber:r.default.number,hashKey:r.default.string,debug:r.default.bool},e.default=_},60627:(t,e,i)=>{"use strict";function s(t){for(var e=t.length/6|0,i=Array(e),s=0;s<e;)i[s]="#"+t.slice(6*s,6*++s);return i}i.d(e,{A:()=>s})},79706:(t,e,i)=>{"use strict";var s=i(3717);function r(){}function o(){}o.resetWarningCache=r,t.exports=function(){function t(t,e,i,r,o,n){if(n!==s){var a=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var i={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:r};return i.PropTypes=i,i}},84477:(t,e,i)=>{"use strict";let s,r,o,n,a,h,l,_,c,d,m,p,u,O,f,E,y,g,T,C,v,U,L;i.d(e,{a:()=>$});var D,A=i(44501),x=i(14796),S=i(14232),P=i(71804);let b={LEFT:1,RIGHT:2,MIDDLE:4},R=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),w={NONE:0,IN:1,OUT:-1};function z(t){return t.isPerspectiveCamera}function M(t){return t.isOrthographicCamera}let F=2*Math.PI,N=Math.PI/2,H=Math.PI/180;function k(t,e,i){return Math.max(e,Math.min(i,t))}function V(t,e=1e-5){return Math.abs(t)<e}function Y(t,e,i=1e-5){return V(t-e,i)}function I(t,e){return Math.round(t/e)*e}function Z(t){return isFinite(t)?t:t<0?-Number.MAX_VALUE:Number.MAX_VALUE}function B(t){return Math.abs(t)<Number.MAX_VALUE?t:1/0*t}function K(t,e,i,s,r=1/0,o){let n=2/(s=Math.max(1e-4,s)),a=n*o,h=1/(1+a+.48*a*a+.235*a*a*a),l=t-e,_=e,c=r*s;e=t-(l=k(l,-c,c));let d=(i.value+n*l)*o;i.value=(i.value-n*d)*h;let m=e+(l+d)*h;return _-t>0==m>_&&(i.value=((m=_)-_)/o),m}function j(t,e,i,s,r=1/0,o,n){let a=2/(s=Math.max(1e-4,s)),h=a*o,l=1/(1+h+.48*h*h+.235*h*h*h),_=e.x,c=e.y,d=e.z,m=t.x-_,p=t.y-c,u=t.z-d,O=_,f=c,E=d,y=r*s,g=m*m+p*p+u*u;if(g>y*y){let t=Math.sqrt(g);m=m/t*y,p=p/t*y,u=u/t*y}_=t.x-m,c=t.y-p,d=t.z-u;let T=(i.x+a*m)*o,C=(i.y+a*p)*o,v=(i.z+a*u)*o;i.x=(i.x-a*T)*l,i.y=(i.y-a*C)*l,i.z=(i.z-a*v)*l,n.x=_+(m+T)*l,n.y=c+(p+C)*l,n.z=d+(u+v)*l;let U=O-t.x,L=f-t.y,D=E-t.z,A=n.x-O;return U*A+L*(n.y-f)+D*(n.z-E)>0&&(n.x=O,n.y=f,n.z=E,i.x=(n.x-O)/o,i.y=(n.y-f)/o,i.z=(n.z-E)/o),n}function X(t,e){e.set(0,0),t.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=t.length,e.y/=t.length}function Q(t,e){return!!M(t)&&(console.warn(`${e} is not supported in OrthographicCamera`),!0)}class W{constructor(){this._listeners={}}addEventListener(t,e){let i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)}hasEventListener(t,e){let i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)}removeEventListener(t,e){let i=this._listeners[t];if(void 0!==i){let t=i.indexOf(e);-1!==t&&i.splice(t,1)}}removeAllEventListeners(t){if(!t){this._listeners={};return}Array.isArray(this._listeners[t])&&(this._listeners[t].length=0)}dispatchEvent(t){let e=this._listeners[t.type];if(void 0!==e){t.target=this;let i=e.slice(0);for(let e=0,s=i.length;e<s;e++)i[e].call(this,t)}}}let q=1/8,G=/Mac/.test(null==(D=null==globalThis?void 0:globalThis.navigator)?void 0:D.platform);class J extends W{static install(t){r=Object.freeze(new(s=t.THREE).Vector3(0,0,0)),o=Object.freeze(new s.Vector3(0,1,0)),n=Object.freeze(new s.Vector3(0,0,1)),a=new s.Vector2,h=new s.Vector3,l=new s.Vector3,_=new s.Vector3,c=new s.Vector3,d=new s.Vector3,m=new s.Vector3,p=new s.Vector3,u=new s.Vector3,O=new s.Vector3,f=new s.Spherical,E=new s.Spherical,y=new s.Box3,g=new s.Box3,T=new s.Sphere,C=new s.Quaternion,v=new s.Quaternion,U=new s.Matrix4,L=new s.Raycaster}static get ACTION(){return R}set verticalDragToForward(t){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(t,e){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=R.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=w.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new s.Vector3,this._focalOffsetVelocity=new s.Vector3,this._zoomVelocity={value:0},this._truckInternal=(t,e,i,s)=>{let r,o;if(z(this._camera)){let i=h.copy(this._camera.position).sub(this._target),s=this._camera.getEffectiveFOV()*H,n=i.length()*Math.tan(.5*s);r=this.truckSpeed*t*n/this._elementRect.height,o=this.truckSpeed*e*n/this._elementRect.height}else{if(!M(this._camera))return;let i=this._camera;r=this.truckSpeed*t*(i.right-i.left)/i.zoom/this._elementRect.width,o=this.truckSpeed*e*(i.top-i.bottom)/i.zoom/this._elementRect.height}s?(i?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(r,0,!0),this.forward(-o,!0)):i?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y+o,this._focalOffsetEnd.z,!0):this.truck(r,o,!0)},this._rotateInternal=(t,e)=>{let i=F*this.azimuthRotateSpeed*t/this._elementRect.height,s=F*this.polarRotateSpeed*e/this._elementRect.height;this.rotate(i,s,!0)},this._dollyInternal=(t,e,i)=>{let s=Math.pow(.95,-t*this.dollySpeed),r=this._sphericalEnd.radius,o=this._sphericalEnd.radius*s,n=k(o,this.minDistance,this.maxDistance),a=n-o;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(o,!0):(this.infinityDolly&&!this.dollyToCursor&&this.dollyInFixed(a,!0),this._dollyToNoClamp(n,!0)),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?o:n)-r,this._dollyControlCoord.set(e,i)),this._lastDollyDirection=Math.sign(-t)},this._zoomInternal=(t,e,i)=>{let s=Math.pow(.95,t*this.dollySpeed),r=this._zoom,o=this._zoom*s;this.zoomTo(o,!0),this.dollyToCursor&&(this._changedZoom+=o-r,this._dollyControlCoord.set(e,i))},void 0===s&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=new s.Quaternion().setFromUnitVectors(this._camera.up,o),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=R.NONE,this._target=new s.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new s.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new s.Spherical().setFromVector3(h.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new s.Vector3,new s.Vector3,new s.Vector3,new s.Vector3],this._updateNearPlaneCorners(),this._boundary=new s.Box3(new s.Vector3(-1/0,-1/0,-1/0),new s.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new s.Vector2,this.mouseButtons={left:R.ROTATE,middle:R.DOLLY,right:R.TRUCK,wheel:z(this._camera)?R.DOLLY:M(this._camera)?R.ZOOM:R.NONE},this.touches={one:R.TOUCH_ROTATE,two:z(this._camera)?R.TOUCH_DOLLY_TRUCK:M(this._camera)?R.TOUCH_ZOOM_TRUCK:R.NONE,three:R.TOUCH_TRUCK};let i=new s.Vector2,r=new s.Vector2,n=new s.Vector2,l=t=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let e=this._domElement.getBoundingClientRect(),i=t.clientX/e.width,s=t.clientY/e.height;if(i<this._interactiveArea.left||i>this._interactiveArea.right||s<this._interactiveArea.top||s>this._interactiveArea.bottom)return}let e="mouse"!==t.pointerType?null:(t.buttons&b.LEFT)===b.LEFT?b.LEFT:(t.buttons&b.MIDDLE)===b.MIDDLE?b.MIDDLE:(t.buttons&b.RIGHT)===b.RIGHT?b.RIGHT:null;if(null!==e){let t=this._findPointerByMouseButton(e);t&&this._disposePointer(t)}if((t.buttons&b.LEFT)===b.LEFT&&this._lockedPointer)return;let i={pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY,deltaX:0,deltaY:0,mouseButton:e};this._activePointers.push(i),this._domElement.ownerDocument.removeEventListener("pointermove",_,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.addEventListener("pointermove",_,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",c),this._isDragging=!0,u(t)},_=t=>{t.cancelable&&t.preventDefault();let e=t.pointerId,i=this._lockedPointer||this._findPointerById(e);if(i){if(i.clientX=t.clientX,i.clientY=t.clientY,i.deltaX=t.movementX,i.deltaY=t.movementY,this._state=0,"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(t.buttons&b.LEFT)===b.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(t.buttons&b.MIDDLE)===b.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(t.buttons&b.RIGHT)===b.RIGHT&&(this._state=this._state|this.mouseButtons.right);O()}},c=t=>{let e=this._findPointerById(t.pointerId);if(!e||e!==this._lockedPointer){if(e&&this._disposePointer(e),"touch"===t.pointerType)switch(this._activePointers.length){case 0:this._state=R.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=R.NONE;f()}},d=-1,m=t=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===R.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let e=this._domElement.getBoundingClientRect(),i=t.clientX/e.width,s=t.clientY/e.height;if(i<this._interactiveArea.left||i>this._interactiveArea.right||s<this._interactiveArea.top||s>this._interactiveArea.bottom)return}if(t.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===R.ROTATE||this.mouseButtons.wheel===R.TRUCK){let t=performance.now();d-t<1e3&&this._getClientRect(this._elementRect),d=t}let e=G?-1:-3,i=1===t.deltaMode||t.ctrlKey?t.deltaY/e:t.deltaY/(10*e),s=this.dollyToCursor?(t.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,r=this.dollyToCursor?-((t.clientY-this._elementRect.y)/this._elementRect.height*2)+1:0;switch(this.mouseButtons.wheel){case R.ROTATE:this._rotateInternal(t.deltaX,t.deltaY),this._isUserControllingRotate=!0;break;case R.TRUCK:this._truckInternal(t.deltaX,t.deltaY,!1,!1),this._isUserControllingTruck=!0;break;case R.SCREEN_PAN:this._truckInternal(t.deltaX,t.deltaY,!1,!0),this._isUserControllingTruck=!0;break;case R.OFFSET:this._truckInternal(t.deltaX,t.deltaY,!0,!1),this._isUserControllingOffset=!0;break;case R.DOLLY:this._dollyInternal(-i,s,r),this._isUserControllingDolly=!0;break;case R.ZOOM:this._zoomInternal(-i,s,r),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},p=t=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===J.ACTION.NONE){let e=t instanceof PointerEvent?t.pointerId:0,i=this._findPointerById(e);i&&this._disposePointer(i),this._domElement.ownerDocument.removeEventListener("pointermove",_,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c);return}t.preventDefault()}},u=t=>{if(this._enabled){if(X(this._activePointers,a),this._getClientRect(this._elementRect),i.copy(a),r.copy(a),this._activePointers.length>=2){let t=a.x-this._activePointers[1].clientX,e=a.y-this._activePointers[1].clientY,i=Math.sqrt(t*t+e*e);n.set(0,i);let s=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,o=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;r.set(s,o)}if(this._state=0,t)if("pointerType"in t&&"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._lockedPointer||(t.buttons&b.LEFT)!==b.LEFT||(this._state=this._state|this.mouseButtons.left),(t.buttons&b.MIDDLE)===b.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&b.RIGHT)===b.RIGHT&&(this._state=this._state|this.mouseButtons.right);else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);((this._state&R.ROTATE)===R.ROTATE||(this._state&R.TOUCH_ROTATE)===R.TOUCH_ROTATE||(this._state&R.TOUCH_DOLLY_ROTATE)===R.TOUCH_DOLLY_ROTATE||(this._state&R.TOUCH_ZOOM_ROTATE)===R.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&R.TRUCK)===R.TRUCK||(this._state&R.SCREEN_PAN)===R.SCREEN_PAN||(this._state&R.TOUCH_TRUCK)===R.TOUCH_TRUCK||(this._state&R.TOUCH_SCREEN_PAN)===R.TOUCH_SCREEN_PAN||(this._state&R.TOUCH_DOLLY_TRUCK)===R.TOUCH_DOLLY_TRUCK||(this._state&R.TOUCH_DOLLY_SCREEN_PAN)===R.TOUCH_DOLLY_SCREEN_PAN||(this._state&R.TOUCH_ZOOM_TRUCK)===R.TOUCH_ZOOM_TRUCK||(this._state&R.TOUCH_ZOOM_SCREEN_PAN)===R.TOUCH_DOLLY_SCREEN_PAN)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&R.DOLLY)===R.DOLLY||(this._state&R.TOUCH_DOLLY)===R.TOUCH_DOLLY||(this._state&R.TOUCH_DOLLY_TRUCK)===R.TOUCH_DOLLY_TRUCK||(this._state&R.TOUCH_DOLLY_SCREEN_PAN)===R.TOUCH_DOLLY_SCREEN_PAN||(this._state&R.TOUCH_DOLLY_OFFSET)===R.TOUCH_DOLLY_OFFSET||(this._state&R.TOUCH_DOLLY_ROTATE)===R.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&R.ZOOM)===R.ZOOM||(this._state&R.TOUCH_ZOOM)===R.TOUCH_ZOOM||(this._state&R.TOUCH_ZOOM_TRUCK)===R.TOUCH_ZOOM_TRUCK||(this._state&R.TOUCH_ZOOM_SCREEN_PAN)===R.TOUCH_ZOOM_SCREEN_PAN||(this._state&R.TOUCH_ZOOM_OFFSET)===R.TOUCH_ZOOM_OFFSET||(this._state&R.TOUCH_ZOOM_ROTATE)===R.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&R.OFFSET)===R.OFFSET||(this._state&R.TOUCH_OFFSET)===R.TOUCH_OFFSET||(this._state&R.TOUCH_DOLLY_OFFSET)===R.TOUCH_DOLLY_OFFSET||(this._state&R.TOUCH_ZOOM_OFFSET)===R.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},O=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,X(this._activePointers,a);let t=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,e=t?-t.deltaX:r.x-a.x,s=t?-t.deltaY:r.y-a.y;if(r.copy(a),((this._state&R.ROTATE)===R.ROTATE||(this._state&R.TOUCH_ROTATE)===R.TOUCH_ROTATE||(this._state&R.TOUCH_DOLLY_ROTATE)===R.TOUCH_DOLLY_ROTATE||(this._state&R.TOUCH_ZOOM_ROTATE)===R.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(e,s),this._isUserControllingRotate=!0),(this._state&R.DOLLY)===R.DOLLY||(this._state&R.ZOOM)===R.ZOOM){let t=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,e=this.dollyToCursor?-((i.y-this._elementRect.y)/this._elementRect.height*2)+1:0,r=this.dollyDragInverted?-1:1;(this._state&R.DOLLY)===R.DOLLY?(this._dollyInternal(r*s*q,t,e),this._isUserControllingDolly=!0):(this._zoomInternal(r*s*q,t,e),this._isUserControllingZoom=!0)}if((this._state&R.TOUCH_DOLLY)===R.TOUCH_DOLLY||(this._state&R.TOUCH_ZOOM)===R.TOUCH_ZOOM||(this._state&R.TOUCH_DOLLY_TRUCK)===R.TOUCH_DOLLY_TRUCK||(this._state&R.TOUCH_ZOOM_TRUCK)===R.TOUCH_ZOOM_TRUCK||(this._state&R.TOUCH_DOLLY_SCREEN_PAN)===R.TOUCH_DOLLY_SCREEN_PAN||(this._state&R.TOUCH_ZOOM_SCREEN_PAN)===R.TOUCH_ZOOM_SCREEN_PAN||(this._state&R.TOUCH_DOLLY_OFFSET)===R.TOUCH_DOLLY_OFFSET||(this._state&R.TOUCH_ZOOM_OFFSET)===R.TOUCH_ZOOM_OFFSET||(this._state&R.TOUCH_DOLLY_ROTATE)===R.TOUCH_DOLLY_ROTATE||(this._state&R.TOUCH_ZOOM_ROTATE)===R.TOUCH_ZOOM_ROTATE){let t=a.x-this._activePointers[1].clientX,e=a.y-this._activePointers[1].clientY,i=Math.sqrt(t*t+e*e),s=n.y-i;n.set(0,i);let o=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,h=this.dollyToCursor?-((r.y-this._elementRect.y)/this._elementRect.height*2)+1:0;(this._state&R.TOUCH_DOLLY)===R.TOUCH_DOLLY||(this._state&R.TOUCH_DOLLY_ROTATE)===R.TOUCH_DOLLY_ROTATE||(this._state&R.TOUCH_DOLLY_TRUCK)===R.TOUCH_DOLLY_TRUCK||(this._state&R.TOUCH_DOLLY_SCREEN_PAN)===R.TOUCH_DOLLY_SCREEN_PAN||(this._state&R.TOUCH_DOLLY_OFFSET)===R.TOUCH_DOLLY_OFFSET?(this._dollyInternal(s*q,o,h),this._isUserControllingDolly=!0):(this._zoomInternal(s*q,o,h),this._isUserControllingZoom=!0)}((this._state&R.TRUCK)===R.TRUCK||(this._state&R.TOUCH_TRUCK)===R.TOUCH_TRUCK||(this._state&R.TOUCH_DOLLY_TRUCK)===R.TOUCH_DOLLY_TRUCK||(this._state&R.TOUCH_ZOOM_TRUCK)===R.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(e,s,!1,!1),this._isUserControllingTruck=!0),((this._state&R.SCREEN_PAN)===R.SCREEN_PAN||(this._state&R.TOUCH_SCREEN_PAN)===R.TOUCH_SCREEN_PAN||(this._state&R.TOUCH_DOLLY_SCREEN_PAN)===R.TOUCH_DOLLY_SCREEN_PAN||(this._state&R.TOUCH_ZOOM_SCREEN_PAN)===R.TOUCH_ZOOM_SCREEN_PAN)&&(this._truckInternal(e,s,!1,!0),this._isUserControllingTruck=!0),((this._state&R.OFFSET)===R.OFFSET||(this._state&R.TOUCH_OFFSET)===R.TOUCH_OFFSET||(this._state&R.TOUCH_DOLLY_OFFSET)===R.TOUCH_DOLLY_OFFSET||(this._state&R.TOUCH_ZOOM_OFFSET)===R.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(e,s,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},f=()=>{X(this._activePointers,a),r.copy(a),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",_,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{this._enabled&&this._domElement&&(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",_,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",E),this._domElement.ownerDocument.addEventListener("pointerlockerror",y),this._domElement.ownerDocument.addEventListener("pointermove",_,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",c),u())},this.unlockPointer=()=>{var t,e,i;null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),null==(t=this._domElement)||t.ownerDocument.exitPointerLock(),null==(e=this._domElement)||e.ownerDocument.removeEventListener("pointerlockchange",E),null==(i=this._domElement)||i.ownerDocument.removeEventListener("pointerlockerror",y),this.cancel()};let E=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},y=()=>{this.unlockPointer()};this._addAllEventListeners=t=>{this._domElement=t,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",l),this._domElement.addEventListener("pointercancel",c),this._domElement.addEventListener("wheel",m,{passive:!1}),this._domElement.addEventListener("contextmenu",p)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",l),this._domElement.removeEventListener("pointercancel",c),this._domElement.removeEventListener("wheel",m,{passive:!1}),this._domElement.removeEventListener("contextmenu",p),this._domElement.ownerDocument.removeEventListener("pointermove",_,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("pointerlockchange",E),this._domElement.ownerDocument.removeEventListener("pointerlockerror",y))},this.cancel=()=>{this._state!==R.NONE&&(this._state=R.NONE,this._activePointers.length=0,f())},e&&this.connect(e),this.update(0)}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._domElement&&(t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){(this._spherical.radius!==t||this._sphericalEnd.radius!==t)&&(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){(this._spherical.theta!==t||this._sphericalEnd.theta!==t)&&(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){(this._spherical.phi!==t||this._sphericalEnd.phi!==t)&&(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}set interactiveArea(t){this._interactiveArea.width=k(t.width,0,1),this._interactiveArea.height=k(t.height,0,1),this._interactiveArea.x=k(t.x,0,1-this._interactiveArea.width),this._interactiveArea.y=k(t.y,0,1-this._interactiveArea.height)}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,i=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,i)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,i=!1){this._isUserControllingRotate=!1;let s=k(t,this.minAzimuthAngle,this.maxAzimuthAngle),r=k(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=s,this._sphericalEnd.phi=r,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);let o=!i||Y(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Y(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=w.NONE,this._changedDolly=0,this._dollyToNoClamp(k(t,this.minDistance,this.maxDistance),e)}_dollyToNoClamp(t,e=!1){let i=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){let e=this._collisionTest(),s=Y(e,this._spherical.radius);if(!(i>t)&&s)return Promise.resolve();this._sphericalEnd.radius=Math.min(t,e)}else this._sphericalEnd.radius=t;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);let s=!e||Y(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(s)}dollyInFixed(t,e=!1){this._targetEnd.add(this._getCameraDirection(c).multiplyScalar(t)),e||this._target.copy(this._targetEnd);let i=!e||Y(this._target.x,this._targetEnd.x,this.restThreshold)&&Y(this._target.y,this._targetEnd.y,this.restThreshold)&&Y(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._isUserControllingZoom=!1,this._zoomEnd=k(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);let i=!e||Y(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(i)}pan(t,e,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,i)}truck(t,e,i=!1){this._camera.updateMatrix(),d.setFromMatrixColumn(this._camera.matrix,0),m.setFromMatrixColumn(this._camera.matrix,1),d.multiplyScalar(t),m.multiplyScalar(-e);let s=h.copy(d).add(m),r=l.copy(this._targetEnd).add(s);return this.moveTo(r.x,r.y,r.z,i)}forward(t,e=!1){h.setFromMatrixColumn(this._camera.matrix,0),h.crossVectors(this._camera.up,h),h.multiplyScalar(t);let i=l.copy(this._targetEnd).add(h);return this.moveTo(i.x,i.y,i.z,e)}elevate(t,e=!1){return h.copy(this._camera.up).multiplyScalar(t),this.moveTo(this._targetEnd.x+h.x,this._targetEnd.y+h.y,this._targetEnd.z+h.z,e)}moveTo(t,e,i,s=!1){this._isUserControllingTruck=!1;let r=h.set(t,e,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,r,this.boundaryFriction),this._needsUpdate=!0,s||this._target.copy(this._targetEnd);let o=!s||Y(this._target.x,this._targetEnd.x,this.restThreshold)&&Y(this._target.y,this._targetEnd.y,this.restThreshold)&&Y(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(t,e,i,s=!1){let r=h.set(t,e,i).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(r.x,r.y,r.z,s)}fitToBox(t,e,{cover:i=!1,paddingLeft:s=0,paddingRight:r=0,paddingBottom:a=0,paddingTop:_=0}={}){let c=[],d=t.isBox3?y.copy(t):y.setFromObject(t);d.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());let m=I(this._sphericalEnd.theta,N),p=I(this._sphericalEnd.phi,N);c.push(this.rotateTo(m,p,e));let u=h.setFromSpherical(this._sphericalEnd).normalize(),O=C.setFromUnitVectors(u,n),f=Y(Math.abs(u.y),1);f&&O.multiply(v.setFromAxisAngle(o,m)),O.multiply(this._yAxisUpSpaceInverse);let E=g.makeEmpty();l.copy(d.min).applyQuaternion(O),E.expandByPoint(l),l.copy(d.min).setX(d.max.x).applyQuaternion(O),E.expandByPoint(l),l.copy(d.min).setY(d.max.y).applyQuaternion(O),E.expandByPoint(l),l.copy(d.max).setZ(d.min.z).applyQuaternion(O),E.expandByPoint(l),l.copy(d.min).setZ(d.max.z).applyQuaternion(O),E.expandByPoint(l),l.copy(d.max).setY(d.min.y).applyQuaternion(O),E.expandByPoint(l),l.copy(d.max).setX(d.min.x).applyQuaternion(O),E.expandByPoint(l),l.copy(d.max).applyQuaternion(O),E.expandByPoint(l),E.min.x-=s,E.min.y-=a,E.max.x+=r,E.max.y+=_,O.setFromUnitVectors(n,u),f&&O.premultiply(v.invert()),O.premultiply(this._yAxisUpSpace);let T=E.getSize(h),U=E.getCenter(l).applyQuaternion(O);if(z(this._camera)){let t=this.getDistanceToFitBox(T.x,T.y,T.z,i);c.push(this.moveTo(U.x,U.y,U.z,e)),c.push(this.dollyTo(t,e)),c.push(this.setFocalOffset(0,0,0,e))}else if(M(this._camera)){let t=this._camera,s=t.right-t.left,r=t.top-t.bottom,o=i?Math.max(s/T.x,r/T.y):Math.min(s/T.x,r/T.y);c.push(this.moveTo(U.x,U.y,U.z,e)),c.push(this.zoomTo(o,e)),c.push(this.setFocalOffset(0,0,0,e))}return Promise.all(c)}fitToSphere(t,e){let i=[],s="isObject3D"in t?J.createBoundingSphere(t,T):T.copy(t);if(i.push(this.moveTo(s.center.x,s.center.y,s.center.z,e)),z(this._camera)){let t=this.getDistanceToFitSphere(s.radius);i.push(this.dollyTo(t,e))}else if(M(this._camera)){let t=this._camera.right-this._camera.left,r=this._camera.top-this._camera.bottom,o=2*s.radius,n=Math.min(t/o,r/o);i.push(this.zoomTo(n,e))}return i.push(this.setFocalOffset(0,0,0,e)),Promise.all(i)}setLookAt(t,e,i,s,r,o,n=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=w.NONE,this._changedDolly=0;let a=l.set(s,r,o),_=h.set(t,e,i);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(_.sub(a).applyQuaternion(this._yAxisUpSpace)),this._needsUpdate=!0,n||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let c=!n||Y(this._target.x,this._targetEnd.x,this.restThreshold)&&Y(this._target.y,this._targetEnd.y,this.restThreshold)&&Y(this._target.z,this._targetEnd.z,this.restThreshold)&&Y(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Y(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Y(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerp(t,e,i,s=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=w.NONE,this._changedDolly=0;let r=h.set(...t.target);if("spherical"in t)f.set(...t.spherical);else{let e=l.set(...t.position);f.setFromVector3(e.sub(r).applyQuaternion(this._yAxisUpSpace))}let o=_.set(...e.target);if("spherical"in e)E.set(...e.spherical);else{let t=l.set(...e.position);E.setFromVector3(t.sub(o).applyQuaternion(this._yAxisUpSpace))}this._targetEnd.copy(r.lerp(o,i));let n=E.theta-f.theta,a=E.phi-f.phi,c=E.radius-f.radius;this._sphericalEnd.set(f.radius+c*i,f.phi+a*i,f.theta+n*i),this._needsUpdate=!0,s||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let d=!s||Y(this._target.x,this._targetEnd.x,this.restThreshold)&&Y(this._target.y,this._targetEnd.y,this.restThreshold)&&Y(this._target.z,this._targetEnd.z,this.restThreshold)&&Y(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Y(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Y(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(d)}lerpLookAt(t,e,i,s,r,o,n,a,h,l,_,c,d,m=!1){return this.lerp({position:[t,e,i],target:[s,r,o]},{position:[n,a,h],target:[l,_,c]},d,m)}setPosition(t,e,i,s=!1){return this.setLookAt(t,e,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,s)}setTarget(t,e,i,s=!1){let r=this.getPosition(h),o=this.setLookAt(r.x,r.y,r.z,t,e,i,s);return this._sphericalEnd.phi=k(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(t,e,i,s=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(t,e,i),this._needsUpdate=!0,s||this._focalOffset.copy(this._focalOffsetEnd);let r=!s||Y(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Y(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Y(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}setOrbitPoint(t,e,i){this._camera.updateMatrixWorld(),d.setFromMatrixColumn(this._camera.matrixWorldInverse,0),m.setFromMatrixColumn(this._camera.matrixWorldInverse,1),p.setFromMatrixColumn(this._camera.matrixWorldInverse,2);let s=h.set(t,e,i),r=s.distanceTo(this._camera.position),o=s.sub(this._camera.position);d.multiplyScalar(o.x),m.multiplyScalar(o.y),p.multiplyScalar(o.z),h.copy(d).add(m).add(p),h.z=h.z+r,this.dollyTo(r,!1),this.setFocalOffset(-h.x,h.y,-h.z,!1),this.moveTo(t,e,i,!1)}setBoundary(t){if(!t){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,i,r){if(null===t){this._viewport=null;return}this._viewport=this._viewport||new s.Vector4,"number"==typeof t?this._viewport.set(t,e,i,r):this._viewport.copy(t)}getDistanceToFitBox(t,e,i,s=!1){if(Q(this._camera,"getDistanceToFitBox"))return this._spherical.radius;let r=t/e,o=this._camera.getEffectiveFOV()*H,n=this._camera.aspect;return .5*((s?r>n:r<n)?e:t/n)/Math.tan(.5*o)+.5*i}getDistanceToFitSphere(t){if(Q(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;let e=this._camera.getEffectiveFOV()*H,i=2*Math.atan(Math.tan(.5*e)*this._camera.aspect);return t/Math.sin(.5*(1<this._camera.aspect?e:i))}getTarget(t,e=!0){return(t&&t.isVector3?t:new s.Vector3).copy(e?this._targetEnd:this._target)}getPosition(t,e=!0){return(t&&t.isVector3?t:new s.Vector3).setFromSpherical(e?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(e?this._targetEnd:this._target)}getSpherical(t,e=!0){return(t||new s.Spherical).copy(e?this._sphericalEnd:this._spherical)}getFocalOffset(t,e=!0){return(t&&t.isVector3?t:new s.Vector3).copy(e?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){return this._sphericalEnd.theta=(this._sphericalEnd.theta%F+F)%F,this._sphericalEnd.theta>Math.PI&&(this._sphericalEnd.theta-=F),this._spherical.theta+=F*Math.round((this._sphericalEnd.theta-this._spherical.theta)/F),this}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(t=!1){if(!Y(this._camera.up.x,this._cameraUp0.x)||!Y(this._camera.up.y,this._cameraUp0.y)||!Y(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);let t=this.getPosition(h);this.updateCameraUp(),this.setPosition(t.x,t.y,t.z)}return Promise.all([this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)])}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,o),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){let t=h.subVectors(this._target,this._camera.position).normalize(),e=l.crossVectors(t,this._camera.up);this._camera.up.crossVectors(e,t).normalize(),this._camera.updateMatrixWorld();let i=this.getPosition(h);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}update(t){let e=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,s=this._sphericalEnd.radius-this._spherical.radius,r=u.subVectors(this._targetEnd,this._target),o=O.subVectors(this._focalOffsetEnd,this._focalOffset),n=this._zoomEnd-this._zoom;if(V(e))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{let e=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=K(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,e,1/0,t),this._needsUpdate=!0}if(V(i))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{let e=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=K(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,e,1/0,t),this._needsUpdate=!0}if(V(s))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{let e=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=K(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,e,this.maxSpeed,t),this._needsUpdate=!0}if(V(r.x)&&V(r.y)&&V(r.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{let e=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;j(this._target,this._targetEnd,this._targetVelocity,e,this.maxSpeed,t,this._target),this._needsUpdate=!0}if(V(o.x)&&V(o.y)&&V(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{let e=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;j(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,e,this.maxSpeed,t,this._focalOffset),this._needsUpdate=!0}if(V(n))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{let e=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=K(this._zoom,this._zoomEnd,this._zoomVelocity,e,1/0,t)}if(this.dollyToCursor){if(z(this._camera)&&0!==this._changedDolly){let t=this._spherical.radius-this._lastDistance,e=this._camera,i=this._getCameraDirection(c),s=h.copy(i).cross(e.up).normalize();0===s.lengthSq()&&(s.x=1);let r=l.crossVectors(s,i),o=this._sphericalEnd.radius*Math.tan(e.getEffectiveFOV()*H*.5),n=(this._sphericalEnd.radius-t-this._sphericalEnd.radius)/this._sphericalEnd.radius,a=_.copy(this._targetEnd).add(s.multiplyScalar(this._dollyControlCoord.x*o*e.aspect)).add(r.multiplyScalar(this._dollyControlCoord.y*o)),d=h.copy(this._targetEnd).lerp(a,n),m=this._lastDollyDirection===w.IN&&this._spherical.radius<=this.minDistance,p=this._lastDollyDirection===w.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(m||p)){this._sphericalEnd.radius-=t,this._spherical.radius-=t;let e=l.copy(i).multiplyScalar(-t);d.add(e)}this._boundary.clampPoint(d,d);let u=l.subVectors(d,this._targetEnd);this._targetEnd.copy(d),this._target.add(u),this._changedDolly-=t,V(this._changedDolly)&&(this._changedDolly=0)}else if(M(this._camera)&&0!==this._changedZoom){let t=this._zoom-this._lastZoom,e=this._camera,i=h.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(e.near+e.far)/(e.near-e.far)).unproject(e),s=l.set(0,0,-1).applyQuaternion(e.quaternion),r=_.copy(i).add(s.multiplyScalar(-i.dot(e.up))),o=-(this._zoom-t-this._zoom)/this._zoom,n=this._getCameraDirection(c),a=this._targetEnd.dot(n),d=h.copy(this._targetEnd).lerp(r,o),m=d.dot(n),p=n.multiplyScalar(m-a);d.sub(p),this._boundary.clampPoint(d,d);let u=l.subVectors(d,this._targetEnd);this._targetEnd.copy(d),this._target.add(u),this._changedZoom-=t,V(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;let a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),V(this._focalOffset.x)&&V(this._focalOffset.y)&&V(this._focalOffset.z)||(d.setFromMatrixColumn(this._camera.matrix,0),m.setFromMatrixColumn(this._camera.matrix,1),p.setFromMatrixColumn(this._camera.matrix,2),d.multiplyScalar(this._focalOffset.x),m.multiplyScalar(-this._focalOffset.y),p.multiplyScalar(this._focalOffset.z),h.copy(d).add(m).add(p),this._camera.position.add(h),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),h.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);let f=this._needsUpdate;return f&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):f?(this.dispatchEvent({type:"update"}),V(e,this.restThreshold)&&V(i,this.restThreshold)&&V(s,this.restThreshold)&&V(r.x,this.restThreshold)&&V(r.y,this.restThreshold)&&V(r.z,this.restThreshold)&&V(o.x,this.restThreshold)&&V(o.y,this.restThreshold)&&V(o.z,this.restThreshold)&&V(n,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!f&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=f,this._needsUpdate=!1,f}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Z(this.maxDistance),minZoom:this.minZoom,maxZoom:Z(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Z(this.maxPolarAngle),minAzimuthAngle:Z(this.minAzimuthAngle),maxAzimuthAngle:Z(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:h.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){let i=JSON.parse(t);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=B(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=B(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=B(i.maxPolarAngle),this.minAzimuthAngle=B(i.minAzimuthAngle),this.maxAzimuthAngle=B(i.maxAzimuthAngle),this.smoothTime=i.smoothTime,this.draggingSmoothTime=i.draggingSmoothTime,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],e),f.setFromVector3(h.fromArray(i.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(f.theta,f.phi,e),this.dollyTo(f.radius,e),this.zoomTo(i.zoom,e),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],e),this._needsUpdate=!0}connect(t){if(this._domElement)return void console.warn("camera-controls is already connected.");t.setAttribute("data-camera-controls-version","3.1.0"),this._addAllEventListeners(t),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(t){return t.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(t){return this._getTargetDirection(t).negate()}_findPointerById(t){return this._activePointers.find(e=>e.pointerId===t)}_findPointerByMouseButton(t){return this._activePointers.find(e=>e.mouseButton===t)}_disposePointer(t){this._activePointers.splice(this._activePointers.indexOf(t),1)}_encloseToBoundary(t,e,i){let s=e.lengthSq();if(0===s)return t;let r=l.copy(e).add(t),o=this._boundary.clampPoint(r,_).sub(r),n=o.lengthSq();if(0===n)return t.add(e);{if(n===s)return t;if(0===i)return t.add(e).add(o);let r=1+i*n/e.dot(o);return t.add(l.copy(e).multiplyScalar(r)).add(o.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(z(this._camera)){let t=this._camera,e=t.near,i=Math.tan(.5*(t.getEffectiveFOV()*H))*e,s=i*t.aspect;this._nearPlaneCorners[0].set(-s,-i,0),this._nearPlaneCorners[1].set(s,-i,0),this._nearPlaneCorners[2].set(s,i,0),this._nearPlaneCorners[3].set(-s,i,0)}else if(M(this._camera)){let t=this._camera,e=1/t.zoom,i=t.left*e,s=t.right*e,r=t.top*e,o=t.bottom*e;this._nearPlaneCorners[0].set(i,r,0),this._nearPlaneCorners[1].set(s,r,0),this._nearPlaneCorners[2].set(s,o,0),this._nearPlaneCorners[3].set(i,o,0)}}_collisionTest(){let t=1/0;if(!(this.colliderMeshes.length>=1)||Q(this._camera,"_collisionTest"))return t;let e=this._getTargetDirection(c);U.lookAt(r,e,this._camera.up);for(let i=0;i<4;i++){let s=l.copy(this._nearPlaneCorners[i]);s.applyMatrix4(U);let r=_.addVectors(this._target,s);L.set(r,e),L.far=this._spherical.radius+1;let o=L.intersectObjects(this.colliderMeshes);0!==o.length&&o[0].distance<t&&(t=o[0].distance)}return t}_getClientRect(t){if(!this._domElement)return;let e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{let e=()=>{this.removeEventListener("rest",e),t()};this.addEventListener("rest",e)}))}_addAllEventListeners(t){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(t){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(t){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(t,e=new s.Sphere){let i=e.center;y.makeEmpty(),t.traverseVisible(t=>{t.isMesh&&y.expandByObject(t)}),y.getCenter(i);let r=0;return t.traverseVisible(t=>{if(!t.isMesh||!t.geometry)return;let e=t.geometry.clone();e.applyMatrix4(t.matrixWorld);let s=e.attributes.position;for(let t=0,e=s.count;t<e;t++)h.fromBufferAttribute(s,t),r=Math.max(r,i.distanceToSquared(h))}),e.radius=Math.sqrt(r),e}}let $=(0,S.forwardRef)((t,e)=>{let{impl:i,camera:s,domElement:r,makeDefault:o,onControlStart:n,onControl:a,onControlEnd:h,onTransitionStart:l,onUpdate:_,onWake:c,onRest:d,onSleep:m,onStart:p,onEnd:u,onChange:O,regress:f,...E}=t,y=null!=i?i:J;(0,S.useMemo)(()=>{let t={Box3:x.Box3,MathUtils:{clamp:x.MathUtils.clamp},Matrix4:x.Matrix4,Quaternion:x.Quaternion,Raycaster:x.Raycaster,Sphere:x.Sphere,Spherical:x.Spherical,Vector2:x.Vector2,Vector3:x.Vector3,Vector4:x.Vector4};y.install({THREE:t}),(0,P.e)({CameraControlsImpl:y})},[y]);let g=(0,P.C)(t=>t.camera),T=(0,P.C)(t=>t.gl),C=(0,P.C)(t=>t.invalidate),v=(0,P.C)(t=>t.events),U=(0,P.C)(t=>t.setEvents),L=(0,P.C)(t=>t.set),D=(0,P.C)(t=>t.get),b=(0,P.C)(t=>t.performance),R=s||g,w=r||v.connected||T.domElement,z=(0,S.useMemo)(()=>new y(R),[y,R]);return(0,P.D)((t,e)=>{z.update(e)},-1),(0,S.useEffect)(()=>(z.connect(w),()=>void z.disconnect()),[w,z]),(0,S.useEffect)(()=>{function t(){C(),f&&b.regress()}let e=e=>{t(),null==n||n(e),null==p||p(e)},i=e=>{t(),null==a||a(e),null==O||O(e)},s=t=>{null==h||h(t),null==u||u(t)},r=e=>{t(),null==l||l(e),null==O||O(e)},o=e=>{t(),null==_||_(e),null==O||O(e)},E=e=>{t(),null==c||c(e),null==O||O(e)},y=t=>{null==d||d(t)},g=t=>{null==m||m(t)};return z.addEventListener("controlstart",e),z.addEventListener("control",i),z.addEventListener("controlend",s),z.addEventListener("transitionstart",r),z.addEventListener("update",o),z.addEventListener("wake",E),z.addEventListener("rest",y),z.addEventListener("sleep",g),()=>{z.removeEventListener("controlstart",e),z.removeEventListener("control",i),z.removeEventListener("controlend",s),z.removeEventListener("transitionstart",r),z.removeEventListener("update",o),z.removeEventListener("wake",E),z.removeEventListener("rest",y),z.removeEventListener("sleep",g)}},[z,C,U,f,b,n,a,h,l,_,c,d,m,O,p,u]),(0,S.useEffect)(()=>{if(o){let t=D().controls;return L({controls:z}),()=>L({controls:t})}},[o,z]),S.createElement("primitive",(0,A.A)({ref:e,object:z},E))})},86089:(t,e,i)=>{"use strict";Object.defineProperty(e,"Ay",{enumerable:!0,get:function(){return s.default}});var s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};s.get||s.set?Object.defineProperty(e,i,s):e[i]=t[i]}}return e.default=t,e}(i(56486))},95062:(t,e,i)=>{t.exports=i(79706)()}}]);
//# sourceMappingURL=5506-2cec60a52da808ea.js.map