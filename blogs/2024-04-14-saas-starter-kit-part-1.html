<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="initial-scale=1.0, width=device-width" data-next-head=""/><title data-next-head="">Enterprise SAAS boilerplate 리뷰</title><link rel="preload" href="/_next/static/css/d20c50ed748cd26f.css" as="style"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/vs2015.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous"/><link rel="stylesheet" href="/_next/static/css/d20c50ed748cd26f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-0b9df2340104f8e1.js" defer=""></script><script src="/_next/static/chunks/framework-80cff53c93df8ff7.js" defer=""></script><script src="/_next/static/chunks/main-beade485850481f6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-5b36dff9503cb490.js" defer=""></script><script src="/_next/static/chunks/5695-9c01eff236121af5.js" defer=""></script><script src="/_next/static/chunks/pages/blogs/2024-04-14-saas-starter-kit-part-1-e544cef912e34a7f.js" defer=""></script><script src="/_next/static/qfjDRDkI7hbaUN0YCN0K0/_buildManifest.js" defer=""></script><script src="/_next/static/qfjDRDkI7hbaUN0YCN0K0/_ssgManifest.js" defer=""></script><style id="__jsx-4134105190">.markdown html{font:118.75%/1.58 'Roboto',serif;box-sizing:border-box;overflow-y:scroll;}.markdown *{box-sizing:inherit;}.markdown *:before{box-sizing:inherit;}.markdown *:after{box-sizing:inherit;}.markdown body{color:hsla(0,0%,0%,0.73);font-family:'Roboto',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}.markdown img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}.markdown h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}.markdown h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}.markdown h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}.markdown h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}.markdown h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}.markdown hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown ul{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}.markdown ol{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}.markdown dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:0.85rem;line-height:1.58rem;}.markdown table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:1rem;line-height:1.58rem;border-collapse:collapse;width:100%;}.markdown fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:0.94737rem;line-height:1.58rem;border-left:0.5925rem solid #017698;color:hsla(0,0%,0%,0.65);background-color:hsla(0,0%,0%,0.1);padding:0.29625rem 0.9875rem;font-style:italic;}.markdown form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.58rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}.markdown address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown b{font-weight:700;}.markdown strong{font-weight:700;}.markdown dt{font-weight:700;}.markdown th{font-weight:700;}.markdown li{margin-bottom:calc(1.58rem / 2);}.markdown ol li{padding-left:0;}.markdown ul li{padding-left:0;}.markdown li > ol{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}.markdown li > ul{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}.markdown blockquote *:last-child{margin-bottom:0;}.markdown li *:last-child{margin-bottom:0;}.markdown p *:last-child{margin-bottom:0;}.markdown li > p{margin-bottom:calc(1.58rem / 2);}.markdown code{font-size:0.85rem;line-height:1.58rem;}.markdown kbd{font-size:0.85rem;line-height:1.58rem;}.markdown samp{font-size:0.85rem;line-height:1.58rem;}.markdown abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}.markdown acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}.markdown abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}.markdown thead{text-align:left;}.markdown td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.05333rem;padding-right:1.05333rem;padding-top:0.79rem;padding-bottom:calc(0.79rem - 1px);}.markdown th:first-child,td:first-child{padding-left:0;}.markdown th:last-child,td:last-child{padding-right:0;}.markdown a{color:#017698;text-decoration:none;background-image:linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 1px, #017698 1px, #017698 2px, rgba(0, 0, 0, 0) 2px);}.markdown a:hover,a:active{text-shadow:none;background-image:none;}.markdown h1,h2,h3,h4,h5,h6{margin-top:3.16rem;}.markdown li>ol,li>ul{margin-left:20px;margin-bottom:0;}.markdown blockquote > :last-child{margin-bottom:0;}.markdown blockquote cite{font-size:1rem;line-height:1.58rem;color:hsla(0,0%,0%,0.73);font-style:normal;font-weight:400;}.markdown blockquote cite:before{content:"— ";}.markdown @media only screen and (max-width:480px){html{font-size:106.25%;line-height:28px;}blockquote{border-left:0.29625rem solid #017698;color:hsla(0,0%,0%,0.59);padding-left:0.88875rem;font-style:italic;margin-left:-1.185rem;margin-right:0;}} .markdown{color:#3d3d3d}.markdown ul li{list-style-type:disc}.markdown ol{list-style-type:decimal}:not(pre) code{background-color:rgb(203 208 218);border-radius:3px;font-family:D2Coding,Consolas,"Roboto Mono","Liberation Mono",Menlo,Courier,monospace;padding:.2rem .3rem;margin:0 .2rem}.markdown * code{font-size:inherit}.markdown code[class*="language-"]{font-family:D2Coding,Consolas,"Roboto Mono","Liberation Mono",Menlo,Courier,monospace;padding:1rem;background-color:#2d2d2d}</style></head><body><div id="__next"><div class="leading-normal tracking-normal bg-gray-100 min-h-screen"><nav class="w-full"><div id="progress" class="top-0 z-20 h-1" style="background:linear-gradient(to right, #4dc0b5 var(--scroll), transparent 0)"></div><div class="flex flex-wrap items-center justify-between w-full py-3 mx-auto mt-0 md:max-w-4xl"><div class="pl-4"><a class="text-xl font-extrabold text-gray-900 no-underline hover:no-underline" href="/">lifetime trails</a></div><div class="block pr-4 lg:hidden"><button id="nav-toggle" type="button" class="flex items-center px-3 py-2 text-gray-500 appearance-none hover:text-gray-900 hover:border-teal-500 focus:outline-none"><svg class="w-3 h-3 fill-current" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path></svg></button></div><div id="nav-content" class="bg-gray-100 border-b flex-grow lg:border-none lg:flex lg:items-center lg:mt-0 lg:shadow-none lg:w-auto md:bg-transparent mt-2 shadow w-full z-20 hidden"><ul class="items-center justify-end flex-1 list-reset lg:flex"><li class="mr-3"><a class="inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4" href="/">Home</a></li></ul></div></div></nav><div class="container w-full px-4 pb-10 mx-auto md:max-w-3xl"><h1 class="font-bold text-gray-800 mb-4 text-5xl mt-8 mb-8">Enterprise SAAS boilerplate 리뷰</h1><div class="details"><p class="text-gray-500">BoxyHQ에서 제공하는 saas-starter-kit을 삺펴 봅니다.</p><p class="text-gray-400 text-right -mt-1"><span class="mr-4">2024-04-14</span></p></div><article class="markdown"><h1>시작하며</h1>
<p>2024년의 1/4이 지났습니다.
그간 Front end 개발 환경에서 많은 발전과 다양한 시도들이 있었습니다.
하지만 실무를 하면서 따끈한 기술을 적용하기란 쉽지 않습니다.
기술의 이해와 적용에 걸리는 시간도 문제이겠지만 혼자만의 프로젝트가 아니다 보니 구성원들의 동의와 협력도 필요하기 때문입니다.</p>
<p>트렌디하고 새로운 기술만 추종하는 것도 항상 바람직하다고 볼 수는 없습니다.
단순한 일을 너무 복잡하게 풀어내거나 복잡한일은 너무 일반화하면 local minima한 솔루션인 경우가 대부분입니다.
프로젝트의 생명주기가 길고 그 요구사항이 다채로워질 수록 유연하고 재사용성이 높은 구조가 중요하기 때문에 local minima한 솔루션의 선택은 발목을 잡는 선택이 될 수 있습니다.</p>
<p>그럼에도 불구하고, 명확하고 직관적이며 단순하고 명쾌한 솔루션을 발견하는 경우가 종종 있습니다.
이런 기술을 알아채려면 많은 경험도 필요하지만 자신의 업무에대해 많은 질문과 도전을하는 태도가 중요합니다.
스스로 질문하는 태도로 인해 당장은 솔루션을 스스로 이끌어 낼 수 없다하더라도 새로운 기술이나 방법론이 나왔을 때 이것이 자신에게 필요한 것인지 쉽게 알아챌 수 있기 때문입니다.</p>
<h1><a href="https://github.com/boxyhq/saas-starter-kit">boxyhq/saas-starter-kit</a> 기술 스텍</h1>
<p>서두가 길었습니다.</p>
<p>2024년 2분기를 시작하는 시점에 업계에 떠도는 여러 유명한 boilerplate 프로젝트 중 하나를 선정해 살펴보고자 합니다.</p>
<p>monorepo가 대세인 요즘 single repo여서 오히려 반가웠습니다.
상대적으로 분석하기가 수월하거든요. 😂😂😂</p>
<p>기술 스텍은 다음과 같습니다.</p>
<ul>
<li>next.js 14</li>
<li>next-auth</li>
<li>@retracedhq</li>
<li>@tailwindcss</li>
<li>prisma/postgres</li>
<li>playwright</li>
<li>saml/boxyhq</li>
</ul>
<p>대부분의 기술은 이전 포스팅에서 다루었는데요.
<code>saml/boxyhq</code>는 인증관련 SAAS 솔루션 입니다.
이는 해당 오픈소스가 boxyhq라는 회사에서 자신들의 서비스를 어떻게 통합하는지 홍보하기 위한 수단으로 만들어졌기 때문입니다.</p>
<h1>초기화면</h1>
<p>프로젝트 <code>README.md</code>에 나온 순서대로 패키지를 설치하고 <code>.env</code> 파일을 만들고 postgres를 로컬에 띄운뒤 <code>prisma</code> 스키마 설정을 해 줍니다.</p>
<pre><code class="language-bash">npx prisma db push
</code></pre>
<p>ERD 구성은 다음과 같습니다.
<code>prisma.schema</code> 파일을 <a href="https://prisma-erd.simonknott.de/">Prisma ERD</a> 페이지에 붙여넣기 하면 손쉽게 ERD 다이어그램을 확보할 수 있습니다.</p>
<p><img alt="prisma-erd" loading="lazy" width="1929" height="650" decoding="async" data-nimg="1" class="shadow" style="color:transparent;width:100%;height:auto" src="/_next/static/media/prisma-erd.98ef54c2.svg"/></p>
<p>ERD에서 파악할 수 있듯이 사용자 인증 팀관리 초대 기능을 구현했음을 알 수 있습니다.</p>
<p><a href="https://www.prisma.io/docs/orm/prisma-migrate/workflows/seeding#how-to-seed-your-database-in-prisma-orm">How to seed your database in Prisma ORM</a>에 따라 seed를 해 봅니다.</p>
<pre><code class="language-sh">$ npx prisma db seed
</code></pre>
<p>Seed 후에 다음과 같이 데이터를 확인할 수 있습니다.
Admin, user 하나씩의 계정을 제외하고는 faker를 사용하여 생성합니다.</p>
<p><img alt="after-seed-user" loading="lazy" width="1324" height="686" decoding="async" data-nimg="1" class="shadow" style="color:transparent;width:100%;height:auto" src="/_next/static/media/image-1.1892157c.png"/></p>
<p><img alt="after-seed-team" loading="lazy" width="1028" height="450" decoding="async" data-nimg="1" class="shadow" style="color:transparent;width:100%;height:auto" src="/_next/static/media/image-2.bff3682f.png"/></p>
<p>다음 명령으로 로컬에서 실행을 할 수 있습니다.</p>
<pre><code class="language-sh">$ npm run dev
</code></pre>
<p>이후 초기 페이지를 다음과 같이 확이할 수 있습니다.</p>
<p><img alt="initial-page" loading="lazy" width="1640" height="1038" decoding="async" data-nimg="1" class="shadow" style="color:transparent;width:100%;height:auto" src="/_next/static/media/image.ea5bd80b.png"/></p>
<p><code>_app.tsx</code> 파일을 정의하여 page 컴포넌트에 <code>getLayout</code>이라는 정적 함수가 존재하는 경우, 이를 호출하여 layout 컴포넌트로 사용합니다.</p>
<h1>로그인 과정</h1>
<p>초기 seed를 통해 생성한 admin 정보를 활용해 로그인 해 봅니다.
로그인 과정은 다음과 같습니다.</p>
<p><img alt="login" loading="lazy" width="1172" height="610" decoding="async" data-nimg="1" class="shadow" style="color:transparent;width:100%;height:auto" src="/_next/static/media/login.79453588.svg"/></p>
<p><code>Sing in</code> 버튼을 클릭하면 <code>/auth/login</code> 페이지로 전환합니다.</p>
<p>Github 로그인을 할 수도 있고 그 밖에 다양한 IdP를 설정할 수 있습니다.
이는 <code>next-auth</code>에서 지원하는 provider 기능에 종속적 입니다.</p>
<p><code>Login</code> 컴포넌트는 <a href="https://formik.org/">Formik</a>을 사용하여 <code>&lt;form&gt;</code> 테그의 submit 이벤트를 처리합니다.
ID/password 기반의 로그인을 하면, submit 이벤트에따라 <code>next-auth/react</code> 패키지의 기능을 사용하여 <code>credentials</code> 방식의 로그인 챌린지를 합니다.</p>
<p>next.js 서버단의 <code>pages/api/auth</code> 라우트에 <code>next-auth</code>에서 제공하는 middleware를 셋업하여 <code>/api/auth/*</code>로 요청하는 api 호출을 처리합니다.</p>
<p><code>/api/auth/callback/credentials</code>의 POST 요청의 파라미터는 JSON 기반이 아닌 FormData를 사용하여 요청합니다.
이렇게 formik과 next-auth 조합으로 표준을 준수하는 form posting과 응답처리를 합니다.</p>
<p>ID/password 매칭이 성공적으로 이루어지면 먼저 <code>/dashboard</code> 라우트로 리다이렉트하여 <code>Dashboard</code> 컴포넌트를 렌더링 합니다.</p>
<p><code>Dashboard</code> 컴포넌트는 특별한 기능은 없고 <code>/api/teams</code> 응답에 따라 팀 정보가 있으면 이중 하나의 팀으로 라우트를 변경하거나 새로운 팀 생성을 할 수 있도록 화면을 전환합니다.
이미 seed를 통해 사용자와 팀 설정이 되어 있음으로 첫번째 팀 화면으로 전환합니다.</p>
<p><code>/teams/[teams-slug]/settings</code> 라우트 변경에 따라 <code>Settings</code> 컴포넌트를 렌더링합니다.
<code>Settings</code> 컴포넌트는 팀 상세정보와 함께 로그인한 사용자의 Role에 따른 permission 정보를 가져옵니다.
Role과 permission 정보는 소스코드에 하드코딩 하였습니다.
이렇게 가져온 permission 정보에 따라 team 화면에서 동작 가능한 기능을 판별하는 데 사용합니다.</p>
<h1>마치며</h1>
<p>간단하게 <code>saas-starter-kit</code>의 기술 스텍, 구조, 로그인 과정을 살펴 보았습니다.</p>
<p>SAAS를 제공하려면 소개 페이지에서 부터 사용자 콘솔에 필요한 사용자/팀 관리에 대한 기능이 필수 적으로 필요합니다.
이러한 부분을 비교적 대중적인 FE stack으로 구성하였습니다.
어떠한 프로젝트라도 이러한 기능을 필요하기에 좋은 레퍼런스로 삼을 수 있을 것 같습니다.</p>
<p><code>saas-starter-kit</code>의 소개 비디오에서 놓치면 안되는 것은 SAML 인증 기능입니다.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/oF8QIwQIhyo?si=StvHFSpnjbmzG_l5&amp;start=420" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe>
<p>SAML 인증을 지원하기 때문에 Github, Google 등과 같은 IdP 뿐만이 아니고 회사내에서 운영하는 다양한 형식의 인증 및 디렉터리 서비스를 SAML 표준을 사용하여 연동할 수 있습니다.</p>
<p>사실 BoxyHQ는 <code>Security Building Blocks for Developers</code>이라는 슬로건으로 사내에서 구현하는 다양한 서비스들의 인증, 접근제어, 감사 기능을 제공하는 솔루션을 만드는 회사 입니다.</p>
<p>따라서 BoxyHQ에서 만든 <code>saas-starter-kit</code> boilerplate는 일반 고객을 대상으로한 SAAS의 인증 뿐 아니라 사내에서 구축한 인증시스템 또는 BoxyHQ의 솔루션을 사용한 SAAS 인증과 연동할 수 있는 레퍼런스를 만들게 된 것 같습니다.</p>
<p>next.js, next-auth, prisma 등을 사용하여 간단한 서비스를 구축하고자 하는 분들에게 사용자 관리에 대한 boilerplate로서 좋은 레퍼런스가 되리라 생각합니다.</p></article><div class="react-utterences"><div>Loading script...</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blogs/2024-04-14-saas-starter-kit-part-1","query":{},"buildId":"qfjDRDkI7hbaUN0YCN0K0","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>