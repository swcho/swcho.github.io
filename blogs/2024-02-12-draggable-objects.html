<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="initial-scale=1.0, width=device-width" data-next-head=""/><title data-next-head="">Draggable object 리뷰</title><link rel="preload" href="/_next/static/css/d20c50ed748cd26f.css" as="style"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/vs2015.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC" crossorigin="anonymous"/><link rel="stylesheet" href="/_next/static/css/d20c50ed748cd26f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-b9bde0f71dfd7f80.js" defer=""></script><script src="/_next/static/chunks/framework-e837885f9f00810f.js" defer=""></script><script src="/_next/static/chunks/main-beade485850481f6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-57b73c2138884752.js" defer=""></script><script src="/_next/static/chunks/5695-9c01eff236121af5.js" defer=""></script><script src="/_next/static/chunks/3149-75c7f4b55a123710.js" defer=""></script><script src="/_next/static/chunks/pages/blogs/2024-02-12-draggable-objects-0691b25a85b14081.js" defer=""></script><script src="/_next/static/4VfyYs9vc-5CtkULTTuNp/_buildManifest.js" defer=""></script><script src="/_next/static/4VfyYs9vc-5CtkULTTuNp/_ssgManifest.js" defer=""></script><style id="__jsx-4134105190">.markdown html{font:118.75%/1.58 'Roboto',serif;box-sizing:border-box;overflow-y:scroll;}.markdown *{box-sizing:inherit;}.markdown *:before{box-sizing:inherit;}.markdown *:after{box-sizing:inherit;}.markdown body{color:hsla(0,0%,0%,0.73);font-family:'Roboto',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}.markdown img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}.markdown h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}.markdown h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}.markdown h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}.markdown h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}.markdown h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;color:hsla(0,0%,0%,0.9);font-family:'Roboto Slab',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}.markdown hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown ul{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}.markdown ol{margin-left:1.58rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;list-style-position:outside;list-style-image:none;}.markdown dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:0.85rem;line-height:1.58rem;}.markdown table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:1rem;line-height:1.58rem;border-collapse:collapse;width:100%;}.markdown fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;font-size:0.94737rem;line-height:1.58rem;border-left:0.5925rem solid #017698;color:hsla(0,0%,0%,0.65);background-color:hsla(0,0%,0%,0.1);padding:0.29625rem 0.9875rem;font-style:italic;}.markdown form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.58rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}.markdown address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.58rem;}.markdown b{font-weight:700;}.markdown strong{font-weight:700;}.markdown dt{font-weight:700;}.markdown th{font-weight:700;}.markdown li{margin-bottom:calc(1.58rem / 2);}.markdown ol li{padding-left:0;}.markdown ul li{padding-left:0;}.markdown li > ol{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}.markdown li > ul{margin-left:1.58rem;margin-bottom:calc(1.58rem / 2);margin-top:calc(1.58rem / 2);}.markdown blockquote *:last-child{margin-bottom:0;}.markdown li *:last-child{margin-bottom:0;}.markdown p *:last-child{margin-bottom:0;}.markdown li > p{margin-bottom:calc(1.58rem / 2);}.markdown code{font-size:0.85rem;line-height:1.58rem;}.markdown kbd{font-size:0.85rem;line-height:1.58rem;}.markdown samp{font-size:0.85rem;line-height:1.58rem;}.markdown abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}.markdown acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}.markdown abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}.markdown thead{text-align:left;}.markdown td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.05333rem;padding-right:1.05333rem;padding-top:0.79rem;padding-bottom:calc(0.79rem - 1px);}.markdown th:first-child,td:first-child{padding-left:0;}.markdown th:last-child,td:last-child{padding-right:0;}.markdown a{color:#017698;text-decoration:none;background-image:linear-gradient(to top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 1px, #017698 1px, #017698 2px, rgba(0, 0, 0, 0) 2px);}.markdown a:hover,a:active{text-shadow:none;background-image:none;}.markdown h1,h2,h3,h4,h5,h6{margin-top:3.16rem;}.markdown li>ol,li>ul{margin-left:20px;margin-bottom:0;}.markdown blockquote > :last-child{margin-bottom:0;}.markdown blockquote cite{font-size:1rem;line-height:1.58rem;color:hsla(0,0%,0%,0.73);font-style:normal;font-weight:400;}.markdown blockquote cite:before{content:"— ";}.markdown @media only screen and (max-width:480px){html{font-size:106.25%;line-height:28px;}blockquote{border-left:0.29625rem solid #017698;color:hsla(0,0%,0%,0.59);padding-left:0.88875rem;font-style:italic;margin-left:-1.185rem;margin-right:0;}} .markdown{color:#3d3d3d}.markdown ul li{list-style-type:disc}.markdown ol{list-style-type:decimal}:not(pre) code{background-color:rgb(203 208 218);border-radius:3px;font-family:D2Coding,Consolas,"Roboto Mono","Liberation Mono",Menlo,Courier,monospace;padding:.2rem .3rem;margin:0 .2rem}.markdown * code{font-size:inherit}.markdown code[class*="language-"]{font-family:D2Coding,Consolas,"Roboto Mono","Liberation Mono",Menlo,Courier,monospace;padding:1rem;background-color:#2d2d2d}</style></head><body><div id="__next"><div class="leading-normal tracking-normal bg-gray-100 min-h-screen"><nav class="w-full"><div id="progress" class="top-0 z-20 h-1" style="background:linear-gradient(to right, #4dc0b5 var(--scroll), transparent 0)"></div><div class="flex flex-wrap items-center justify-between w-full py-3 mx-auto mt-0 md:max-w-4xl"><div class="pl-4"><a href="/">lifetime trails</a></div><div class="block pr-4 lg:hidden"><button id="nav-toggle" type="button" class="flex items-center px-3 py-2 text-gray-500 appearance-none hover:text-gray-900 hover:border-teal-500 focus:outline-none"><svg class="w-3 h-3 fill-current" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path></svg></button></div><div id="nav-content" class="bg-gray-100 border-b flex-grow lg:border-none lg:flex lg:items-center lg:mt-0 lg:shadow-none lg:w-auto md:bg-transparent mt-2 shadow w-full z-20 hidden"><ul class="items-center justify-end flex-1 list-reset lg:flex"><li class="mr-3"><a href="/">Home</a></li></ul></div></div></nav><div class="container w-full px-4 pb-10 mx-auto md:max-w-3xl"><h1 class="font-bold text-gray-800 mb-4 text-5xl mt-8 mb-8">Draggable object 리뷰</h1><div class="details"><p class="text-gray-500">drag 처리에 대해 많은 고민이 묻어있는 포스팅을 발견하여 리뷰해 봅니다.</p><p class="text-gray-400 text-right -mt-1"><span class="mr-4">2024-02-12</span></p></div><article class="markdown"><h1>소개</h1>
<p>Interactive한 UX를 구현하다보면 drag 처리가 필요한 경우가 있습니다.
Mouse와 Pointer의 up/down/move 이벤트를 받아 처리하면 어느 정도 원하는 구현이 나옵니다.
하지만 어딘지 모르게 어색한 혹은 예기치 못한 오동작이 발생하기도 하는데요.
마침 drag 처리에 대해 많은 고민이 묻어있는 포스팅을 발견하여 리뷰해 봅니다.</p>
<blockquote>
<p><a href="https://www.redblobgames.com/making-of/draggable">Draggable objects</a></p>
</blockquote>
<h1>Mouse 이벤트 사용하기</h1>
<blockquote>
<p><a href="https://www.redblobgames.com/making-of/draggable/#mouse-events">🖱️ Mouse events only</a></p>
</blockquote>
<p><img alt="MouseOnlyXState" loading="lazy" width="3280" height="1568" decoding="async" data-nimg="1" class="shadow" style="color:transparent;width:100%;height:auto" src="/_next/static/media/MouseOnlyXState.98fc3809.png"/></p>
<div class="container rounded border border-current relative" style="height:300px"><div class="absolute" style="left:50%;transform:translateX(-50%)"><div class="backdrop-brightness-90 p-1 rounded-md">not_dragging</div></div><svg viewBox="0 0 300 100"><g class="cursor-grab" transform="translate(30, 30)"><circle cx="0" cy="0" stroke="black" r="30"></circle><g font-size="14" text-anchor="middle" fill="white"><text dy="0.0em">Drag</text><text dy="1.0em">me</text></g></g></svg></div>
<p>마우스 이벤트만으로 dragging을 구현할 때 다음의 문제가 있습니다.</p>
<ul>
<li>마우스를 빠르게 움직이면 이벤트 처리를 하지 못합니다.</li>
<li>포인터가 원 밖으로 나간 상태에서 마우스 up을 하면 <code>dragging</code> 상태에 머무르는 문제가 있습니다.</li>
</ul>
<p>이를 보완하기 위해 아래 예시와 같이, element가 아닌 <code>document</code> 엘리먼트에 <code>mousemove</code>, <code>mouseup</code> 이벤트를 등록하여 처리할 수 있습니다.</p>
<div class="container rounded border border-current relative" style="height:300px"><div class="absolute" style="left:50%;transform:translateX(-50%)"><div class="backdrop-brightness-90 p-1 rounded-md">not_dragging</div></div><svg viewBox="0 0 300 100"><g class="cursor-grab" transform="translate(30, 30)"><circle cx="0" cy="0" stroke="black" r="30"></circle><g font-size="14" text-anchor="middle" fill="white"><text dy="0.0em">Drag</text><text dy="1.0em">me</text></g></g></svg></div>
<h1>Touch 이벤트 사용하기</h1>
<blockquote>
<p><a href="https://www.redblobgames.com/making-of/draggable/#touch-events">👆 Touch events</a></p>
</blockquote>
<p><code>mousedown</code>, <code>mouseup</code>, <code>mousemove</code> 대신 <code>touchstart</code>, <code>touchend</code>, <code>touchmove</code> 이벤트를 사용합니다.
<code>touchmove</code>, <code>touchend</code> 는 <code>mousemove</code>, <code>mouseend</code> 와 다르게 영역 밖에서도 이벤트를 전달합니다.
따라서 <code>document</code>에 등록하지 않아도 동일한 동작을 확인할 수 있습니다.</p>
<p><img alt="ByTouchEvent" loading="lazy" width="3280" height="1568" decoding="async" data-nimg="1" class="shadow" style="color:transparent;width:100%;height:auto" src="/_next/static/media/ByTouchEvent.d4725e5e.png"/></p>
<div class="container rounded border border-current relative" style="height:300px"><div class="absolute" style="left:50%;transform:translateX(-50%)"><div class="backdrop-brightness-90 p-1 rounded-md">not_dragging</div></div><svg viewBox="0 0 300 100"><g class="cursor-grab" transform="translate(30, 30)"><circle cx="0" cy="0" stroke="black" r="30"></circle><g font-size="14" text-anchor="middle" fill="white"><text dy="0.0em">Drag</text><text dy="1.0em">me</text></g></g></svg></div>
<h1>Pointer 이벤트 사용하기</h1>
<blockquote>
<p><a href="https://www.redblobgames.com/making-of/draggable/#pointer-events">🖱️👆 Pointer events</a></p>
</blockquote>
<p>Pointer 이벤트는 mouse, touch 이벤트 모두를 처리합니다.</p>
<p>Pointer 이벤트의 <code>pointerId</code>를 엘리먼트의 <code>setPointerCapture</code> 함수로 넘겨주면 <code>document</code>에 이벤트를 등록하는 것과 동일한 기능을 사용할 수 있습니다.</p>
<p><img alt="ByPointerEvent" loading="lazy" width="3280" height="1568" decoding="async" data-nimg="1" class="shadow" style="color:transparent;width:100%;height:auto" src="/_next/static/media/ByPointerEvent.7f81f535.png"/></p>
<div class="container rounded border border-current relative mb-10"><div class="absolute" style="left:50%;transform:translateX(-50%)"><div class="backdrop-brightness-90 p-1 rounded-md">not_dragging</div></div><svg viewBox="0 0 300 100"><g class="cursor-grab" transform="translate(30, 30)"><circle cx="0" cy="0" stroke="black" r="30"></circle><g font-size="14" text-anchor="middle" fill="white"><text dy="0.0em">Drag</text><text dy="1.0em">me</text></g></g></svg></div>
<h2><a href="https://www.redblobgames.com/making-of/draggable/#fix-capture">Fix: capture the mouse</a></h2>
<p>다음과 같은 동작에도 drag 동작이 멈추지 않고 지속하여야 합니다.</p>
<ul>
<li>drag 상태에서 빠르게 흔들기</li>
<li>drag 영역 밖에서 다시 들어오기</li>
<li>drag 영역 밖에서 release 했을 때</li>
<li>drag 영역 밖에서 release 하고 다시 들어왔을 때</li>
<li>drag 중 alt+tab으로 윈도우 포커스 변경할 때</li>
</ul>
<p>이를 위해 drag element의 <code>setPointerCapture(event.pointerId)</code>를 호출하여 drag 영역 밖에서도 이벤트 전달이 가능하도록 합니다.</p>
<h2><a href="https://www.redblobgames.com/making-of/draggable/#fix-scroll">Fix: scrolling with touch</a></h2>
<p>모바일 환경에서는 한 손가락 drag로 스크롤을 합니다.
엘리먼트를 drag로 이동할 경우 스크롤과 drag 동작이 동시에 이루어 집니다.
이를 막기 위해 drag 영역에 <code>touch-action: none</code> 스타일을 적용합니다.
이 경우 모든 drag 영역에서 스크롤이 불가능 합니다.</p>
<p>drag를 적용하는 엘리먼트의 <code>touchstart</code> 이벤트를 <code>preventDefault()</code> 해 주면 엘리먼트만 drag 동작을 하면서 스크롤이 되지 않으며 동시에 drag 영역에서 스크롤이 가능해 집니다.</p>
<h2><a href="https://www.redblobgames.com/making-of/draggable/#feature-offset">Feature: handle drag offset</a></h2>
<p>이벤트 위치를 기준으로 엘리먼트를 잡을경우 drag 시작 시, drag element의 중심이 순간적으로 mouse pointer로 이동합니다.</p>
<p>이 동작을 보완하기 위해, drag element의 중심과 event 위치와의 차이를 저장하고 그 차이만큼 move 동작시에 보완해 줍니다.</p>
<h2><a href="https://www.redblobgames.com/making-of/draggable/#fix-contextmenu">Fix: context menu</a></h2>
<p>Context 메뉴는 운영체제마다 호출 방식이 다릅니다.
<code>pointerdown</code> 이벤트에 따른 <code>pointerup</code> 이벤트를 항상 전달해 주지 않습니다.</p>
<p>이를 보완하기 위해 left button에서만 동작하도록 수정합니다.</p>
<h1><a href="https://www.redblobgames.com/making-of/draggable/#variant-text">🖱️ Variant: draggable text/images</a></h1>
<p>drag element 안에 text, image 등이 있는 경우에 확인해야 할 사항입니다.</p>
<h2><a href="https://www.redblobgames.com/making-of/draggable/#fix-user-select">Fix: text selection</a></h2>
<p>drag element를 이동 시 때떄로 텍스트가 선택 됩니다.
<code>user-select: none</code>을 drag element에 설정하면 select all 동작에서 조차 선택을 할 수 없습니다.</p>
<p>이를 위해 dragging 중에만 <code>user-select: none</code> 설정을 합니다.</p>
<h2><a href="https://www.redblobgames.com/making-of/draggable/#fix-systemdrag">Fix: text and image drag</a></h2>
<p>drag 영역 밖에서 부터 drag element 내의 text 까지 text selection을 한 뒤, text 선택 영역에서 drag를 하면 텍스트 전체를 copy &amp; paste 할 수 있습니다.</p>
<p>drag element 내의 text selection 영역에서 drag 동작을 우선시하려면, 해당 엘리먼트의 <code>dragstart</code> 이벤트를 <code>preventDefault()</code>해 줍니다.</p>
<p>다음은 위에서 설명한 권장사항을 적용한 예시입니다.</p>
<div class="container rounded border border-current relative mb-10"><div class="absolute" style="left:50%;transform:translateX(-50%)"><div class="backdrop-brightness-90 p-1 rounded-md">not_dragging</div></div><svg viewBox="0 0 300 100"><g class="cursor-grab" transform="translate(30, 30)"><circle cx="0" cy="0" stroke="black" r="30"></circle><g font-size="14" text-anchor="middle" fill="white"><text dy="0.0em">Drag</text><text dy="1.0em">me</text></g></g></svg></div>
<h1>마치며</h1>
<p>저자는 오랬동안 자신이 경험해 온 내용을 위 블로그에 정리 했습니다.
간단한 drag 기능 구현을 위해 고민할 경우 마우스 이벤트 처리에 머물러 있기마련 입니다.
반면 touch, pointer, drag 이벤트 등을 다루고 이들의 edge 케이스를 살펴 보면서 수년에 걸친 경험과 인사이트를 얻을 수 있었습니다.</p>
<p>블로그 원본에서는 더욱 다양하고 흥미로운 tip과 trick을 제공하니 관심있으신 분들은 본문의 설명과 함께 예시링크도 함께 확인해 보시면 좋겠습니다.</p></article><div class="react-utterences"><div>Loading script...</div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/blogs/2024-02-12-draggable-objects","query":{},"buildId":"4VfyYs9vc-5CtkULTTuNp","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>