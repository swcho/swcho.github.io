"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1252],{49082:(t,e,i)=>{i.d(e,{N:()=>r});var n=i(44501),s=i(88360),o=i(14232),a=i(78961);let r=o.forwardRef(({makeDefault:t,camera:e,regress:i,domElement:r,enableDamping:h=!0,keyEvents:l=!1,onChange:c,onStart:p,onEnd:d,...u},m)=>{let w=(0,s.C)(t=>t.invalidate),y=(0,s.C)(t=>t.camera),g=(0,s.C)(t=>t.gl),v=(0,s.C)(t=>t.events),b=(0,s.C)(t=>t.setEvents),P=(0,s.C)(t=>t.set),f=(0,s.C)(t=>t.get),E=(0,s.C)(t=>t.performance),M=e||y,S=r||v.connected||g.domElement,x=o.useMemo(()=>new a.N(M),[M]);return(0,s.D)(()=>{x.enabled&&x.update()},-1),o.useEffect(()=>(l&&x.connect(!0===l?S:l),x.connect(S),()=>void x.dispose()),[l,S,i,x,w]),o.useEffect(()=>{let t=t=>{w(),i&&E.regress(),c&&c(t)},e=t=>{p&&p(t)},n=t=>{d&&d(t)};return x.addEventListener("change",t),x.addEventListener("start",e),x.addEventListener("end",n),()=>{x.removeEventListener("start",e),x.removeEventListener("end",n),x.removeEventListener("change",t)}},[c,p,d,x,w,b]),o.useEffect(()=>{if(t){let t=f().controls;return P({controls:x}),()=>P({controls:t})}},[t,x]),o.createElement("primitive",(0,n.A)({ref:m,object:x,enableDamping:h},u))})},99855:(t,e,i)=>{i.d(e,{Z:()=>d});var n=i(44501),s=i(88360),o=i(14232),a=i(66691),r=Object.defineProperty,h=(t,e,i)=>(((t,e,i)=>e in t?r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i)(t,"symbol"!=typeof e?e+"":e,i),i);class l extends a.B69{constructor(t,e){super(),h(this,"isTransformControls",!0),h(this,"visible",!1),h(this,"domElement"),h(this,"raycaster",new a.tBo),h(this,"gizmo"),h(this,"plane"),h(this,"tempVector",new a.Pq0),h(this,"tempVector2",new a.Pq0),h(this,"tempQuaternion",new a.PTz),h(this,"unit",{X:new a.Pq0(1,0,0),Y:new a.Pq0(0,1,0),Z:new a.Pq0(0,0,1)}),h(this,"pointStart",new a.Pq0),h(this,"pointEnd",new a.Pq0),h(this,"offset",new a.Pq0),h(this,"rotationAxis",new a.Pq0),h(this,"startNorm",new a.Pq0),h(this,"endNorm",new a.Pq0),h(this,"rotationAngle",0),h(this,"cameraPosition",new a.Pq0),h(this,"cameraQuaternion",new a.PTz),h(this,"cameraScale",new a.Pq0),h(this,"parentPosition",new a.Pq0),h(this,"parentQuaternion",new a.PTz),h(this,"parentQuaternionInv",new a.PTz),h(this,"parentScale",new a.Pq0),h(this,"worldPositionStart",new a.Pq0),h(this,"worldQuaternionStart",new a.PTz),h(this,"worldScaleStart",new a.Pq0),h(this,"worldPosition",new a.Pq0),h(this,"worldQuaternion",new a.PTz),h(this,"worldQuaternionInv",new a.PTz),h(this,"worldScale",new a.Pq0),h(this,"eye",new a.Pq0),h(this,"positionStart",new a.Pq0),h(this,"quaternionStart",new a.PTz),h(this,"scaleStart",new a.Pq0),h(this,"camera"),h(this,"object"),h(this,"enabled",!0),h(this,"axis",null),h(this,"mode","translate"),h(this,"translationSnap",null),h(this,"rotationSnap",null),h(this,"scaleSnap",null),h(this,"space","world"),h(this,"size",1),h(this,"dragging",!1),h(this,"showX",!0),h(this,"showY",!0),h(this,"showZ",!0),h(this,"changeEvent",{type:"change"}),h(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),h(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),h(this,"objectChangeEvent",{type:"objectChange"}),h(this,"intersectObjectWithRay",(t,e,i)=>{let n=e.intersectObject(t,!0);for(let t=0;t<n.length;t++)if(n[t].object.visible||i)return n[t];return!1}),h(this,"attach",t=>(this.object=t,this.visible=!0,this)),h(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),h(this,"reset",()=>(this.enabled&&this.dragging&&void 0!==this.object&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this)),h(this,"updateMatrixWorld",()=>{void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),h(this,"pointerHover",t=>{if(void 0===this.object||!0===this.dragging)return;this.raycaster.setFromCamera(t,this.camera);let e=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);e?this.axis=e.object.name:this.axis=null}),h(this,"pointerDown",t=>{if(void 0!==this.object&&!0!==this.dragging&&0===t.button&&null!==this.axis){this.raycaster.setFromCamera(t,this.camera);let e=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(e){let t=this.space;if("scale"===this.mode?t="local":("E"===this.axis||"XYZE"===this.axis||"XYZ"===this.axis)&&(t="world"),"local"===t&&"rotate"===this.mode){let t=this.rotationSnap;"X"===this.axis&&t&&(this.object.rotation.x=Math.round(this.object.rotation.x/t)*t),"Y"===this.axis&&t&&(this.object.rotation.y=Math.round(this.object.rotation.y/t)*t),"Z"===this.axis&&t&&(this.object.rotation.z=Math.round(this.object.rotation.z/t)*t)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(e.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),h(this,"pointerMove",t=>{let e=this.axis,i=this.mode,n=this.object,s=this.space;if("scale"===i?s="local":("E"===e||"XYZE"===e||"XYZ"===e)&&(s="world"),void 0===n||null===e||!1===this.dragging||-1!==t.button)return;this.raycaster.setFromCamera(t,this.camera);let o=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===i)this.offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==e&&this.offset.applyQuaternion(this.worldQuaternionInv),-1===e.indexOf("X")&&(this.offset.x=0),-1===e.indexOf("Y")&&(this.offset.y=0),-1===e.indexOf("Z")&&(this.offset.z=0),"local"===s&&"XYZ"!==e?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),n.position.copy(this.offset).add(this.positionStart),this.translationSnap&&("local"===s&&(n.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),-1!==e.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==e.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==e.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.position.applyQuaternion(this.quaternionStart)),"world"===s&&(n.parent&&n.position.add(this.tempVector.setFromMatrixPosition(n.parent.matrixWorld)),-1!==e.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==e.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==e.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.parent&&n.position.sub(this.tempVector.setFromMatrixPosition(n.parent.matrixWorld))));else if("scale"===i){if(-1!==e.search("XYZ")){let t=this.pointEnd.length()/this.pointStart.length();0>this.pointEnd.dot(this.pointStart)&&(t*=-1),this.tempVector2.set(t,t,t)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),-1===e.search("X")&&(this.tempVector2.x=1),-1===e.search("Y")&&(this.tempVector2.y=1),-1===e.search("Z")&&(this.tempVector2.z=1);n.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(-1!==e.search("X")&&(this.object.scale.x=Math.round(n.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==e.search("Y")&&(n.scale.y=Math.round(n.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==e.search("Z")&&(n.scale.z=Math.round(n.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this.offset.copy(this.pointEnd).sub(this.pointStart);let t=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));"E"===e?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=0>this.endNorm.cross(this.startNorm).dot(this.eye)?1:-1):"XYZE"===e?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*t):("X"===e||"Y"===e||"Z"===e)&&(this.rotationAxis.copy(this.unit[e]),this.tempVector.copy(this.unit[e]),"local"===s&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*t),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==e&&"XYZE"!==e?(n.quaternion.copy(this.quaternionStart),n.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),n.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),n.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),h(this,"pointerUp",t=>{0===t.button&&(this.dragging&&null!==this.axis&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),h(this,"getPointer",t=>{var e;if(this.domElement&&(null==(e=this.domElement.ownerDocument)?void 0:e.pointerLockElement))return{x:0,y:0,button:t.button};{let e=t.changedTouches?t.changedTouches[0]:t,i=this.domElement.getBoundingClientRect();return{x:(e.clientX-i.left)/i.width*2-1,y:-(e.clientY-i.top)/i.height*2+1,button:t.button}}}),h(this,"onPointerHover",t=>{if(this.enabled)switch(t.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(t))}}),h(this,"onPointerDown",t=>{this.enabled&&this.domElement&&(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(t)),this.pointerDown(this.getPointer(t)))}),h(this,"onPointerMove",t=>{this.enabled&&this.pointerMove(this.getPointer(t))}),h(this,"onPointerUp",t=>{this.enabled&&this.domElement&&(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(t)))}),h(this,"getMode",()=>this.mode),h(this,"setMode",t=>{this.mode=t}),h(this,"setTranslationSnap",t=>{this.translationSnap=t}),h(this,"setRotationSnap",t=>{this.rotationSnap=t}),h(this,"setScaleSnap",t=>{this.scaleSnap=t}),h(this,"setSize",t=>{this.size=t}),h(this,"setSpace",t=>{this.space=t}),h(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),h(this,"connect",t=>{t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=t,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),h(this,"dispose",()=>{var t,e,i,n,s,o;null==(t=this.domElement)||t.removeEventListener("pointerdown",this.onPointerDown),null==(e=this.domElement)||e.removeEventListener("pointermove",this.onPointerHover),null==(n=null==(i=this.domElement)?void 0:i.ownerDocument)||n.removeEventListener("pointermove",this.onPointerMove),null==(o=null==(s=this.domElement)?void 0:s.ownerDocument)||o.removeEventListener("pointerup",this.onPointerUp),this.traverse(t=>{t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})}),this.domElement=e,this.camera=t,this.gizmo=new c,this.add(this.gizmo),this.plane=new p,this.add(this.plane);let i=(t,e)=>{let i=e;Object.defineProperty(this,t,{get:function(){return void 0!==i?i:e},set:function(e){i!==e&&(i=e,this.plane[t]=e,this.gizmo[t]=e,this.dispatchEvent({type:t+"-changed",value:e}),this.dispatchEvent(this.changeEvent))}}),this[t]=e,this.plane[t]=e,this.gizmo[t]=e};i("camera",this.camera),i("object",this.object),i("enabled",this.enabled),i("axis",this.axis),i("mode",this.mode),i("translationSnap",this.translationSnap),i("rotationSnap",this.rotationSnap),i("scaleSnap",this.scaleSnap),i("space",this.space),i("size",this.size),i("dragging",this.dragging),i("showX",this.showX),i("showY",this.showY),i("showZ",this.showZ),i("worldPosition",this.worldPosition),i("worldPositionStart",this.worldPositionStart),i("worldQuaternion",this.worldQuaternion),i("worldQuaternionStart",this.worldQuaternionStart),i("cameraPosition",this.cameraPosition),i("cameraQuaternion",this.cameraQuaternion),i("pointStart",this.pointStart),i("pointEnd",this.pointEnd),i("rotationAxis",this.rotationAxis),i("rotationAngle",this.rotationAngle),i("eye",this.eye),void 0!==e&&this.connect(e)}}class c extends a.B69{constructor(){super(),h(this,"isTransformControlsGizmo",!0),h(this,"type","TransformControlsGizmo"),h(this,"tempVector",new a.Pq0(0,0,0)),h(this,"tempEuler",new a.O9p),h(this,"alignVector",new a.Pq0(0,1,0)),h(this,"zeroVector",new a.Pq0(0,0,0)),h(this,"lookAtMatrix",new a.kn4),h(this,"tempQuaternion",new a.PTz),h(this,"tempQuaternion2",new a.PTz),h(this,"identityQuaternion",new a.PTz),h(this,"unitX",new a.Pq0(1,0,0)),h(this,"unitY",new a.Pq0(0,1,0)),h(this,"unitZ",new a.Pq0(0,0,1)),h(this,"gizmo"),h(this,"picker"),h(this,"helper"),h(this,"rotationAxis",new a.Pq0),h(this,"cameraPosition",new a.Pq0),h(this,"worldPositionStart",new a.Pq0),h(this,"worldQuaternionStart",new a.PTz),h(this,"worldPosition",new a.Pq0),h(this,"worldQuaternion",new a.PTz),h(this,"eye",new a.Pq0),h(this,"camera",null),h(this,"enabled",!0),h(this,"axis",null),h(this,"mode","translate"),h(this,"space","world"),h(this,"size",1),h(this,"dragging",!1),h(this,"showX",!0),h(this,"showY",!0),h(this,"showZ",!0),h(this,"updateMatrixWorld",()=>{let t=this.space;"scale"===this.mode&&(t="local");let e="local"===t?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let i=[];i=(i=(i=i.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(let t=0;t<i.length;t++){let n,s=i[t];if(s.visible=!0,s.rotation.set(0,0,0),s.position.copy(this.worldPosition),n=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),s.scale.set(1,1,1).multiplyScalar(n*this.size/7),"helper"===s.tag){s.visible=!1,"AXIS"===s.name?(s.position.copy(this.worldPositionStart),s.visible=!!this.axis,"X"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),s.quaternion.copy(e).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(e).dot(this.eye))>.9&&(s.visible=!1)),"Y"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),s.quaternion.copy(e).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(e).dot(this.eye))>.9&&(s.visible=!1)),"Z"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),s.quaternion.copy(e).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(e).dot(this.eye))>.9&&(s.visible=!1)),"XYZE"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),s.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),s.quaternion.multiply(this.tempQuaternion),s.visible=this.dragging),"E"===this.axis&&(s.visible=!1)):"START"===s.name?(s.position.copy(this.worldPositionStart),s.visible=this.dragging):"END"===s.name?(s.position.copy(this.worldPosition),s.visible=this.dragging):"DELTA"===s.name?(s.position.copy(this.worldPositionStart),s.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),s.scale.copy(this.tempVector),s.visible=this.dragging):(s.quaternion.copy(e),this.dragging?s.position.copy(this.worldPositionStart):s.position.copy(this.worldPosition),this.axis&&(s.visible=-1!==this.axis.search(s.name)));continue}s.quaternion.copy(e),"translate"===this.mode||"scale"===this.mode?(("X"===s.name||"XYZX"===s.name)&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(e).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),("Y"===s.name||"XYZY"===s.name)&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(e).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),("Z"===s.name||"XYZZ"===s.name)&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(e).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XY"===s.name&&.2>Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(e).dot(this.eye))&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"YZ"===s.name&&.2>Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(e).dot(this.eye))&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XZ"===s.name&&.2>Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(e).dot(this.eye))&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),-1!==s.name.search("X")&&(0>this.alignVector.copy(this.unitX).applyQuaternion(e).dot(this.eye)?"fwd"===s.tag?s.visible=!1:s.scale.x*=-1:"bwd"===s.tag&&(s.visible=!1)),-1!==s.name.search("Y")&&(0>this.alignVector.copy(this.unitY).applyQuaternion(e).dot(this.eye)?"fwd"===s.tag?s.visible=!1:s.scale.y*=-1:"bwd"===s.tag&&(s.visible=!1)),-1!==s.name.search("Z")&&(0>this.alignVector.copy(this.unitZ).applyQuaternion(e).dot(this.eye)?"fwd"===s.tag?s.visible=!1:s.scale.z*=-1:"bwd"===s.tag&&(s.visible=!1))):"rotate"===this.mode&&(this.tempQuaternion2.copy(e),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(e).invert()),-1!==s.name.search("E")&&s.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),"X"===s.name&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),s.quaternion.copy(this.tempQuaternion)),"Y"===s.name&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),s.quaternion.copy(this.tempQuaternion)),"Z"===s.name&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),s.quaternion.copy(this.tempQuaternion))),s.visible=s.visible&&(-1===s.name.indexOf("X")||this.showX),s.visible=s.visible&&(-1===s.name.indexOf("Y")||this.showY),s.visible=s.visible&&(-1===s.name.indexOf("Z")||this.showZ),s.visible=s.visible&&(-1===s.name.indexOf("E")||this.showX&&this.showY&&this.showZ),s.material.tempOpacity=s.material.tempOpacity||s.material.opacity,s.material.tempColor=s.material.tempColor||s.material.color.clone(),s.material.color.copy(s.material.tempColor),s.material.opacity=s.material.tempOpacity,this.enabled?this.axis&&(s.name===this.axis||this.axis.split("").some(function(t){return s.name===t})?s.material.opacity=1:s.material.opacity*=.25,s.material.color.lerp(new a.Q1f(1,1,1),.5)):(s.material.opacity*=.5,s.material.color.lerp(new a.Q1f(1,1,1),.5))}super.updateMatrixWorld()});let t=new a.V9B({depthTest:!1,depthWrite:!1,transparent:!0,side:a.$EB,fog:!1,toneMapped:!1}),e=new a.mrM({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),i=t.clone();i.opacity=.15;let n=t.clone();n.opacity=.33;let s=t.clone();s.color.set(0xff0000);let o=t.clone();o.color.set(65280);let r=t.clone();r.color.set(255);let l=t.clone();l.opacity=.25;let c=l.clone();c.color.set(0xffff00);let p=l.clone();p.color.set(65535);let d=l.clone();d.color.set(0xff00ff),t.clone().color.set(0xffff00);let u=e.clone();u.color.set(0xff0000);let m=e.clone();m.color.set(65280);let w=e.clone();w.color.set(255);let y=e.clone();y.color.set(65535);let g=e.clone();g.color.set(0xff00ff);let v=e.clone();v.color.set(0xffff00);let b=e.clone();b.color.set(7895160);let P=v.clone();P.opacity=.25;let f=new a.Ho_(0,.05,.2,12,1,!1),E=new a.iNn(.125,.125,.125),M=new a.LoY;M.setAttribute("position",new a.qtW([0,0,0,1,0,0],3));let S=(t,e)=>{let i=new a.LoY,n=[];for(let i=0;i<=64*e;++i)n.push(0,Math.cos(i/32*Math.PI)*t,Math.sin(i/32*Math.PI)*t);return i.setAttribute("position",new a.qtW(n,3)),i},x={X:[[new a.eaF(f,s),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new a.eaF(f,s),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new a.N1A(M,u)]],Y:[[new a.eaF(f,o),[0,1,0],null,null,"fwd"],[new a.eaF(f,o),[0,1,0],[Math.PI,0,0],null,"bwd"],[new a.N1A(M,m),null,[0,0,Math.PI/2]]],Z:[[new a.eaF(f,r),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new a.eaF(f,r),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new a.N1A(M,w),null,[0,-Math.PI/2,0]]],XYZ:[[new a.eaF(new a.Ufg(.1,0),l.clone()),[0,0,0],[0,0,0]]],XY:[[new a.eaF(new a.bdM(.295,.295),c.clone()),[.15,.15,0]],[new a.N1A(M,v),[.18,.3,0],null,[.125,1,1]],[new a.N1A(M,v),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new a.eaF(new a.bdM(.295,.295),p.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new a.N1A(M,y),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new a.N1A(M,y),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new a.eaF(new a.bdM(.295,.295),d.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new a.N1A(M,g),[.18,0,.3],null,[.125,1,1]],[new a.N1A(M,g),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},Q={X:[[new a.eaF(new a.Ho_(.2,0,1,4,1,!1),i),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new a.eaF(new a.Ho_(.2,0,1,4,1,!1),i),[0,.6,0]]],Z:[[new a.eaF(new a.Ho_(.2,0,1,4,1,!1),i),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new a.eaF(new a.Ufg(.2,0),i)]],XY:[[new a.eaF(new a.bdM(.4,.4),i),[.2,.2,0]]],YZ:[[new a.eaF(new a.bdM(.4,.4),i),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new a.eaF(new a.bdM(.4,.4),i),[.2,0,.2],[-Math.PI/2,0,0]]]},Y={START:[[new a.eaF(new a.Ufg(.01,2),n),null,null,null,"helper"]],END:[[new a.eaF(new a.Ufg(.01,2),n),null,null,null,"helper"]],DELTA:[[new a.N1A((()=>{let t=new a.LoY;return t.setAttribute("position",new a.qtW([0,0,0,1,1,1],3)),t})(),n),null,null,null,"helper"]],X:[[new a.N1A(M,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new a.N1A(M,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new a.N1A(M,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},A={X:[[new a.N1A(S(1,.5),u)],[new a.eaF(new a.Ufg(.04,0),s),[0,0,.99],null,[1,3,1]]],Y:[[new a.N1A(S(1,.5),m),null,[0,0,-Math.PI/2]],[new a.eaF(new a.Ufg(.04,0),o),[0,0,.99],null,[3,1,1]]],Z:[[new a.N1A(S(1,.5),w),null,[0,Math.PI/2,0]],[new a.eaF(new a.Ufg(.04,0),r),[.99,0,0],null,[1,3,1]]],E:[[new a.N1A(S(1.25,1),P),null,[0,Math.PI/2,0]],[new a.eaF(new a.Ho_(.03,0,.15,4,1,!1),P),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new a.eaF(new a.Ho_(.03,0,.15,4,1,!1),P),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new a.eaF(new a.Ho_(.03,0,.15,4,1,!1),P),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new a.eaF(new a.Ho_(.03,0,.15,4,1,!1),P),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new a.N1A(S(1,1),b),null,[0,Math.PI/2,0]]]},X={AXIS:[[new a.N1A(M,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},Z={X:[[new a.eaF(new a.O3Y(1,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new a.eaF(new a.O3Y(1,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new a.eaF(new a.O3Y(1,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new a.eaF(new a.O3Y(1.25,.1,2,24),i)]],XYZE:[[new a.eaF(new a.Gu$(.7,10,8),i)]]},V={X:[[new a.eaF(E,s),[.8,0,0],[0,0,-Math.PI/2]],[new a.N1A(M,u),null,null,[.8,1,1]]],Y:[[new a.eaF(E,o),[0,.8,0]],[new a.N1A(M,m),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new a.eaF(E,r),[0,0,.8],[Math.PI/2,0,0]],[new a.N1A(M,w),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new a.eaF(E,c),[.85,.85,0],null,[2,2,.2]],[new a.N1A(M,v),[.855,.98,0],null,[.125,1,1]],[new a.N1A(M,v),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new a.eaF(E,p),[0,.85,.85],null,[.2,2,2]],[new a.N1A(M,y),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new a.N1A(M,y),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new a.eaF(E,d),[.85,0,.85],null,[2,.2,2]],[new a.N1A(M,g),[.855,0,.98],null,[.125,1,1]],[new a.N1A(M,g),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new a.eaF(new a.iNn(.125,.125,.125),l.clone()),[1.1,0,0]]],XYZY:[[new a.eaF(new a.iNn(.125,.125,.125),l.clone()),[0,1.1,0]]],XYZZ:[[new a.eaF(new a.iNn(.125,.125,.125),l.clone()),[0,0,1.1]]]},q={X:[[new a.eaF(new a.Ho_(.2,0,.8,4,1,!1),i),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new a.eaF(new a.Ho_(.2,0,.8,4,1,!1),i),[0,.5,0]]],Z:[[new a.eaF(new a.Ho_(.2,0,.8,4,1,!1),i),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new a.eaF(E,i),[.85,.85,0],null,[3,3,.2]]],YZ:[[new a.eaF(E,i),[0,.85,.85],null,[.2,3,3]]],XZ:[[new a.eaF(E,i),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new a.eaF(new a.iNn(.2,.2,.2),i),[1.1,0,0]]],XYZY:[[new a.eaF(new a.iNn(.2,.2,.2),i),[0,1.1,0]]],XYZZ:[[new a.eaF(new a.iNn(.2,.2,.2),i),[0,0,1.1]]]},F={X:[[new a.N1A(M,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new a.N1A(M,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new a.N1A(M,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},z=t=>{let e=new a.B69;for(let i in t)for(let n=t[i].length;n--;){let s=t[i][n][0].clone(),o=t[i][n][1],a=t[i][n][2],r=t[i][n][3],h=t[i][n][4];s.name=i,s.tag=h,o&&s.position.set(o[0],o[1],o[2]),a&&s.rotation.set(a[0],a[1],a[2]),r&&s.scale.set(r[0],r[1],r[2]),s.updateMatrix();let l=s.geometry.clone();l.applyMatrix4(s.matrix),s.geometry=l,s.renderOrder=1/0,s.position.set(0,0,0),s.rotation.set(0,0,0),s.scale.set(1,1,1),e.add(s)}return e};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=z(x)),this.add(this.gizmo.rotate=z(A)),this.add(this.gizmo.scale=z(V)),this.add(this.picker.translate=z(Q)),this.add(this.picker.rotate=z(Z)),this.add(this.picker.scale=z(q)),this.add(this.helper.translate=z(Y)),this.add(this.helper.rotate=z(X)),this.add(this.helper.scale=z(F)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class p extends a.eaF{constructor(){super(new a.bdM(1e5,1e5,2,2),new a.V9B({visible:!1,wireframe:!0,side:a.$EB,transparent:!0,opacity:.1,toneMapped:!1})),h(this,"isTransformControlsPlane",!0),h(this,"type","TransformControlsPlane"),h(this,"unitX",new a.Pq0(1,0,0)),h(this,"unitY",new a.Pq0(0,1,0)),h(this,"unitZ",new a.Pq0(0,0,1)),h(this,"tempVector",new a.Pq0),h(this,"dirVector",new a.Pq0),h(this,"alignVector",new a.Pq0),h(this,"tempMatrix",new a.kn4),h(this,"identityQuaternion",new a.PTz),h(this,"cameraQuaternion",new a.PTz),h(this,"worldPosition",new a.Pq0),h(this,"worldQuaternion",new a.PTz),h(this,"eye",new a.Pq0),h(this,"axis",null),h(this,"mode","translate"),h(this,"space","world"),h(this,"updateMatrixWorld",()=>{let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),this.unitX.set(1,0,0).applyQuaternion("local"===t?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion("local"===t?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion("local"===t?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0)}break;default:this.dirVector.set(0,0,0)}0===this.dirVector.length()?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}let d=o.forwardRef(({children:t,domElement:e,onChange:i,onMouseDown:r,onMouseUp:h,onObjectChange:c,object:p,makeDefault:d,camera:u,enabled:m,axis:w,mode:y,translationSnap:g,rotationSnap:v,scaleSnap:b,space:P,size:f,showX:E,showY:M,showZ:S,...x},Q)=>{let Y=(0,s.C)(t=>t.controls),A=(0,s.C)(t=>t.gl),X=(0,s.C)(t=>t.events),Z=(0,s.C)(t=>t.camera),V=(0,s.C)(t=>t.invalidate),q=(0,s.C)(t=>t.get),F=(0,s.C)(t=>t.set),z=u||Z,I=e||X.connected||A.domElement,j=o.useMemo(()=>new l(z,I),[z,I]),N=o.useRef(null);o.useLayoutEffect(()=>(p?j.attach(p instanceof a.B69?p:p.current):N.current instanceof a.B69&&j.attach(N.current),()=>void j.detach()),[p,t,j]),o.useEffect(()=>{if(Y){let t=t=>Y.enabled=!t.value;return j.addEventListener("dragging-changed",t),()=>j.removeEventListener("dragging-changed",t)}},[j,Y]);let T=o.useRef(void 0),C=o.useRef(void 0),L=o.useRef(void 0),k=o.useRef(void 0);return o.useLayoutEffect(()=>void(T.current=i),[i]),o.useLayoutEffect(()=>void(C.current=r),[r]),o.useLayoutEffect(()=>void(L.current=h),[h]),o.useLayoutEffect(()=>void(k.current=c),[c]),o.useEffect(()=>{let t=t=>{V(),null==T.current||T.current(t)},e=t=>null==C.current?void 0:C.current(t),i=t=>null==L.current?void 0:L.current(t),n=t=>null==k.current?void 0:k.current(t);return j.addEventListener("change",t),j.addEventListener("mouseDown",e),j.addEventListener("mouseUp",i),j.addEventListener("objectChange",n),()=>{j.removeEventListener("change",t),j.removeEventListener("mouseDown",e),j.removeEventListener("mouseUp",i),j.removeEventListener("objectChange",n)}},[V,j]),o.useEffect(()=>{if(d){let t=q().controls;return F({controls:j}),()=>F({controls:t})}},[d,j]),o.createElement(o.Fragment,null,o.createElement("primitive",{ref:Q,object:j,enabled:m,axis:w,mode:y,translationSnap:g,rotationSnap:v,scaleSnap:b,space:P,size:f,showX:E,showY:M,showZ:S}),o.createElement("group",(0,n.A)({ref:N},x),t))})}}]);
//# sourceMappingURL=1252-141152dfa8977e73.js.map