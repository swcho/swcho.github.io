(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[344],{3717:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},12846:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b,meta:()=>g});var n=r(37876),i=r(91668);let s={src:"/_next/static/media/image.b5e4f4b1.png",height:334,width:1694,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAMAAABSSm3fAAAABlBMVEUGCAcWGBPAly/vAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAEklEQVR4nGNgZGRkAANGBggDAABQAAa5+TzjAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:2},l={src:"/_next/static/media/image-1.c10ecf0b.png",height:1446,width:1712,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAAKlBMVEX09feKio3x8PH5+vvn6vbOz9D///++vr7t4NG0s7Xm5+vZ2drJycrCwsSB953xAAAACXBIWXMAABYlAAAWJQFJUiTwAAAANElEQVR4nBXGyRHAMAwDsSVlWfKR/tvNGC8g9ngQjpgkyqqqtdC5N788aEawiRe6GzRtbP8gDAD74UYwYAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:7},o={src:"/_next/static/media/image-2.66bf2f21.png",height:1226,width:1728,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAMAAADJ2y/JAAAAIVBMVEX+/v75+fmdnZ6Xl5jq6umrq6zX19ny8vLd3d7BwcOGhojzWjdoAAAACXBIWXMAABYlAAAWJQFJUiTwAAAALUlEQVR4nD3JSQ4AIAwDsUlKF/j/gxEXbpZMdEtIRFXNzuGkbUdiXiFiLT4AXRJ5AI0miDHkAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:6},a={src:"/_next/static/media/image-3.ed3bf84e.png",height:590,width:3246,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAABCAMAAADU3h9xAAAACVBMVEXT09XNzc7IyMmLxpG+AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAEUlEQVR4nGNgZGBkYGBiZAAAAB8ABqnJzckAAAAASUVORK5CYII=",blurWidth:8,blurHeight:1},c={src:"/_next/static/media/image-4.5484514c.png",height:1546,width:3278,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAMAAACEE47CAAAAIVBMVEXv7+/P0dXn5+n6+vvq6+7ExMa8vL+hoqbb3N+Sk5jHydCx8I0LAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAJUlEQVR4nAXBhwEAMAjDMAfC6v8HV6Kqq+cGO3KfBDhDWiDSwAcKNABwa82lRAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:4},d={src:"/_next/static/media/initial.4467123c.svg",height:726,width:931,blurWidth:0,blurHeight:0},p={src:"/_next/static/media/worker.run.76fa3bb2.svg",height:434,width:780,blurWidth:0,blurHeight:0},h={src:"/_next/static/media/state.ce45af7b.svg",height:709,width:671,blurWidth:0,blurHeight:0},u={src:"/_next/static/media/workflow.085e4c4c.svg",height:626,width:1535,blurWidth:0,blurHeight:0},m={src:"/_next/static/media/activity.2cd01979.svg",height:473,width:784,blurWidth:0,blurHeight:0},A={src:"/_next/static/media/workflow-vm.1bac7c6a.svg",height:902,width:1579,blurWidth:0,blurHeight:0};var f=r(91013);let g={title:"Temporal Execution Platform 리뷰 #1",description:"오픈소스 Execution 플렛폼인 Temporal에 대해 소개하고 workflow 동작 방삭에 대해 살펴 봅니다.",date:"2023-12-03",readTime:10},x=e=>{let{children:t}=e;return(0,n.jsx)(f.A,{meta:g,children:t})};function j(e){let t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{children:"소개"}),"\n",(0,n.jsx)(t.p,{children:"서비스 아키텍쳐는 시대에 따라 많은 변화를 겪어 왔습니다.\n단순 모놀리딕 코드베이스와 배포 패키지에서 MSA로 변화하였고 API 기반의 동작에서 CQRS와 같은 이벤트 드리븐 방식으로 변화를 해 가는 중 입니다."}),"\n",(0,n.jsxs)(t.p,{children:["제가 구지 ",(0,n.jsx)(t.code,{children:"발전"}),"이라는 단어대신 ",(0,n.jsx)(t.code,{children:"변화"}),"라고 이야기한 이유는 혹자는 이러한 ",(0,n.jsx)(t.code,{children:"변화"}),"를 불편해하거나 흐름에 편승하여 ",(0,n.jsx)(t.code,{children:"변화"}),"를 선택하고 후회하는 경우도 봤기 때문입니다.\n우리는 확증편향 못지 않게 ",(0,n.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Social_proof",children:"소셜 프루프 인식 편향(Social Proof Bias)"}),"의 영향아래 살고 있습니다.\n아시다 싶이 개발자들은 자신이 보유한 기술이 언제 쓸모없게되지는 않을까 불안해 하거나 남들보다 앞서 defacto 기술을 찾아내어 선점 효과를 누리고자 하는 초조함 속에 살고있습니다.\n온라인 커뮤니티나 대형 기업이 주관하는 컨퍼런스에서 전달하는 키워드들은 진정한 가치에 기반하는지 포장만 살짝 바꾼 마케팅 용어에 불가한지 판단하기도 전에 기업과 조직내에서 도그마로 자리잡습니다."]}),"\n",(0,n.jsx)(t.p,{children:"프로그래밍 멘탈 모델의 경우 procedural, object oriented, declarative, event driven, stream reactive 등의 트렌드가 우리를 초조하게 만들었습니다.\n그러다 불현듯 다시 functional이라는 procedural한 트렌드로 회귀하는 듯한 보습이 보입니다.\n어찌보면, 우리가 처음 적용한 멘탈 모델이 사실은 가장 이해하기 쉽고 직관에 기반한 것이 아날까라는 생각을 하는 중에 놀라운 오픈소스 프로젝트를 발견하게 됩니다."}),"\n",(0,n.jsx)(t.p,{children:"소프트웨어 아키텍팅에서도 MSA, Event driven과 같이 손에 잡힐듯 말듯한 방법론에서 procedural한 방식으로 회귀하는 모습을 찾을 수 있는 오픈소스가 나왔는데 그것이 Temporal입니다."}),"\n",(0,n.jsx)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/pfArIYRVsbo?si=AdTS0lJrDkO65c0j",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:!0}),"\n",(0,n.jsx)(t.p,{children:"Temporal이 제공하는 솔루션이 새로운 만큼 이를 정의하는 적절한 용어를 찾기는 쉽지 않습니다.\n저는 temporal이 제공하는 솔루션을 workflow runtime이라 부르기로 했습니다."}),"\n",(0,n.jsx)(t.p,{children:"당장 실무에 적용하기에는 정치적 기술적 어려움이 따르겠으나 workflow runtime이라는 새로운 솔루션은 충분히 주목할만한 가치가 있다고 생각합니다."}),"\n",(0,n.jsx)(t.h1,{children:"Tech stack"}),"\n",(0,n.jsx)(t.p,{children:"Workflow runtime은 Go 언어로 작성하였습니다."}),"\n",(0,n.jsx)(t.p,{children:"통신은 protobuf를 사용합니다."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"make start-dependencies"}),"를 수행하면 필요한 오픈소스를 docker compose를 사용하여 설치합니다.\ngrafana, elasticsearch, cassandra, postgresql, prometheus, mysql 등을 사용합니다."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"start dependencies",src:s})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"make install-schema"})," 명령으로 cassandra 스키마를 생성합니다."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"executions"}),", ",(0,n.jsx)(t.code,{children:"tasks"}),", ",(0,n.jsx)(t.code,{children:"task_queue_user_data"}),", ",(0,n.jsx)(t.code,{children:"namespaces"}),", ",(0,n.jsx)(t.code,{children:"queues"})," 등의 테이블을 생성합니다."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"make start"}),"로 서버를 띄운뒤 ",(0,n.jsx)(t.code,{children:"http://localhost:8080/"}),"로 접근을 하면 다음과 같은 화면이 나옵니다."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Alt text",src:l})}),"\n",(0,n.jsx)(t.h2,{children:(0,n.jsx)(t.code,{children:"@temporalio/core-bridge"})}),"\n",(0,n.jsx)(t.p,{children:"Rust SDK 바인딩"}),"\n",(0,n.jsx)(t.h2,{children:(0,n.jsx)(t.code,{children:"@temporalio/proto"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://protobufjs.github.io/protobuf.js/",children:"protobuf.js"}),": Temporal 서버와의 통신 프로토콜"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{children:(0,n.jsx)(t.code,{children:"@temporal/worker"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://github.com/streamich/memfs",children:"memfs"}),": JavaScript file system utility"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://github.com/streamich/unionfs#readme",children:"unionfs"}),": 복수의 file system을 동시에 사용하도록 하는 유틸"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://github.com/mozilla/source-map",children:"mozilla/source-map"}),": workflow 코드의 소스맵 생성에 사용"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://rxjs.dev/",children:"RxJS"}),": worker의 이벤트 로직 처리에 사용"]}),"\n"]}),"\n",(0,n.jsx)(t.h1,{children:(0,n.jsx)(t.a,{href:"https://learn.temporal.io/getting_started/typescript/",children:"Get started with Temporal and TypeScript | Learn Temporal"})}),"\n",(0,n.jsxs)(t.p,{children:["해당 예제는 ",(0,n.jsx)(t.code,{children:"default"})," namespace가 존재한다는 전제하에 설명하고 있습니다."]}),"\n",(0,n.jsxs)(t.p,{children:["반면, Local에서 직접 실행할 경우 ",(0,n.jsx)(t.code,{children:"default"})," namespace는 존재하지 않습니다."]}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsxs)(t.p,{children:["참고: ",(0,n.jsx)(t.a,{href:"https://docs.temporal.io/namespaces",children:"What is a Temporal Namespace? | Temporal Documentation"})]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["따라서 가이드에 맞춰 ",(0,n.jsx)(t.code,{children:"temporal"})," CLI로 dev 서버를 다음과 같이 동작 시켜 봅니다."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"temporal server start-dev\n"})}),"\n",(0,n.jsx)(t.p,{children:"http://localhost:8233/ 에 접속하면 다음과 같이 Temporal UI를 확인할 수 있습니다."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Alt text",src:o})}),"\n",(0,n.jsx)(t.p,{children:"영속성을 위해 다음과 같이 sqlite db를 명시적으로 생성합니다."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"temporal server start-dev --db-filename temporal.sqlite\n"})}),"\n",(0,n.jsx)(t.p,{children:"먼저 worker 프로세스를 실행합니다."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"npm run worker\n"})}),"\n",(0,n.jsx)(t.p,{children:"다음 명령으로 workflow를 실행합니다."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"npm run client\n"})}),"\n",(0,n.jsxs)(t.p,{children:["이제 하나의 workflow 실행 이력을 확인할 수 있으며\n",(0,n.jsx)(t.img,{alt:"Alt text",src:a})]}),"\n",(0,n.jsxs)(t.p,{children:["activity 수행 이벤트를 확인할 수 있습니다.\n",(0,n.jsx)(t.img,{alt:"Alt text",src:c})]}),"\n",(0,n.jsx)(t.h2,{children:"Worker"}),"\n",(0,n.jsx)(t.p,{children:"Worker는 temporal 서버에 접속해서 workflow와 activity를 수행하는 역할을 합니다.\nnode.js, TypeScript, RxJs 등으로 구현하였고 rust로 작성한 sdk를 바인딩하여 서버와 통신합니다."}),"\n",(0,n.jsx)(t.p,{children:"다음은 초기화 과정을 보여줍니다."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"initial",src:d})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"WorkflowCodeBundler"}),"는 workflow를 작성한 코드를 임포트할 수 있는 코드를 동적으로 작성하고 webpack을 사용하여 번들링합니다."]}),"\n",(0,n.jsx)(t.p,{children:"Bundling하는 템플릿은 대략 다음과 같습니다."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-javascript",children:'const api = require(\'@temporalio/workflow/lib/worker-interface.js\');\n\napi.overrideGlobals();\n\nexports.api = api;\n\nexports.importWorkflows = function importWorkflows() {\n  return require(/* webpackMode: "eager" */ `${JSON.stringify(this.workflowsPath)}`);\n};\n\nexports.importInterceptors = function importInterceptors() {\n  return [require(/* webpackMode: "eager" */ `${interceptorImports}`)];\n};\n'})}),"\n",(0,n.jsx)(t.p,{children:"분석 당시의 코드는 다음과 같습니다."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-javascript",children:"const api = require('@temporalio/workflow/lib/worker-interface.js');\n\napi.overrideGlobals();\n\nexports.api = api;\n\nexports.importWorkflows = function importWorkflows() {\n  return require(/* webpackMode: \"eager\" */ '/{your project root}/money-transfer-project-example/lib/workflows.js');\n};\n\nexports.importInterceptors = function importInterceptors() {\n  return [\n    require(/* webpackMode: \"eager\" */ '/{your project root}/sdk-typescript/packages/worker/lib/workflow-log-interceptor.js'),\n  ];\n};\n"})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"overrideGlobals"}),"은 nodejs의 ",(0,n.jsx)(t.code,{children:"Date"}),", ",(0,n.jsx)(t.code,{children:"setTimeout"})," 등 런타임 API를 몽키패칭합니다."]}),"\n",(0,n.jsx)(t.p,{children:"Worker의 주요 함수들은 rxjs 기반으로 구현하였습니다.\n다양한 소스로 부터의 이벤트에서 복잡한 로직을 처리하기 위해 채택한 것으로 보입니다."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"run"})," 함수역시 rxjs로 구현하였습니다. 다음과 같은 흐름으로 workflow, activity observable 객체를 처리합니다."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"",src:p})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"stateSubject"}),"는 다음과 같은 상태를 가집니다."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"",src:h})}),"\n",(0,n.jsx)(t.p,{children:"workflow는 다음과 같은 흐름으로 처러합니다."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"",src:u})}),"\n",(0,n.jsx)(t.p,{children:"activity는 다음과 같은 흐름으로 처리합니다."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"",src:m})}),"\n",(0,n.jsx)(t.h2,{children:"Workflow VM"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"",src:A})}),"\n",(0,n.jsx)(t.p,{children:"Worker의 node.js main thread는 서버와 통신하는 Rust 라이브러리 바인딩을 통해 workflow 실행 이벤트를 처리합니다."}),"\n",(0,n.jsx)(t.p,{children:"Main thread는 Protobuf 형식의 바이너리 정보를 JSON 형식으로 시리얼라이즈 하고 실제 수행은 별도의 node.js web worker로 요청합니다."}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"initRuntime"})," 함수에서 ",(0,n.jsx)(t.code,{children:"importInterceptors"}),"와 ",(0,n.jsx)(t.code,{children:"importWorkflows"}),"를 차례로 호출하여 worker 생성시 전달한 workflow 디렉터리 경로에 있는 workflow 구현체들을 로드 합니다."]}),"\n",(0,n.jsx)(t.h1,{children:"마치며"}),"\n",(0,n.jsx)(t.p,{children:"사용자는 worker와 client로 나누어 코드를 실행해야 합니다."}),"\n",(0,n.jsx)(t.p,{children:"worker는 workflow 경로에 있는 사용자 구현체를 intercepting할 수 있는 코드를 동적으로 생성하고 webpack으로 번들링 합니다.\nTemporal 서버와 연결하여 workflow 실행 이벤트를 받아 실제로 수행하고 각 과정(activity)에서 발생한 입력과 결과를 서버에 전달합니다."}),"\n",(0,n.jsx)(t.p,{children:"client는 workflow를 수행하지만 실제로는 client 프로세스내에서 동작하지 않습니다.\nworkflow 구현체를 호출하면 Temporal 서버에 workflow의 실행을 알리고 각 파라미터를 전달합니다."}),"\n",(0,n.jsx)(t.p,{children:"이번 포스트에는 workflow의 초기화 위주로 리뷰를 해 보았습니다."}),"\n",(0,n.jsx)(t.p,{children:"Workflow에 속한 activity는 client에서 invoke 하지만 Temporal 서버의 중계와 로깅을 거쳐 worker에서 수행합니다.\n다음 시간에는 activity의 동작 방식에 대해서 다루어 보도록 하겠습니다."})]})}function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.jsx)(x,{...e,children:(0,n.jsx)(j,{...e})})}},42210:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/blogs/2023-12-03-temporal-1",function(){return r(12846)}])},49034:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(18153),i=r(77328),s=r.n(i),l=r(14232);let o=l.memo(()=>(0,n.Y)(n.FK,{}));var a=r(71745),c=r(48230),d=r.n(c);let p=[{link:"/",text:"Home"}],h=l.memo(()=>{let e=(0,a.useRouter)(),[t,r]=l.useState(!1);return(0,n.FD)("nav",{className:"w-full",children:[(0,n.Y)("div",{id:"progress",className:"top-0 z-20 h-1",style:{background:"linear-gradient(to right, #4dc0b5 var(--scroll), transparent 0)"}}),(0,n.FD)("div",{className:"flex flex-wrap items-center justify-between w-full py-3 mx-auto mt-0 md:max-w-4xl",children:[(0,n.Y)("div",{className:"pl-4",children:(0,n.Y)(d(),{className:"text-xl font-extrabold text-gray-900 no-underline hover:no-underline",href:"/",children:"lifetime trails"})}),(0,n.Y)("div",{className:"block pr-4 lg:hidden",children:(0,n.Y)("button",{id:"nav-toggle",type:"button",className:"flex items-center px-3 py-2 text-gray-500 appearance-none hover:text-gray-900 hover:border-teal-500 focus:outline-none",onMouseDown:e=>e.preventDefault(),onClick:()=>r(!t),onBlur:()=>r(!1),children:(0,n.FD)("svg",{className:"w-3 h-3 fill-current",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.Y)("title",{children:"Menu"}),(0,n.Y)("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})]})})}),(0,n.Y)("div",{id:"nav-content",className:"bg-gray-100 border-b flex-grow lg:border-none lg:flex lg:items-center lg:mt-0 lg:shadow-none lg:w-auto md:bg-transparent mt-2 shadow w-full z-20 ".concat(t?"block":"hidden"),children:(0,n.Y)("ul",{className:"items-center justify-end flex-1 list-reset lg:flex",children:p.map(t=>{let{link:r,text:i}=t;return(0,n.Y)("li",{className:"mr-3",children:(0,n.Y)(d(),{className:e.pathname===r?"inline-block py-2 px-4 text-gray-900 font-bold no-underline":"inline-block text-gray-600 no-underline hover:text-gray-900 hover:text-underline py-2 px-4",href:r,children:i})},r)})})})]})]})}),u=l.memo(e=>{let{children:t,title:r="This is the default title"}=e;return(0,n.FD)("div",{className:"leading-normal tracking-normal bg-gray-100 min-h-screen",children:[(0,n.FD)(s(),{children:[(0,n.Y)("title",{children:r}),(0,n.Y)("meta",{charSet:"utf-8"}),(0,n.Y)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,n.Y)(h,{}),(0,n.Y)("div",{className:"container w-full px-4 pb-10 mx-auto md:max-w-3xl",children:t}),(0,n.Y)(o,{})]})})},56486:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.identifierTypes=void 0;var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}}return t.default=e,t}(r(14232)),i=function(e){return e&&e.__esModule?e:{default:e}}(r(95062));function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=["pathname","url","title","og:title","issue-number","issue-term"],c=function(e,t,r){if(0>a.indexOf(e))return void console.warn("Wrong type: "+e);if("pathname"===e)return"pathname";if("url"===e)return"url";if("title"===e)return"title";if("og:title"===e)return"og:title";if("issue-term"===e)return t;else if("issue-number"===e)return r},d=function(e){var t;if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");function r(e){var t,i;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");return(t=(i=l(r).call(this,e))&&("object"===s(i)||"function"==typeof i)?i:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this)).myRef=n.default.createRef(),t.state={pending:!0},t}return r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),e&&o(r,e),t=[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.repo,n=t.type,i=t.specificTerm,s=t.issueNumber,l=0>a.indexOf(n)?void console.warn("Wrong type: "+n):"issue-number"===n?"issue-number":"issue-term",o=c(n,i,s);if("issue-term"===n&&!o)return void console.warn("When type is '".concat(n,"', 'specificTerm' prop must be provided"));if("issue-number"===n&&(isNaN(o)||o<1))return void console.warn("When type is '".concat(n,"', valid 'issueNumber' prop must be provided"));var d=document.createElement("script");d.src="https://utteranc.es/client.js",d.async=!0,d.setAttribute("repo",r),d.setAttribute("crossorigin","anonymous"),d.setAttribute(l,o),d.onload=function(){return e.setState({pending:!1})},this.myRef.current.appendChild(d)}},{key:"render",value:function(){return n.default.createElement("div",{className:"react-utterences",ref:this.myRef},this.props.debug&&n.default.createElement("pre",{style:{background:"#cccccc",padding:10}},"\nthis.props: ".concat(JSON.stringify(this.props,null,2),'\nlocation.pathname: "').concat(window.location.pathname,'"\nlocation.href: "').concat(window.location.href,'"\n          ').trim()),this.props.debug&&n.default.createElement("div",null,"\uD83D\uDC47\uD83D\uDC47If the settings are valid, the comment widget appear below\uD83D\uDC47\uD83D\uDC47"),this.state.pending&&n.default.createElement("div",null,"Loading script..."))}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(r.prototype,t),r}(n.Component);t.identifierTypes={pathname:{attrValue:"",summary:"Issue title contains page pathname"},url:{attrValue:"url",summary:"Issue title contains page URL"},title:{attrValue:"title",summary:"Issue title contains page title"},"og:title":{attrValue:"og:title",summary:"Issue title contains page og:title"},"issue-number":{attrValue:-1,summary:"Specific issue number"},"issue-term":{attrValue:"",summary:"Issue title contains specific term"}},d.propTypes={type:i.default.string.isRequired,repo:i.default.string.isRequired,specificTerm:i.default.string,issueNumber:i.default.number,hashKey:i.default.string,debug:i.default.bool},t.default=d},60158:(e,t,r)=>{"use strict";r.d(t,{J:()=>o,j:()=>l});var n=r(18153),i=r(14232);let s=i.createContext({});function l(e){let{staticProps:t,children:r}=e;return(0,n.Y)(s.Provider,{value:t,children:r})}function o(){return i.useContext(s)}},79706:(e,t,r)=>{"use strict";var n=r(3717);function i(){}function s(){}s.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,s,l){if(l!==n){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:i};return r.PropTypes=r,r}},85419:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(18153);r(14232);let i=e=>{let{meta:t,isBlogPost:r}=e;return(0,n.FD)(n.FK,{children:[(0,n.Y)("h1",{className:"font-bold text-gray-800 mb-4 ".concat(r?"text-5xl mt-8 mb-8":"text-lg"),children:t.title}),(0,n.FD)("div",{className:"details",children:[(0,n.Y)("p",{className:"text-gray-500",children:t.description}),(0,n.Y)("p",{className:"text-gray-400 text-right -mt-1",children:(0,n.Y)("span",{className:"mr-4",children:t.date})})]})]})}},86089:(e,t,r)=>{"use strict";Object.defineProperty(t,"Ay",{enumerable:!0,get:function(){return n.default}});var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}}return t.default=e,t}(r(56486))},91013:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n=r(18153),i=r(73146),s=r.n(i),l=r(14232),o=r(86089),a=r(60158),c=r(85419),d=r(49034);function p(e){let{children:t,meta:r,staticProps:i}=e;return l.useEffect(()=>{s().highlightAll()},[]),(0,n.Y)(n.FK,{children:(0,n.FD)(d.A,{title:r.title,children:[(0,n.Y)(c.A,{meta:r,isBlogPost:!0}),(0,n.Y)(a.j,{staticProps:i,children:(0,n.Y)("article",{className:"markdown",children:t})}),(0,n.Y)(o.Ay,{repo:"swcho/blog-comments",type:"pathname",label:"utterances",theme:"github-light"})]})})}},95062:(e,t,r)=>{e.exports=r(79706)()}},e=>{e.O(0,[5695,636,6593,8792],()=>e(e.s=42210)),_N_E=e.O()}]);
//# sourceMappingURL=2023-12-03-temporal-1-8d254bcaf0128f55.js.map