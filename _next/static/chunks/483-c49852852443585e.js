"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[483],{58566:(e,t,r)=>{r.d(t,{S:()=>g});var n=r(44501),o=r(14232),a=r(14796),i=r(71804),l=r(60138);let c=new a.Color,u=(0,l.A)();function s(e,t){let{right:r,top:n,left:o,bottom:a,width:i,height:l}=t,c=t.bottom<0||n>e.height||r<0||t.left>e.width,u=e.top+e.height;return{position:{width:i,height:l,left:o-e.left,top:n,bottom:u-a,right:r},isOffscreen:c}}function p(e,{left:t,bottom:r,width:n,height:o}){let a,i,l=n/o;return(i=e.camera)&&i.isOrthographicCamera?e.camera.manual?e.camera.updateProjectionMatrix():(e.camera.left!==-(n/2)||e.camera.right!==n/2||e.camera.top!==o/2||e.camera.bottom!==-(o/2))&&(Object.assign(e.camera,{left:-(n/2),right:n/2,top:o/2,bottom:-(o/2)}),e.camera.updateProjectionMatrix()):e.camera.aspect!==l&&(e.camera.aspect=l,e.camera.updateProjectionMatrix()),a=e.gl.autoClear,e.gl.autoClear=!1,e.gl.setViewport(t,r,n,o),e.gl.setScissor(t,r,n,o),e.gl.setScissorTest(!0),a}function d(e,t){e.gl.setScissorTest(!1),e.gl.autoClear=t}function m(e){e.gl.getClearColor(c),e.gl.setClearColor(c,e.gl.getClearAlpha()),e.gl.clear(!0,!0)}function f({visible:e=!0,canvasSize:t,scene:r,index:n,children:a,frames:l,rect:c,track:u}){let f=(0,i.C)(),[x,y]=o.useState(!1),g=0;return(0,i.D)(n=>{if(l===1/0||g<=l){var o;u&&(c.current=null==(o=u.current)?void 0:o.getBoundingClientRect()),g++}if(c.current){let{position:o,isOffscreen:i}=s(t,c.current);if(x!==i&&y(i),e&&!x&&c.current){let e=p(n,o);n.gl.render(a?n.scene:r,n.camera),d(n,e)}}},n),o.useLayoutEffect(()=>{let r=c.current;if(r&&(!e||!x)){let{position:e}=s(t,r),n=p(f,e);m(f),d(f,n)}},[e,x]),o.useEffect(()=>{if(!u)return;let e=c.current,r=f.get().events.connected;return f.setEvents({connected:u.current}),()=>{if(e){let{position:r}=s(t,e),n=p(f,r);m(f),d(f,n)}f.setEvents({connected:r})}},[u]),o.createElement(o.Fragment,null,a,o.createElement("group",{onPointerOver:()=>null}))}let x=o.forwardRef(({track:e,visible:t=!0,index:r=1,id:l,style:c,className:u,frames:s=1/0,children:p,...d},m)=>{var x,y,g,w;let h=o.useRef(null),{size:b,scene:M}=(0,i.C)(),[E]=o.useState(()=>new a.Scene),[v,C]=o.useReducer(()=>!0,!1),P=o.useCallback((t,r)=>{if(h.current&&e&&e.current&&t.target===e.current){let{width:e,height:n,left:o,top:a}=h.current,i=t.clientX-o,l=t.clientY-a;r.pointer.set(i/e*2-1,-(l/n*2)+1),r.raycaster.setFromCamera(r.pointer,r.camera)}},[h,e]);return o.useEffect(()=>{var t;e&&(h.current=null==(t=e.current)?void 0:t.getBoundingClientRect()),C()},[e]),o.createElement("group",(0,n.A)({ref:m},d),v&&(0,i.o)(o.createElement(f,{visible:t,canvasSize:b,frames:s,scene:M,track:e,rect:h,index:r},p),E,{events:{compute:P,priority:r},size:{width:null==(x=h.current)?void 0:x.width,height:null==(y=h.current)?void 0:y.height,top:null==(g=h.current)?void 0:g.top,left:null==(w=h.current)?void 0:w.left}}))}),y=o.forwardRef(({as:e="div",id:t,visible:r,className:a,style:i,index:l=1,track:c,frames:s=1/0,children:p,...d},m)=>{let f=o.useId(),y=o.useRef(null);return o.useImperativeHandle(m,()=>y.current),o.createElement(o.Fragment,null,o.createElement(e,(0,n.A)({ref:y,id:t,className:a,style:i},d)),o.createElement(u.In,null,o.createElement(x,{visible:r,key:f,track:y,frames:s,index:l},p)))}),g=(()=>{let e=o.forwardRef((e,t)=>o.useContext(i.q)?o.createElement(x,(0,n.A)({ref:t},e)):o.createElement(y,(0,n.A)({ref:t},e)));return e.Port=()=>o.createElement(u.Out,null),e})()},60138:(e,t,r)=>{r.d(t,{A:()=>m});var n,o,a=r(14232);let i=e=>{let t,r=new Set,n=(e,n)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=n?n:"object"!=typeof o||null===o)?o:Object.assign({},t,o),r.forEach(r=>r(t,e))}},o=()=>t,a={setState:n,getState:o,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},i=t=e(n,o,a);return a};var l=r(45712);let{useDebugValue:c}=a,{useSyncExternalStoreWithSelector:u}=l,s=!1,p=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?(e=>e?i(e):i)(e):e,r=(e,r)=>(function(e,t=e=>e,r){r&&!s&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),s=!0);let n=u(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return c(n),n})(t,e,r);return Object.assign(r,t),r},d="undefined"!=typeof window&&(null!=(n=window.document)&&n.createElement||(null==(o=window.navigator)?void 0:o.product)==="ReactNative")?a.useLayoutEffect:a.useEffect;function m(){let e,t=(e=e=>({current:[],version:0,set:e}))?p(e):p;return{In:({children:e})=>{let r=t(e=>e.set),n=t(e=>e.version);return d(()=>{r(e=>({version:e.version+1}))},[]),d(()=>(r(({current:t})=>({current:[...t,e]})),()=>r(({current:t})=>({current:t.filter(t=>t!==e)}))),[e,n]),null},Out:()=>{let e=t(e=>e.current);return a.createElement(a.Fragment,null,e)}}}},64870:(e,t,r)=>{r.d(t,{n:()=>eo});var n=r(44501),o=r(71804),a=r(14232),i=r(14796),l=r(39745),c=r(55822);let u=a.createContext(null),s=new i.Vector3,p=new i.Vector3,d=new i.Vector3(0,1,0),m=new i.Matrix4,f=({direction:e,axis:t})=>{let{translation:r,translationLimits:n,annotations:f,annotationsClass:x,depthTest:y,scale:g,lineWidth:w,fixed:h,axisColors:b,hoveredColor:M,opacity:E,renderOrder:v,onDragStart:C,onDrag:P,onDragEnd:R,userData:F}=a.useContext(u),S=(0,o.C)(e=>e.controls),V=a.useRef(null),k=a.useRef(null),z=a.useRef(null),O=a.useRef(0),[W,T]=a.useState(!1),I=a.useCallback(n=>{f&&(V.current.innerText=`${r.current[t].toFixed(2)}`,V.current.style.display="block"),n.stopPropagation();let o=new i.Matrix4().extractRotation(k.current.matrixWorld),a=n.point.clone(),l=new i.Vector3().setFromMatrixPosition(k.current.matrixWorld),c=e.clone().applyMatrix4(o).normalize();z.current={clickPoint:a,dir:c},O.current=r.current[t],C({component:"Arrow",axis:t,origin:l,directions:[c]}),S&&(S.enabled=!1),n.target.setPointerCapture(n.pointerId)},[f,e,S,C,r,t]),A=a.useCallback(e=>{if(e.stopPropagation(),W||T(!0),z.current){let{clickPoint:o,dir:a}=z.current,[i,l]=(null==n?void 0:n[t])||[void 0,void 0],c=((e,t,r,n)=>{let o=t.dot(t),a=t.dot(e)-t.dot(r),i=t.dot(n);return 0===i?-a/o:(s.copy(n).multiplyScalar(o/i).sub(t),p.copy(n).multiplyScalar(a/i).add(r).sub(e),-s.dot(p)/s.dot(s))})(o,a,e.ray.origin,e.ray.direction);void 0!==i&&(c=Math.max(c,i-O.current)),void 0!==l&&(c=Math.min(c,l-O.current)),r.current[t]=O.current+c,f&&(V.current.innerText=`${r.current[t].toFixed(2)}`),m.makeTranslation(a.x*c,a.y*c,a.z*c),P(m)}},[f,P,W,r,n,t]),D=a.useCallback(e=>{f&&(V.current.style.display="none"),e.stopPropagation(),z.current=null,R(),S&&(S.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[f,S,R]),B=a.useCallback(e=>{e.stopPropagation(),T(!1)},[]),{cylinderLength:N,coneWidth:U,coneLength:j,matrixL:L}=a.useMemo(()=>{let t=h?w/g*1.6:g/20,r=h?.2:g/5,n=h?1-r:g-r,o=new i.Quaternion().setFromUnitVectors(d,e.clone().normalize());return{cylinderLength:n,coneWidth:t,coneLength:r,matrixL:new i.Matrix4().makeRotationFromQuaternion(o)}},[e,g,w,h]),$=W?M:b[t];return a.createElement("group",{ref:k},a.createElement("group",{matrix:L,matrixAutoUpdate:!1,onPointerDown:I,onPointerMove:A,onPointerUp:D,onPointerOut:B},f&&a.createElement(c.E,{position:[0,-j,0]},a.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:x,ref:V})),a.createElement("mesh",{visible:!1,position:[0,(N+j)/2,0],userData:F},a.createElement("cylinderGeometry",{args:[1.4*U,1.4*U,N+j,8,1]})),a.createElement(l.N,{transparent:!0,raycast:()=>null,depthTest:y,points:[0,0,0,0,N,0],lineWidth:w,side:i.DoubleSide,color:$,opacity:E,polygonOffset:!0,renderOrder:v,polygonOffsetFactor:-10,fog:!1}),a.createElement("mesh",{raycast:()=>null,position:[0,N+j/2,0],renderOrder:v},a.createElement("coneGeometry",{args:[U,j,24,1]}),a.createElement("meshBasicMaterial",{transparent:!0,depthTest:y,color:$,opacity:E,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))))},x=new i.Vector3,y=new i.Vector3,g=e=>180*e/Math.PI,w=e=>{let t=((e,t)=>{let r=Math.floor(e/t);return e-(r=r<0?r+1:r)*t})(e,2*Math.PI);return 1e-6>Math.abs(t)?0:(t<0&&(t+=2*Math.PI),t)},h=new i.Matrix4,b=new i.Vector3,M=new i.Ray,E=new i.Vector3,v=({dir1:e,dir2:t,axis:r})=>{let{rotationLimits:n,annotations:s,annotationsClass:p,depthTest:d,scale:m,lineWidth:f,fixed:v,axisColors:C,hoveredColor:P,renderOrder:R,opacity:F,onDragStart:S,onDrag:V,onDragEnd:k,userData:z}=a.useContext(u),O=(0,o.C)(e=>e.controls),W=a.useRef(null),T=a.useRef(null),I=a.useRef(0),A=a.useRef(0),D=a.useRef(null),[B,N]=a.useState(!1),U=a.useCallback(e=>{s&&(W.current.innerText=`${g(A.current).toFixed(0)}\xba`,W.current.style.display="block"),e.stopPropagation();let t=e.point.clone(),n=new i.Vector3().setFromMatrixPosition(T.current.matrixWorld),o=new i.Vector3().setFromMatrixColumn(T.current.matrixWorld,0).normalize(),a=new i.Vector3().setFromMatrixColumn(T.current.matrixWorld,1).normalize(),l=new i.Vector3().setFromMatrixColumn(T.current.matrixWorld,2).normalize(),c=new i.Plane().setFromNormalAndCoplanarPoint(l,n);D.current={clickPoint:t,origin:n,e1:o,e2:a,normal:l,plane:c},S({component:"Rotator",axis:r,origin:n,directions:[o,a,l]}),O&&(O.enabled=!1),e.target.setPointerCapture(e.pointerId)},[s,O,S,r]),j=a.useCallback(e=>{if(e.stopPropagation(),B||N(!0),D.current){let{clickPoint:t,origin:o,e1:a,e2:l,normal:c,plane:u}=D.current,[p,d]=(null==n?void 0:n[r])||[void 0,void 0];M.copy(e.ray),M.intersectPlane(u,E),M.direction.negate(),M.intersectPlane(u,E);let m=((e,t,r,n,o)=>{x.copy(e).sub(r),y.copy(t).sub(r);let a=n.dot(n),i=o.dot(o),l=x.dot(n)/a,c=x.dot(o)/i,u=y.dot(n)/a;return Math.atan2(y.dot(o)/i,u)-Math.atan2(c,l)})(t,E,o,a,l),f=g(m);e.shiftKey&&(m=(f=10*Math.round(f/10))*Math.PI/180),void 0!==p&&void 0!==d&&d-p<2*Math.PI?(m=(m=w(m))>Math.PI?m-2*Math.PI:m,m=i.MathUtils.clamp(m,p-I.current,d-I.current),A.current=I.current+m):(A.current=w(I.current+m),A.current=A.current>Math.PI?A.current-2*Math.PI:A.current),s&&(f=g(A.current),W.current.innerText=`${f.toFixed(0)}\xba`),h.makeRotationAxis(c,m),b.copy(o).applyMatrix4(h).sub(o).negate(),h.setPosition(b),V(h)}},[s,V,B,n,r]),L=a.useCallback(e=>{s&&(W.current.style.display="none"),e.stopPropagation(),I.current=A.current,D.current=null,k(),O&&(O.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[s,O,k]),$=a.useCallback(e=>{e.stopPropagation(),N(!1)},[]),G=a.useMemo(()=>{let r=e.clone().normalize(),n=t.clone().normalize();return new i.Matrix4().makeBasis(r,n,r.clone().cross(n))},[e,t]),H=v?.65:.65*m,Q=a.useMemo(()=>{let e=[];for(let t=0;t<=32;t++){let r=Math.PI/2*t/32;e.push(new i.Vector3(Math.cos(r)*H,Math.sin(r)*H,0))}return e},[H]);return a.createElement("group",{ref:T,onPointerDown:U,onPointerMove:j,onPointerUp:L,onPointerOut:$,matrix:G,matrixAutoUpdate:!1},s&&a.createElement(c.E,{position:[H,H,0]},a.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:p,ref:W})),a.createElement(l.N,{points:Q,lineWidth:4*f,visible:!1,userData:z}),a.createElement(l.N,{transparent:!0,raycast:()=>null,depthTest:d,points:Q,lineWidth:f,side:i.DoubleSide,color:B?P:C[r],opacity:F,polygonOffset:!0,polygonOffsetFactor:-10,renderOrder:R,fog:!1}))},C=new i.Ray,P=new i.Vector3,R=new i.Matrix4,F=({dir1:e,dir2:t,axis:r})=>{let{translation:n,translationLimits:s,annotations:p,annotationsClass:d,depthTest:m,scale:f,lineWidth:x,fixed:y,axisColors:g,hoveredColor:w,opacity:h,renderOrder:b,onDragStart:M,onDrag:E,onDragEnd:v,userData:F}=a.useContext(u),S=(0,o.C)(e=>e.controls),V=a.useRef(null),k=a.useRef(null),z=a.useRef(null),O=a.useRef(0),W=a.useRef(0),[T,I]=a.useState(!1),A=a.useCallback(e=>{p&&(V.current.innerText=`${n.current[(r+1)%3].toFixed(2)}, ${n.current[(r+2)%3].toFixed(2)}`,V.current.style.display="block"),e.stopPropagation();let t=e.point.clone(),o=new i.Vector3().setFromMatrixPosition(k.current.matrixWorld),a=new i.Vector3().setFromMatrixColumn(k.current.matrixWorld,0).normalize(),l=new i.Vector3().setFromMatrixColumn(k.current.matrixWorld,1).normalize(),c=new i.Vector3().setFromMatrixColumn(k.current.matrixWorld,2).normalize();z.current={clickPoint:t,e1:a,e2:l,plane:new i.Plane().setFromNormalAndCoplanarPoint(c,o)},O.current=n.current[(r+1)%3],W.current=n.current[(r+2)%3],M({component:"Slider",axis:r,origin:o,directions:[a,l,c]}),S&&(S.enabled=!1),e.target.setPointerCapture(e.pointerId)},[p,S,M,r]),D=a.useCallback(e=>{if(e.stopPropagation(),T||I(!0),z.current){let{clickPoint:t,e1:o,e2:a,plane:i}=z.current,[l,c]=(null==s?void 0:s[(r+1)%3])||[void 0,void 0],[u,d]=(null==s?void 0:s[(r+2)%3])||[void 0,void 0];C.copy(e.ray),C.intersectPlane(i,P),C.direction.negate(),C.intersectPlane(i,P),P.sub(t);let[m,f]=((e,t,r)=>{let n=Math.abs(e.x)>=Math.abs(e.y)&&Math.abs(e.x)>=Math.abs(e.z)?0:Math.abs(e.y)>=Math.abs(e.x)&&Math.abs(e.y)>=Math.abs(e.z)?1:2,o=[0,1,2].sort((e,r)=>Math.abs(t.getComponent(r))-Math.abs(t.getComponent(e))),a=n===o[0]?o[1]:o[0],i=e.getComponent(n),l=e.getComponent(a),c=t.getComponent(n),u=t.getComponent(a),s=r.getComponent(n),p=(r.getComponent(a)-l/i*s)/(u-l/i*c);return[(s-p*c)/i,p]})(o,a,P);void 0!==l&&(m=Math.max(m,l-O.current)),void 0!==c&&(m=Math.min(m,c-O.current)),void 0!==u&&(f=Math.max(f,u-W.current)),void 0!==d&&(f=Math.min(f,d-W.current)),n.current[(r+1)%3]=O.current+m,n.current[(r+2)%3]=W.current+f,p&&(V.current.innerText=`${n.current[(r+1)%3].toFixed(2)}, ${n.current[(r+2)%3].toFixed(2)}`),R.makeTranslation(m*o.x+f*a.x,m*o.y+f*a.y,m*o.z+f*a.z),E(R)}},[p,E,T,n,s,r]),B=a.useCallback(e=>{p&&(V.current.style.display="none"),e.stopPropagation(),z.current=null,v(),S&&(S.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[p,S,v]),N=a.useCallback(e=>{e.stopPropagation(),I(!1)},[]),U=a.useMemo(()=>{let r=e.clone().normalize(),n=t.clone().normalize();return new i.Matrix4().makeBasis(r,n,r.clone().cross(n))},[e,t]),j=y?1/7:f/7,L=y?.225:.225*f,$=T?w:g[r],G=a.useMemo(()=>[new i.Vector3(0,0,0),new i.Vector3(0,L,0),new i.Vector3(L,L,0),new i.Vector3(L,0,0),new i.Vector3(0,0,0)],[L]);return a.createElement("group",{ref:k,matrix:U,matrixAutoUpdate:!1},p&&a.createElement(c.E,{position:[0,0,0]},a.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:d,ref:V})),a.createElement("group",{position:[1.7*j,1.7*j,0]},a.createElement("mesh",{visible:!0,onPointerDown:A,onPointerMove:D,onPointerUp:B,onPointerOut:N,scale:L,userData:F,renderOrder:b},a.createElement("planeGeometry",null),a.createElement("meshBasicMaterial",{transparent:!0,depthTest:m,color:$,polygonOffset:!0,polygonOffsetFactor:-10,side:i.DoubleSide,fog:!1})),a.createElement(l.N,{position:[-L/2,-L/2,0],transparent:!0,depthTest:m,points:G,lineWidth:x,color:$,opacity:h,polygonOffset:!0,polygonOffsetFactor:-10,userData:F,fog:!1,renderOrder:b})))},S=new i.Vector3,V=new i.Vector3,k=new i.Vector3,z=(e,t,r,n=1)=>{let o=S.set(e.x/r.width*2-1,-(2*(e.y/r.height))+1,n);return o.unproject(t),o},O=(e,t,r,n)=>{let o=((e,t,r)=>{let n=r.width/2,o=r.height/2;t.updateMatrixWorld(!1);let a=e.project(t);return a.x=a.x*n+n,a.y=-(a.y*o)+o,a})(k.copy(e),r,n),a=0;for(let i=0;i<2;++i){let l=V.copy(o).setComponent(i,o.getComponent(i)+t),c=z(l,r,n,l.z);a=Math.max(a,e.distanceTo(c))}return a},W=new i.Vector3,T=new i.Vector3,I=new i.Vector3(0,1,0),A=new i.Vector3,D=new i.Matrix4,B=({direction:e,axis:t})=>{let{scaleLimits:r,annotations:n,annotationsClass:l,depthTest:s,scale:p,lineWidth:d,fixed:m,axisColors:f,hoveredColor:x,opacity:y,renderOrder:g,onDragStart:w,onDrag:h,onDragEnd:b,userData:M}=a.useContext(u),E=(0,o.C)(e=>e.size),v=(0,o.C)(e=>e.controls),C=a.useRef(null),P=a.useRef(null),R=a.useRef(null),F=a.useRef(1),S=a.useRef(1),V=a.useRef(null),[k,z]=a.useState(!1),B=m?1.2:1.2*p,N=a.useCallback(r=>{n&&(C.current.innerText=`${S.current.toFixed(2)}`,C.current.style.display="block"),r.stopPropagation();let o=new i.Matrix4().extractRotation(P.current.matrixWorld),a=r.point.clone(),l=new i.Vector3().setFromMatrixPosition(P.current.matrixWorld),c=e.clone().applyMatrix4(o).normalize(),u=P.current.matrixWorld.clone(),s=u.clone().invert();V.current={clickPoint:a,dir:c,mPLG:u,mPLGInv:s,offsetMultiplier:m?1/O(P.current.getWorldPosition(W),p,r.camera,E):1},w({component:"Sphere",axis:t,origin:l,directions:[c]}),v&&(v.enabled=!1),r.target.setPointerCapture(r.pointerId)},[n,v,e,w,t,m,p,E]),U=a.useCallback(e=>{if(e.stopPropagation(),k||z(!0),V.current){let{clickPoint:o,dir:a,mPLG:i,mPLGInv:l,offsetMultiplier:c}=V.current,[u,s]=(null==r?void 0:r[t])||[1e-5,void 0],d=((e,t,r,n)=>{let o=t.dot(t),a=t.dot(e)-t.dot(r),i=t.dot(n);return 0===i?-a/o:(W.copy(n).multiplyScalar(o/i).sub(t),T.copy(n).multiplyScalar(a/i).add(r).sub(e),-W.dot(T)/W.dot(W))})(o,a,e.ray.origin,e.ray.direction)*c,f=Math.pow(2,.2*(m?d:d/p));e.shiftKey&&(f=Math.round(10*f)/10),f=Math.max(f,u/F.current),void 0!==s&&(f=Math.min(f,s/F.current)),S.current=F.current*f,R.current.position.set(0,B+d,0),n&&(C.current.innerText=`${S.current.toFixed(2)}`),A.set(1,1,1),A.setComponent(t,f),D.makeScale(A.x,A.y,A.z).premultiply(i).multiply(l),h(D)}},[n,B,h,k,r,t]),j=a.useCallback(e=>{n&&(C.current.style.display="none"),e.stopPropagation(),F.current=S.current,V.current=null,R.current.position.set(0,B,0),b(),v&&(v.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[n,v,b,B]),L=a.useCallback(e=>{e.stopPropagation(),z(!1)},[]),{radius:$,matrixL:G}=a.useMemo(()=>{let t=m?d/p*1.8:p/22.5,r=new i.Quaternion().setFromUnitVectors(I,e.clone().normalize());return{radius:t,matrixL:new i.Matrix4().makeRotationFromQuaternion(r)}},[e,p,d,m]),H=k?x:f[t];return a.createElement("group",{ref:P},a.createElement("group",{matrix:G,matrixAutoUpdate:!1,onPointerDown:N,onPointerMove:U,onPointerUp:j,onPointerOut:L},n&&a.createElement(c.E,{position:[0,B/2,0]},a.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:l,ref:C})),a.createElement("mesh",{ref:R,position:[0,B,0],renderOrder:g,userData:M},a.createElement("sphereGeometry",{args:[$,12,12]}),a.createElement("meshBasicMaterial",{transparent:!0,depthTest:s,color:H,opacity:y,polygonOffset:!0,polygonOffsetFactor:-10}))))},N=new i.Matrix4,U=new i.Matrix4,j=new i.Matrix4,L=new i.Matrix4,$=new i.Matrix4,G=new i.Matrix4,H=new i.Matrix4,Q=new i.Matrix4,_=new i.Matrix4,q=new i.Box3,K=new i.Box3,X=new i.Vector3,Y=new i.Vector3,J=new i.Vector3,Z=new i.Vector3,ee=new i.Vector3,et=new i.Vector3(1,0,0),er=new i.Vector3(0,1,0),en=new i.Vector3(0,0,1),eo=a.forwardRef(({enabled:e=!0,matrix:t,onDragStart:r,onDrag:l,onDragEnd:c,autoTransform:s=!0,anchor:p,disableAxes:d=!1,disableSliders:m=!1,disableRotations:x=!1,disableScaling:y=!1,activeAxes:g=[!0,!0,!0],offset:w=[0,0,0],rotation:h=[0,0,0],scale:b=1,lineWidth:M=4,fixed:E=!1,translationLimits:C,rotationLimits:P,scaleLimits:R,depthTest:S=!0,renderOrder:V=500,axisColors:k=["#ff2060","#20df80","#2080ff"],hoveredColor:z="#ffff40",annotations:W=!1,annotationsClass:T,opacity:I=1,visible:A=!0,userData:D,children:eo,...ea},ei)=>{let el=(0,o.C)(e=>e.invalidate),ec=a.useRef(null),eu=a.useRef(null),es=a.useRef(null),ep=a.useRef(null),ed=a.useRef([0,0,0]),em=a.useRef(new i.Vector3(1,1,1)),ef=a.useRef(new i.Vector3(1,1,1));a.useLayoutEffect(()=>{p&&(ep.current.updateWorldMatrix(!0,!0),L.copy(ep.current.matrixWorld).invert(),q.makeEmpty(),ep.current.traverse(e=>{e.geometry&&(e.geometry.boundingBox||e.geometry.computeBoundingBox(),G.copy(e.matrixWorld).premultiply(L),K.copy(e.geometry.boundingBox),K.applyMatrix4(G),q.union(K))}),X.copy(q.max).add(q.min).multiplyScalar(.5),Y.copy(q.max).sub(q.min).multiplyScalar(.5),J.copy(Y).multiply(new i.Vector3(...p)).add(X),Z.set(...w).add(J),es.current.position.copy(Z),el())});let ex=a.useMemo(()=>({onDragStart:e=>{N.copy(eu.current.matrix),U.copy(eu.current.matrixWorld),r&&r(e),el()},onDrag:e=>{j.copy(ec.current.matrixWorld),L.copy(j).invert(),$.copy(U).premultiply(e),G.copy($).premultiply(L),H.copy(N).invert(),Q.copy(G).multiply(H),s&&eu.current.matrix.copy(G),l&&l(G,Q,$,e),el()},onDragEnd:()=>{c&&c(),el()},translation:ed,translationLimits:C,rotationLimits:P,axisColors:k,hoveredColor:z,opacity:I,scale:b,lineWidth:M,fixed:E,depthTest:S,renderOrder:V,userData:D,annotations:W,annotationsClass:T}),[r,l,c,ed,C,P,R,S,b,M,E,...k,z,I,D,s,W,T]),ey=new i.Vector3;return(0,o.D)(e=>{if(E){let t=O(es.current.getWorldPosition(ey),b,e.camera,e.size);em.current.setScalar(t)}t&&t instanceof i.Matrix4&&(eu.current.matrix=t),eu.current.updateWorldMatrix(!0,!0),_.makeRotationFromEuler(es.current.rotation).setPosition(es.current.position).premultiply(eu.current.matrixWorld),ef.current.setFromMatrixScale(_),ee.copy(em.current).divide(ef.current),(Math.abs(es.current.scale.x-ee.x)>1e-4||Math.abs(es.current.scale.y-ee.y)>1e-4||Math.abs(es.current.scale.z-ee.z)>1e-4)&&(es.current.scale.copy(ee),e.invalidate())}),a.useImperativeHandle(ei,()=>eu.current,[]),a.createElement(u.Provider,{value:ex},a.createElement("group",{ref:ec},a.createElement("group",(0,n.A)({ref:eu,matrix:t,matrixAutoUpdate:!1},ea),a.createElement("group",{visible:A,ref:es,position:w,rotation:h},e&&a.createElement(a.Fragment,null,!d&&g[0]&&a.createElement(f,{axis:0,direction:et}),!d&&g[1]&&a.createElement(f,{axis:1,direction:er}),!d&&g[2]&&a.createElement(f,{axis:2,direction:en}),!m&&g[0]&&g[1]&&a.createElement(F,{axis:2,dir1:et,dir2:er}),!m&&g[0]&&g[2]&&a.createElement(F,{axis:1,dir1:en,dir2:et}),!m&&g[2]&&g[1]&&a.createElement(F,{axis:0,dir1:er,dir2:en}),!x&&g[0]&&g[1]&&a.createElement(v,{axis:2,dir1:et,dir2:er}),!x&&g[0]&&g[2]&&a.createElement(v,{axis:1,dir1:en,dir2:et}),!x&&g[2]&&g[1]&&a.createElement(v,{axis:0,dir1:er,dir2:en}),!y&&g[0]&&a.createElement(B,{axis:0,direction:et}),!y&&g[1]&&a.createElement(B,{axis:1,direction:er}),!y&&g[2]&&a.createElement(B,{axis:2,direction:en}))),a.createElement("group",{ref:ep},eo))))})},78925:(e,t,r)=>{r.d(t,{j:()=>i});var n=r(14232),o=r(14796),a=r(71804);function i(e,t,r){let i=(0,a.C)(e=>e.size),l=(0,a.C)(e=>e.viewport),c="number"==typeof e?e:i.width*l.dpr,u="number"==typeof t?t:i.height*l.dpr,s=("number"==typeof e?r:e)||{},{samples:p=0,depth:d,...m}=s,f=null!=d?d:s.depthBuffer,x=n.useMemo(()=>{let e=new o.WebGLRenderTarget(c,u,{minFilter:o.LinearFilter,magFilter:o.LinearFilter,type:o.HalfFloatType,...m});return f&&(e.depthTexture=new o.DepthTexture(c,u,o.FloatType)),e.samples=p,e},[]);return n.useLayoutEffect(()=>{x.setSize(c,u),p&&(x.samples=p)},[p,x,c,u]),n.useEffect(()=>()=>x.dispose(),[]),x}},99893:(e,t,r)=>{r.d(t,{o:()=>i});var n=r(44501),o=r(14796),a=r(14232);let i=a.forwardRef(function({children:e,object:t,disable:r,disableX:i,disableY:l,disableZ:c,left:u,right:s,top:p,bottom:d,front:m,back:f,onCentered:x,precise:y=!0,cacheKey:g=0,...w},h){let b=a.useRef(null),M=a.useRef(null),E=a.useRef(null),[v]=a.useState(()=>new o.Box3),[C]=a.useState(()=>new o.Vector3),[P]=a.useState(()=>new o.Sphere);return a.useLayoutEffect(()=>{M.current.matrixWorld.identity(),v.setFromObject(null!=t?t:E.current,y);let e=v.max.x-v.min.x,n=v.max.y-v.min.y,o=v.max.z-v.min.z;v.getCenter(C),v.getBoundingSphere(P);let a=p?n/2:d?-n/2:0,g=u?-e/2:s?e/2:0,w=m?o/2:f?-o/2:0;M.current.position.set(r||i?0:-C.x+g,r||l?0:-C.y+a,r||c?0:-C.z+w),null==x||x({parent:b.current.parent,container:b.current,width:e,height:n,depth:o,boundingBox:v,boundingSphere:P,center:C,verticalAlignment:a,horizontalAlignment:g,depthAlignment:w})},[g,x,p,u,m,r,i,l,c,t,y,s,d,f,v,C,P]),a.useImperativeHandle(h,()=>b.current,[]),a.createElement("group",(0,n.A)({ref:b},w),a.createElement("group",{ref:M},a.createElement("group",{ref:E},e)))})}}]);
//# sourceMappingURL=483-c49852852443585e.js.map